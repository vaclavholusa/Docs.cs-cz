---
uid: identity/overview/extensibility/implementing-a-custom-mysql-aspnet-identity-storage-provider
title: Implementace zprostředkovatele úložiště vlastních MySQL ASP.NET Identity | Dokumentace Microsoftu
author: raquelsa
description: ASP.NET Identity je rozšiřitelný systém, který vám umožní vytvořit poskytovatele úložiště a zařadit ho do své aplikace bez znovu práce aplikace...
ms.author: riande
ms.date: 05/22/2015
ms.assetid: 248f5fe7-39ba-40ea-ab1e-71a69b0bd649
msc.legacyurl: /identity/overview/extensibility/implementing-a-custom-mysql-aspnet-identity-storage-provider
msc.type: authoredcontent
ms.openlocfilehash: 358b1a3b7277f21c63a1d395f2a5fce79bbe0d56
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/16/2018
ms.locfileid: "41755020"
---
<a name="implementing-a-custom-mysql-aspnet-identity-storage-provider"></a><span data-ttu-id="afb49-103">Implementace zprostředkovatele úložiště vlastních MySQL ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="afb49-103">Implementing a Custom MySQL ASP.NET Identity Storage Provider</span></span>
====================
<span data-ttu-id="afb49-104">podle [Raquel Soares De Almeida](https://github.com/raquelsa), [Suhas Joshi](https://github.com/suhasj), [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="afb49-104">by [Raquel Soares De Almeida](https://github.com/raquelsa), [Suhas Joshi](https://github.com/suhasj), [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="afb49-105">ASP.NET Identity je rozšiřitelný systém, který vám umožní vytvořit poskytovatele úložiště a připojte ho do své aplikace bez přepracování aplikace.</span><span class="sxs-lookup"><span data-stu-id="afb49-105">ASP.NET Identity is an extensible system which enables you to create your own storage provider and plug it into your application without re-working the application.</span></span> <span data-ttu-id="afb49-106">Toto téma popisuje, jak vytvořit poskytovatele úložiště MySQL ASP.NET identity.</span><span class="sxs-lookup"><span data-stu-id="afb49-106">This topic describes how to create a MySQL storage provider for ASP.NET Identity.</span></span> <span data-ttu-id="afb49-107">Přehled vytváření poskytovatelé vlastního úložiště najdete v tématu [přehled poskytovatelů vlastního úložiště pro ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span><span class="sxs-lookup"><span data-stu-id="afb49-107">For an overview of creating custom storage providers, see [Overview of Custom Storage Providers for ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span></span>
> 
> <span data-ttu-id="afb49-108">Abyste mohli absolvovat tento kurz, musíte mít Visual Studio 2013 s aktualizací Update 2.</span><span class="sxs-lookup"><span data-stu-id="afb49-108">To complete this tutorial, you must have Visual Studio 2013 with Update 2.</span></span>
> 
> <span data-ttu-id="afb49-109">V tomto kurzu se:</span><span class="sxs-lookup"><span data-stu-id="afb49-109">This tutorial will:</span></span>
> 
> - <span data-ttu-id="afb49-110">Ukazují, jak vytvořit instance databáze MySQL v Azure.</span><span class="sxs-lookup"><span data-stu-id="afb49-110">Show how to create a MySQL database instance on Azure.</span></span>
> - <span data-ttu-id="afb49-111">Ukazují, jak pomocí nástroje MySQL klienta (MySQL Workbench) vytvářet tabulky a spravovat vaše vzdálené databáze v Azure.</span><span class="sxs-lookup"><span data-stu-id="afb49-111">Show how to use a MySQL client tool (MySQL Workbench) to create tables and manage your remote database on Azure.</span></span>
> - <span data-ttu-id="afb49-112">Ukazují, jak nahradit výchozí implementace úložiště ASP.NET Identity naší vlastní implementaci na projekt aplikace MVC.</span><span class="sxs-lookup"><span data-stu-id="afb49-112">Show how to replace the default ASP.NET Identity storage implementation with our custom implementation on a MVC application project.</span></span>
> 
> <span data-ttu-id="afb49-113">V tomto kurzu byl původně zapsán Raquel Soares De Almeida a Rick Anderson ( [ @RickAndMSFT ](https://twitter.com/#!/RickAndMSFT) ).</span><span class="sxs-lookup"><span data-stu-id="afb49-113">This tutorial was originally written by Raquel Soares De Almeida and Rick Anderson ( [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT) ).</span></span> <span data-ttu-id="afb49-114">Ukázkový projekt byla aktualizována pro Identity 2.0 Suhas Joshi.</span><span class="sxs-lookup"><span data-stu-id="afb49-114">The sample project was updated for Identity 2.0 by Suhas Joshi.</span></span> <span data-ttu-id="afb49-115">Tom FitzMacken aktualizoval 2.0 identit tématu.</span><span class="sxs-lookup"><span data-stu-id="afb49-115">The topic was updated for Identity 2.0 by Tom FitzMacken.</span></span>


## <a name="download-completed-project"></a><span data-ttu-id="afb49-116">Stažení se dokončilo projektu</span><span class="sxs-lookup"><span data-stu-id="afb49-116">Download completed project</span></span>

<span data-ttu-id="afb49-117">Na konci tohoto kurzu budete mít projekt aplikace MVC s ASP.NET Identity práci s databází MySQL hostovanou v Azure.</span><span class="sxs-lookup"><span data-stu-id="afb49-117">At the end of this tutorial, you will have an MVC application project with ASP.NET Identity working with a MySQL database hosted on Azure.</span></span>

<span data-ttu-id="afb49-118">Můžete si stáhnout dokončený poskytovatele úložiště MySQL v [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span><span class="sxs-lookup"><span data-stu-id="afb49-118">You can download the completed MySQL storage provider at [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span></span>

## <a name="the-steps-you-will-perform"></a><span data-ttu-id="afb49-119">Kroky, které budete provádět</span><span class="sxs-lookup"><span data-stu-id="afb49-119">The steps you will perform</span></span>

<span data-ttu-id="afb49-120">V tomto kurzu provedete následující:</span><span class="sxs-lookup"><span data-stu-id="afb49-120">In this tutorial you will:</span></span>

1. <span data-ttu-id="afb49-121">Vytvořit databázi MySQL v Azure</span><span class="sxs-lookup"><span data-stu-id="afb49-121">Create a MySQL database on Azure</span></span>
2. <span data-ttu-id="afb49-122">Vytvoření tabulek v ASP.NET Identity v MySQL</span><span class="sxs-lookup"><span data-stu-id="afb49-122">Create the ASP.NET Identity tables in MySQL</span></span>
3. <span data-ttu-id="afb49-123">Vytvoření aplikace MVC a nakonfigurujte ho na použití poskytovatele MySQL</span><span class="sxs-lookup"><span data-stu-id="afb49-123">Create an MVC application and configure it to use the MySQL provider</span></span>
4. <span data-ttu-id="afb49-124">Spuštění aplikace</span><span class="sxs-lookup"><span data-stu-id="afb49-124">Run the app</span></span>

<span data-ttu-id="afb49-125">Toto téma nepopisuje architekturu ASP.NET Identity a rozhodnutí, která musí provést při implementaci zprostředkovatele úložiště zákazníka.</span><span class="sxs-lookup"><span data-stu-id="afb49-125">This topic does not cover the architecture of ASP.NET Identity and the decisions you must make when implementing a customer storage provider.</span></span> <span data-ttu-id="afb49-126">Informace najdete v tématu [přehled o vlastní poskytovatelé úložiště pro ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span><span class="sxs-lookup"><span data-stu-id="afb49-126">For that information, see [Overview of Custom Storage Providers for ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span></span>

## <a name="review-mysql-storage-provider-classes"></a><span data-ttu-id="afb49-127">Zkontrolujte třídy poskytovatele úložiště MySQL</span><span class="sxs-lookup"><span data-stu-id="afb49-127">Review MySQL storage provider classes</span></span>

<span data-ttu-id="afb49-128">Než si řekneme kroky k vytvoření poskytovatele úložiště MySQL, Podívejme se na třídy, které tvoří poskytovatele úložiště.</span><span class="sxs-lookup"><span data-stu-id="afb49-128">Before jumping into the steps to create the MySQL storage provider, let's look at the classes that make up the storage provider.</span></span> <span data-ttu-id="afb49-129">Budete potřebovat třídy, které spravují databázových operací a tříd, které se volají z aplikace pro správu uživatelů a rolí.</span><span class="sxs-lookup"><span data-stu-id="afb49-129">You will need classes that manage the database operations and classes that are called from the application to manage users and roles.</span></span>

### <a name="storage-classes"></a><span data-ttu-id="afb49-130">Třídy úložiště</span><span class="sxs-lookup"><span data-stu-id="afb49-130">Storage classes</span></span>

- <span data-ttu-id="afb49-131">[IdentityUser](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityUser.cs) – obsahuje vlastnosti pro daného uživatele.</span><span class="sxs-lookup"><span data-stu-id="afb49-131">[IdentityUser](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityUser.cs) - contains properties for the user.</span></span>
- <span data-ttu-id="afb49-132">[Úložiště UserStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserStore.cs) – obsahuje operace pro přidání, aktualizaci nebo načítání uživatelů.</span><span class="sxs-lookup"><span data-stu-id="afb49-132">[UserStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserStore.cs) - contains operations for adding, updating or retrieving users.</span></span>
- <span data-ttu-id="afb49-133">[IdentityRole](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityRole.cs) – obsahuje vlastnosti pro role.</span><span class="sxs-lookup"><span data-stu-id="afb49-133">[IdentityRole](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityRole.cs) - contains properties for roles.</span></span>
- <span data-ttu-id="afb49-134">[Úložiště RoleStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleStore.cs) – obsahuje operace pro přidávání, odstraňování, aktualizaci nebo načtení rolí.</span><span class="sxs-lookup"><span data-stu-id="afb49-134">[RoleStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleStore.cs) - contains operations for adding, deleting, updating and retrieving roles.</span></span>

### <a name="data-access-layer-classes"></a><span data-ttu-id="afb49-135">Datové třídy vrstva přístupu</span><span class="sxs-lookup"><span data-stu-id="afb49-135">Data access layer classes</span></span>

<span data-ttu-id="afb49-136">V tomto příkladu obsahují vrstvu tříd pro přístup k data SQL příkazy pro práci s tabulkami; v kódu však může být vhodné pro použití objektově relační mapování (ORM), jako je například rozhraní Entity Framework nebo NHibernate.</span><span class="sxs-lookup"><span data-stu-id="afb49-136">For this example, the data access layer classes contain SQL statements for working with the tables; however, in your code you might want to use object-relational mapping (ORM) such as Entity Framework or NHibernate.</span></span> <span data-ttu-id="afb49-137">Konkrétně se vaše aplikace může nízký výkon bez ORM, která obsahuje objekt ukládání do mezipaměti a opožděná načítání.</span><span class="sxs-lookup"><span data-stu-id="afb49-137">In particular, your application may experience poor performance without an ORM that includes lazy loading and object caching.</span></span> <span data-ttu-id="afb49-138">Další informace najdete v tématu [ASP.NET Identity 2.0 bez rozhraní Entity Framework?](https://aspnetidentity.codeplex.com/discussions/561828)</span><span class="sxs-lookup"><span data-stu-id="afb49-138">For more information, see [ASP.NET Identity 2.0 without Entity Framework?](https://aspnetidentity.codeplex.com/discussions/561828)</span></span>

- <span data-ttu-id="afb49-139">[MySQLDatabase](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLDatabase.cs) – obsahuje metody pro provádění databázových operací a připojení k databázi MySQL.</span><span class="sxs-lookup"><span data-stu-id="afb49-139">[MySQLDatabase](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLDatabase.cs) - contains the MySQL database connection and methods for performing database operations.</span></span> <span data-ttu-id="afb49-140">Úložiště UserStore a úložiště RoleStore jsou vytvořena pomocí instance této třídy.</span><span class="sxs-lookup"><span data-stu-id="afb49-140">UserStore and RoleStore are both instantiated with an instance of this class.</span></span>
- <span data-ttu-id="afb49-141">[RoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleTable.cs) – obsahuje databázové operace pro tabulku, která ukládá role.</span><span class="sxs-lookup"><span data-stu-id="afb49-141">[RoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleTable.cs) - contains database operations for the table that stores roles.</span></span>
- <span data-ttu-id="afb49-142">[UserClaimsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserClaimsTable.cs) – obsahuje databázové operace pro tabulku, která ukládá deklarace identity uživatelů.</span><span class="sxs-lookup"><span data-stu-id="afb49-142">[UserClaimsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserClaimsTable.cs) - contains database operations for the table that stores user claims.</span></span>
- <span data-ttu-id="afb49-143">[UserLoginsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserLoginsTable.cs) – obsahuje databázové operace pro tabulku, která ukládá přihlašovací informace uživatele.</span><span class="sxs-lookup"><span data-stu-id="afb49-143">[UserLoginsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserLoginsTable.cs) - contains database operations for the table that stores user login information.</span></span>
- <span data-ttu-id="afb49-144">[UserRoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserRoleTable.cs) – databázové operace pro tabulky, který ukládá, kteří uživatelé jsou přiřazení rolím, které obsahuje.</span><span class="sxs-lookup"><span data-stu-id="afb49-144">[UserRoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserRoleTable.cs) - contains database operations for the table that stores which users are assigned to which roles.</span></span>
- <span data-ttu-id="afb49-145">[UserTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserTable.cs) – obsahuje databázové operace pro tabulku, která obsahuje uživatele.</span><span class="sxs-lookup"><span data-stu-id="afb49-145">[UserTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserTable.cs) - contains database operations for the table that stores users.</span></span>

## <a name="create-a-mysql-database-instance-on-azure"></a><span data-ttu-id="afb49-146">Vytvoření instance databáze MySQL v Azure</span><span class="sxs-lookup"><span data-stu-id="afb49-146">Create a MySQL database instance on Azure</span></span>

1. <span data-ttu-id="afb49-147">Přihlaste se k [webu Azure Portal](https://manage.windowsazure.com/).</span><span class="sxs-lookup"><span data-stu-id="afb49-147">Log in to the [Azure Portal](https://manage.windowsazure.com/).</span></span>
2. <span data-ttu-id="afb49-148">Klikněte na tlačítko **+ nová** v dolní části stránky a pak vyberte **úložiště**.</span><span class="sxs-lookup"><span data-stu-id="afb49-148">Click **+NEW** at the bottom of the page, and then select **STORE**.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image1.png)
3. <span data-ttu-id="afb49-149">V **zvolit a doplněk** průvodce, vyberte **databázi ClearDB MySQL** a klikněte na šipku v pravém dolním rohu dialogového okna.</span><span class="sxs-lookup"><span data-stu-id="afb49-149">In the **Choose and Add-on** wizard, select **ClearDB MySQL Database** and click on the next arrow at the bottom right of the dialog.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image2.png)
4. <span data-ttu-id="afb49-150">Ponechte výchozí **Free** plánu a změňte **název** k **IdentityMySQLDatabase**.</span><span class="sxs-lookup"><span data-stu-id="afb49-150">Keep the default **Free** plan and change the **Name** to **IdentityMySQLDatabase**.</span></span> <span data-ttu-id="afb49-151">Vyberte oblast nejbližší a potom klikněte na šipku Další.</span><span class="sxs-lookup"><span data-stu-id="afb49-151">Select the region nearest you and then click the next arrow.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image3.png)
5. <span data-ttu-id="afb49-152">Kliknutím na značku zaškrtnutí dokončete vytváření databáze.</span><span class="sxs-lookup"><span data-stu-id="afb49-152">Click the checkmark to complete the database creation.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image4.png)
6. <span data-ttu-id="afb49-153">Po vytvoření vaší databáze ji můžete spravovat z **doplňky** karta na portálu management portal.</span><span class="sxs-lookup"><span data-stu-id="afb49-153">After your database has been created, you can manage it from the **ADD-ONS** tab in the management portal.</span></span>   
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image5.png)
7. <span data-ttu-id="afb49-154">Informace o připojení k databázi můžete získat kliknutím na **informace o připojení** v dolní části stránky.</span><span class="sxs-lookup"><span data-stu-id="afb49-154">You can get the database connection information by clicking on **CONNECTION INFO** at the bottom of the page.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image6.png)
8. <span data-ttu-id="afb49-155">Kliknutím na tlačítko Kopírovat zkopírujte připojovací řetězec a uložte ho, abyste mohli použít později v aplikaci MVC.</span><span class="sxs-lookup"><span data-stu-id="afb49-155">Copy the connection string by clicking on the copy button and save it so you can use later in your MVC application.</span></span>   
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image7.png)

## <a name="create-the-aspnet-identity-tables-in-a-mysql-database"></a><span data-ttu-id="afb49-156">ASP.NET Identity vytváření tabulek v databázi MySQL</span><span class="sxs-lookup"><span data-stu-id="afb49-156">Create the ASP.NET Identity tables in a MySQL database</span></span>

### <a name="install-mysql-workbench-tool-to-connect-and-manage-mysql-database"></a><span data-ttu-id="afb49-157">Instalace nástroje MySQL Workbench k připojení a správě databáze MySQL</span><span class="sxs-lookup"><span data-stu-id="afb49-157">Install MySQL Workbench tool to connect and manage MySQL database</span></span>

1. <span data-ttu-id="afb49-158">Nainstalujte **aplikace MySQL Workbench** nástroj z [stránky pro MySQL stažení](http://dev.mysql.com/downloads/windows/installer/)</span><span class="sxs-lookup"><span data-stu-id="afb49-158">Install the **MySQL Workbench** tool from the [MySQL downloads page](http://dev.mysql.com/downloads/windows/installer/)</span></span>
2. <span data-ttu-id="afb49-159">Spusťte aplikaci a přidejte kliknutím na **MySQLConnections +** tlačítko pro přidání nového připojení.</span><span class="sxs-lookup"><span data-stu-id="afb49-159">Launch the app and add click on the **MySQLConnections +** button to add a new connection.</span></span> <span data-ttu-id="afb49-160">Data řetězce připojení, který jste zkopírovali z databáze Azure MySQL, kterou jste vytvořili dříve v tomto kurzu použijte.</span><span class="sxs-lookup"><span data-stu-id="afb49-160">Use the connection string data you copied from the Azure MySQL database you created earlier in this tutorial.</span></span>
3. <span data-ttu-id="afb49-161">Po vytvoření připojení se otevře nová **dotazu** kartě; vkládání příkazů z [MySQLIdentity.sql](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLIdentity.sql) do dotazu a proveďte jej chcete-li vytvořit tabulky databáze.</span><span class="sxs-lookup"><span data-stu-id="afb49-161">After establishing the connection, open a new **Query** tab; paste the commands from [MySQLIdentity.sql](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLIdentity.sql) into the query and execute it in order to create the database tables.</span></span>
4. <span data-ttu-id="afb49-162">Nyní máte všechny ASP.NET Identity nezbytné tabulky vytvořené v databázi MySQL hostovanou na Azure, jak je znázorněno níže.</span><span class="sxs-lookup"><span data-stu-id="afb49-162">You now have all the ASP.NET Identity necessary tables created on a MySQL database hosted on Azure as shown below.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image1.jpg)

## <a name="create-an-mvc-application-project-from-template-and-configure-it-to-use-mysql-provider"></a><span data-ttu-id="afb49-163">Vytvořte projekt aplikace MVC ze šablony a nakonfigurujte ho na použití poskytovatele MySQL</span><span class="sxs-lookup"><span data-stu-id="afb49-163">Create an MVC application project from template and configure it to use MySQL provider</span></span>

<span data-ttu-id="afb49-164">V případě potřeby nainstalujte buď [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) nebo [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566) s aktualizací Update 2.</span><span class="sxs-lookup"><span data-stu-id="afb49-164">If needed, install either [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566) with Update 2.</span></span>

### <a name="download-the-aspnetidentitymysql-project-from-codeplex"></a><span data-ttu-id="afb49-165">Stáhněte si ASP.NET.Identity.MySQL projekt z webu CodePlex</span><span class="sxs-lookup"><span data-stu-id="afb49-165">Download the ASP.NET.Identity.MySQL project from CodePlex</span></span>

1. <span data-ttu-id="afb49-166">Přejděte na adresu URL úložiště na [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span><span class="sxs-lookup"><span data-stu-id="afb49-166">Browse to the repository URL at [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span></span>
2. <span data-ttu-id="afb49-167">Stáhněte si zdrojový kód.</span><span class="sxs-lookup"><span data-stu-id="afb49-167">Download the source code.</span></span>
3. <span data-ttu-id="afb49-168">Soubor .zip extrahujte do místní složky.</span><span class="sxs-lookup"><span data-stu-id="afb49-168">Extract the .zip file into a local folder.</span></span>
4. <span data-ttu-id="afb49-169">Otevřete řešení AspNet.Identity.MySQL a sestavte ho.</span><span class="sxs-lookup"><span data-stu-id="afb49-169">Open the AspNet.Identity.MySQL solution and build it.</span></span>

### <a name="create-a-new-mvc-application-project-from-template"></a><span data-ttu-id="afb49-170">Vytvoření nového projektu aplikace MVC ze šablony</span><span class="sxs-lookup"><span data-stu-id="afb49-170">Create a new MVC application project from template</span></span>

1. <span data-ttu-id="afb49-171">Klikněte pravým tlačítkem myši **AspNet.Identity.MySQL** řešení a **přidat**, **nový projekt**</span><span class="sxs-lookup"><span data-stu-id="afb49-171">Right click the **AspNet.Identity.MySQL** solution and **Add**, **New Project**</span></span>
2. <span data-ttu-id="afb49-172">V **přidat nový projekt** dialogové okno Vybrat **Visual C#** na levé straně, pak **webové** a pak vyberte **webová aplikace ASP.NET**.</span><span class="sxs-lookup"><span data-stu-id="afb49-172">In the **Add New Project** Dialog select **Visual C#** on the left, then **Web** and then select **ASP.NET Web Application**.</span></span> <span data-ttu-id="afb49-173">Pojmenujte svůj projekt **IdentityMySQLDemo**; a potom klikněte na tlačítko OK.</span><span class="sxs-lookup"><span data-stu-id="afb49-173">Name your project **IdentityMySQLDemo**; and then click OK.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image2.jpg)
3. <span data-ttu-id="afb49-174">V **nový projekt ASP.NET** dialogového okna, vyberte šablonu MVC s výchozími možnostmi (zahrnující **jednotlivé uživatelské účty** jako metodu ověřování) a klikněte na tlačítko **OK** .![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image3.jpg)</span><span class="sxs-lookup"><span data-stu-id="afb49-174">In the **New ASP.NET Project** dialog, select the MVC template with the default options (that includes **Individual User Accounts** as authentication method) and click **OK**.![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image3.jpg)</span></span>
4. <span data-ttu-id="afb49-175">V Průzkumníku řešení klikněte pravým tlačítkem myši na projekt IdentityMySQLDemo a vyberte **spravovat balíčky NuGet**.</span><span class="sxs-lookup"><span data-stu-id="afb49-175">In Solution Explorer, right-click your IdentityMySQLDemo project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="afb49-176">V dialogovém okně hledání textového pole zadejte **Identity.EntityFramework**.</span><span class="sxs-lookup"><span data-stu-id="afb49-176">In the search text box dialog, type **Identity.EntityFramework**.</span></span> <span data-ttu-id="afb49-177">V seznamu výsledků vyberte tento balíček a klikněte na tlačítko **odinstalovat**.</span><span class="sxs-lookup"><span data-stu-id="afb49-177">Select this package in the list of results and click **Uninstall**.</span></span> <span data-ttu-id="afb49-178">Zobrazí výzva pro odinstalaci balíčku závislosti objektu EntityFramework.</span><span class="sxs-lookup"><span data-stu-id="afb49-178">You will be prompted to uninstall the dependency package EntityFramework.</span></span> <span data-ttu-id="afb49-179">Klikněte na Ano, jak to uděláme už tento balíček na tuto aplikaci.</span><span class="sxs-lookup"><span data-stu-id="afb49-179">Click on Yes as we will no longer this package on this application.</span></span>
5. <span data-ttu-id="afb49-180">Klikněte pravým tlačítkem na projekt IdentityMySQLDemo, vyberte **přidat**, **odkaz, řešení, projekty;** vyberte AspNet.Identity.MySQL projekt a klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="afb49-180">Right click the IdentityMySQLDemo project, select **Add**, **Reference, Solution, Projects;** select the AspNet.Identity.MySQL project and click **OK**.</span></span>
6. <span data-ttu-id="afb49-181">V projektu IdentityMySQLDemo nahraďte všechny odkazy na</span><span class="sxs-lookup"><span data-stu-id="afb49-181">In the IdentityMySQLDemo project, replace all references to</span></span>  
    `using Microsoft.AspNet.Identity.EntityFramework;`  
   <span data-ttu-id="afb49-182">with</span><span class="sxs-lookup"><span data-stu-id="afb49-182">with</span></span>  
     `using AspNet.Identity.MySQL;`
7. <span data-ttu-id="afb49-183">V IdentityModels.cs, nastavte **ApplicationDbContext** odvodit z **MySqlDatabase** a zahrnují konstruktoru, který obsahovat jeden parametr s názvem připojení.</span><span class="sxs-lookup"><span data-stu-id="afb49-183">In IdentityModels.cs, set **ApplicationDbContext** to derive from **MySqlDatabase** and include a contructor that take a single parameter with the connection name.</span></span>  

    [!code-csharp[Main](implementing-a-custom-mysql-aspnet-identity-storage-provider/samples/sample1.cs)]
8. <span data-ttu-id="afb49-184">Otevřete soubor IdentityConfig.cs.</span><span class="sxs-lookup"><span data-stu-id="afb49-184">Open the IdentityConfig.cs file.</span></span> <span data-ttu-id="afb49-185">V **ApplicationUserManager.Create** metody, nahraďte vytvoření instance objektu UserManager následujícím kódem:</span><span class="sxs-lookup"><span data-stu-id="afb49-185">In the **ApplicationUserManager.Create** method, replace instantiating UserManager with the following code:</span></span>  

    [!code-csharp[Main](implementing-a-custom-mysql-aspnet-identity-storage-provider/samples/sample2.cs)]
9. <span data-ttu-id="afb49-186">Otevřete soubor web.config a nahraďte řetězec objekt DefaultConnection tuto položku zadejte zvýrazněné hodnoty připojovacího řetězce databáze MySQL, kterou jste vytvořili v předchozích krocích:</span><span class="sxs-lookup"><span data-stu-id="afb49-186">Open the web.config file and replace the DefaultConnection string with this entry replacing the highlighted values with the connection string of the MySQL database you created on previous steps:</span></span>  

    [!code-xml[Main](implementing-a-custom-mysql-aspnet-identity-storage-provider/samples/sample3.xml?highlight=2)]

## <a name="run-the-app-and-connect-to-the-mysql-db"></a><span data-ttu-id="afb49-187">Spusťte aplikaci a připojte se k databázi MySQL</span><span class="sxs-lookup"><span data-stu-id="afb49-187">Run the app and connect to the MySQL DB</span></span>

1. <span data-ttu-id="afb49-188">Klikněte pravým tlačítkem myši **IdentityMySQLDemo** projektu a vyberte **nastavit jako spouštěný projekt**</span><span class="sxs-lookup"><span data-stu-id="afb49-188">Right click the **IdentityMySQLDemo** project and select **Set as Startup Project**</span></span>
2. <span data-ttu-id="afb49-189">Stisknutím klávesy **Ctrl + F5** sestavíte a spustíte aplikaci.</span><span class="sxs-lookup"><span data-stu-id="afb49-189">Press **Ctrl + F5** to build and run the app.</span></span>
3. <span data-ttu-id="afb49-190">Klikněte na **zaregistrovat** kartě v horní části stránky.</span><span class="sxs-lookup"><span data-stu-id="afb49-190">Click on **Register** tab on the top of the page.</span></span>
4. <span data-ttu-id="afb49-191">Zadejte nové uživatelské jméno a heslo a potom klikněte na **zaregistrovat**.</span><span class="sxs-lookup"><span data-stu-id="afb49-191">Enter a new user name and password and then click on **Register**.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image8.png)
5. <span data-ttu-id="afb49-192">Nový uživatel je teď zaregistrované a přihlášení.</span><span class="sxs-lookup"><span data-stu-id="afb49-192">The new user is now registered and logged in.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image9.png)
6. <span data-ttu-id="afb49-193">Přejděte zpět do nástroje MySQL Workbench a zkontrolujte **IdentityMySQLDatabase** obsah této tabulky.</span><span class="sxs-lookup"><span data-stu-id="afb49-193">Go back to the MySQL Workbench tool and inspect the **IdentityMySQLDatabase** table's contents.</span></span> <span data-ttu-id="afb49-194">Kontrola tabulce uživatele pro položky při registraci nového uživatele.</span><span class="sxs-lookup"><span data-stu-id="afb49-194">Inspect the users table for the entries as you register new users.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image10.png)

## <a name="next-steps"></a><span data-ttu-id="afb49-195">Další kroky</span><span class="sxs-lookup"><span data-stu-id="afb49-195">Next Steps</span></span>

<span data-ttu-id="afb49-196">Další informace o tom, jak povolit další metody ověřování v této aplikaci, najdete [vytvoření aplikace ASP.NET MVC 5 pomocí Facebooku a Google OAuth2 nebo OpenID Sign-on](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md).</span><span class="sxs-lookup"><span data-stu-id="afb49-196">For more information on how to enable other authentication methods on this app, refer to [Create an ASP.NET MVC 5 App with Facebook and Google OAuth2 and OpenID Sign-on](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md).</span></span>

<span data-ttu-id="afb49-197">Zjistěte, jak integrovat vaše databáze s OAuth a nastavit role a omezit přístup uživatele k vaší aplikaci, najdete v článku [Nasaďte aplikaci zabezpečené aplikace ASP.NET MVC 5 s nástroji Membership, OAuth a SQL Database do Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span><span class="sxs-lookup"><span data-stu-id="afb49-197">To learn how to integrate your DB with OAuth and to set up roles to limit users access to your app, see [Deploy a Secure ASP.NET MVC 5 app with Membership, OAuth, and SQL Database to Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span></span>
