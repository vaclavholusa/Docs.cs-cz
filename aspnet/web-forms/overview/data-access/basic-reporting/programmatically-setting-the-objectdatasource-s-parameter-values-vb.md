---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
title: Programové nastavení hodnot parametru ObjectDataSource (VB) | Dokumentace Microsoftu
author: rick-anderson
description: V tomto kurzu podíváme na přidání metody do našich DAL a BLL, která přijímá jeden vstupní parametr a vrací data. V příkladu nastaví tento parametr...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 0ecb03b6-52a0-4731-8c7a-436391d36838
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-vb
msc.type: authoredcontent
ms.openlocfilehash: f823d1db7f98dcbbef12d20df4a28e39fae0ac26
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/16/2018
ms.locfileid: "41752007"
---
<a name="programmatically-setting-the-objectdatasources-parameter-values-vb"></a><span data-ttu-id="ee444-104">Programové nastavení hodnot parametru ObjectDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="ee444-104">Programmatically Setting the ObjectDataSource's Parameter Values (VB)</span></span>
====================
<span data-ttu-id="ee444-105">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ee444-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ee444-106">[Stáhněte si ukázkovou aplikaci](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe) nebo [stahovat PDF](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ee444-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_6_VB.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/datatutorial06vb1.pdf)</span></span>

> <span data-ttu-id="ee444-107">V tomto kurzu podíváme na přidání metody do našich DAL a BLL, která přijímá jeden vstupní parametr a vrací data.</span><span class="sxs-lookup"><span data-stu-id="ee444-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="ee444-108">V příkladu se tento parametr nastavit prostřednictvím kódu programu.</span><span class="sxs-lookup"><span data-stu-id="ee444-108">The example will set this parameter programmatically.</span></span>


## <a name="introduction"></a><span data-ttu-id="ee444-109">Úvod</span><span class="sxs-lookup"><span data-stu-id="ee444-109">Introduction</span></span>

<span data-ttu-id="ee444-110">Jak jsme viděli v [předchozí kurz o službě](declarative-parameters-vb.md), řadu možností, které jsou k dispozici pro deklarativně předání hodnot parametru ObjectDataSource metody.</span><span class="sxs-lookup"><span data-stu-id="ee444-110">As we saw in the [previous tutorial](declarative-parameters-vb.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="ee444-111">Pokud je hodnota parametru pevně zakódované, pochází z webový ovládací prvek na stránce nebo v kterýkoli jiný zdroj, který je čitelný ve zdroji dat `Parameter` objektu, například, že hodnota může být vázaný na vstupní parametr bez nutnosti psaní jediného řádku kódu.</span><span class="sxs-lookup"><span data-stu-id="ee444-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="ee444-112">Může nastat situace, ale když hodnota parametru pocházejí z některé zdroje není již bylo začleněno pomocí jedné z předdefinované datové zdroje `Parameter` objekty.</span><span class="sxs-lookup"><span data-stu-id="ee444-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="ee444-113">Pokud uživatelské účty podporována náš web budeme chtít nastavit parametr podle aktuálně přihlášeného uživatelského ID. návštěvníka</span><span class="sxs-lookup"><span data-stu-id="ee444-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="ee444-114">Nebo nám může být třeba přizpůsobit hodnotu parametru před odesláním podél metodě ObjectDataSource základní objekt.</span><span class="sxs-lookup"><span data-stu-id="ee444-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="ee444-115">Pokaždé, když prvku ObjectDataSource `Select` je vyvolána metoda ObjectDataSource nejprve vyvolá jeho [události Selecting](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="ee444-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="ee444-116">Potom je volána metoda ObjectDataSource základní objekt.</span><span class="sxs-lookup"><span data-stu-id="ee444-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="ee444-117">Jakmile, která se dokončí prvku ObjectDataSource [vybrané události](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) aktivuje (toto pořadí událostí, které znázorňuje obrázek 1).</span><span class="sxs-lookup"><span data-stu-id="ee444-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="ee444-118">Parametr hodnoty předané do metody ObjectDataSource základní objekt můžete nastavit nebo upravit v obslužné rutině události pro `Selecting` událostí.</span><span class="sxs-lookup"><span data-stu-id="ee444-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>


<span data-ttu-id="ee444-119">[![Je vyvolána ObjectDataSource vybrané a výběr Fire události před a po jeho základního objektu – metoda](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ee444-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image1.png)</span></span>

<span data-ttu-id="ee444-120">**Obrázek 1**: prvku ObjectDataSource `Selected` a `Selecting` je vyvolána metoda Fire události před a po jeho základního objektu ([kliknutím ji zobrazíte obrázek v plné velikosti](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ee444-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image3.png))</span></span>


<span data-ttu-id="ee444-121">V tomto kurzu se podíváme přidání metody do našich DAL a BLL, která přijímá jeden vstupní parametr `Month`, typu `Integer` a vrátí `EmployeesDataTable` vyplní zaměstnanců, které mají jejich náborovou výročí v zadaném objektu `Month`.</span><span class="sxs-lookup"><span data-stu-id="ee444-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `Integer` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="ee444-122">Náš příklad nastaví tento parametr prostřednictvím kódu programu na základě aktuálního měsíce zobrazujícím seznam "Výročí tohoto měsíce."</span><span class="sxs-lookup"><span data-stu-id="ee444-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="ee444-123">Pusťme se do práce!</span><span class="sxs-lookup"><span data-stu-id="ee444-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="ee444-124">Krok 1: Přidání metody do`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="ee444-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="ee444-125">V našem prvním příkladu potřebujeme přidat prostředky k načtení těchto zaměstnanci jehož `HireDate` došlo k chybě v zadaném měsíci.</span><span class="sxs-lookup"><span data-stu-id="ee444-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="ee444-126">Tuto funkčnost v souladu s naší architektury, je nutné nejprve vytvořit metodu v `EmployeesTableAdapter` , která se mapuje na správný příkaz SQL.</span><span class="sxs-lookup"><span data-stu-id="ee444-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="ee444-127">Chcete-li to provést, začněte otevřením typová Northwind.</span><span class="sxs-lookup"><span data-stu-id="ee444-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="ee444-128">Klikněte pravým tlačítkem na `EmployeesTableAdapter` označovat popisky a zvolte Přidat dotaz.</span><span class="sxs-lookup"><span data-stu-id="ee444-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>


<span data-ttu-id="ee444-129">[![Přidat nový dotaz EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ee444-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image4.png)</span></span>

<span data-ttu-id="ee444-130">**Obrázek 2**: Přidat nový dotaz, který `EmployeesTableAdapter` ([kliknutím ji zobrazíte obrázek v plné velikosti](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ee444-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image6.png))</span></span>


<span data-ttu-id="ee444-131">Zvolte Přidat příkaz SQL, který vrátí řádky.</span><span class="sxs-lookup"><span data-stu-id="ee444-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="ee444-132">Když se dostanete určení `SELECT` výchozí obrazovky – příkaz `SELECT` příkaz pro `EmployeesTableAdapter` už se načtou.</span><span class="sxs-lookup"><span data-stu-id="ee444-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="ee444-133">Jednoduše přidejte v `WHERE` klauzule: `WHERE DATEPART(m, HireDate) = @Month`.</span><span class="sxs-lookup"><span data-stu-id="ee444-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="ee444-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) je funkce jazyka T-SQL, která vrací část konkrétní datum `datetime` typ; v tomto případě používáme `DATEPART` vrátit z měsíce `HireDate` sloupce.</span><span class="sxs-lookup"><span data-stu-id="ee444-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>


<span data-ttu-id="ee444-135">[![Vrácení pouze těch řádky kde HireDate sloupec je menší než nebo rovno @HiredBeforeDate parametr](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ee444-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image7.png)</span></span>

<span data-ttu-id="ee444-136">**Obrázek 3**: vrátí pouze ty řádky kde `HireDate` sloupec je menší než nebo rovna hodnotě `@HiredBeforeDate` parametr ([kliknutím ji zobrazíte obrázek v plné velikosti](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ee444-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image9.png))</span></span>


<span data-ttu-id="ee444-137">Nakonec změňte `FillBy` a `GetDataBy` metoda názvů pro `FillByHiredDateMonth` a `GetEmployeesByHiredDateMonth`v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="ee444-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>


<span data-ttu-id="ee444-138">[![Vyberte vhodnější názvy metod než FillBy a GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ee444-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image10.png)</span></span>

<span data-ttu-id="ee444-139">**Obrázek 4**: Zvolte více odpovídající metoda názvy než `FillBy` a `GetDataBy` ([kliknutím ji zobrazíte obrázek v plné velikosti](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ee444-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image12.png))</span></span>


<span data-ttu-id="ee444-140">Kliknutím na tlačítko Dokončit dokončete průvodce a vraťte se do datové sady návrhovou plochu.</span><span class="sxs-lookup"><span data-stu-id="ee444-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="ee444-141">`EmployeesTableAdapter` By teď měl obsahovat novou sadu metod pro přístup k zaměstnance zařazené v zadaném měsíci.</span><span class="sxs-lookup"><span data-stu-id="ee444-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>


<span data-ttu-id="ee444-142">[![Nové metody se zobrazí v návrhové ploše datové sady](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ee444-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image13.png)</span></span>

<span data-ttu-id="ee444-143">**Obrázek 5**: The nové metody se zobrazí v návrhové ploše datové sady ([kliknutím ji zobrazíte obrázek v plné velikosti](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="ee444-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image15.png))</span></span>


## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="ee444-144">Krok 2: Přidání`GetEmployeesByHiredDateMonth(month)`metodu pro vrstvy obchodní logiky</span><span class="sxs-lookup"><span data-stu-id="ee444-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="ee444-145">Protože naše aplikace architektura používá samostatné vrstvy pro obchodní logiku a data získat přístup k logiku, musíme přidat metody do našich knihoven BLL, který si najali, volání do vrstvy DAL k načtení zaměstnanci před určitým datem.</span><span class="sxs-lookup"><span data-stu-id="ee444-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="ee444-146">Otevřít `EmployeesBLL.vb` a přidejte následující metodu:</span><span class="sxs-lookup"><span data-stu-id="ee444-146">Open the `EmployeesBLL.vb` file and add the following method:</span></span>


[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample1.vb)]

<span data-ttu-id="ee444-147">Stejně jako u našich jiné metody v této třídě `GetEmployeesByHiredDateMonth(month)` jednoduše volá do vrstvy DAL a vrátí výsledky.</span><span class="sxs-lookup"><span data-stu-id="ee444-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="ee444-148">Krok 3: Zobrazení zaměstnanců, jehož náborovou výročí je tento měsíc</span><span class="sxs-lookup"><span data-stu-id="ee444-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="ee444-149">Posledním krokem v tomto příkladu je zobrazení těchto zaměstnanců, jehož náborovou výročí je tento měsíc.</span><span class="sxs-lookup"><span data-stu-id="ee444-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="ee444-150">Začněte přidáním GridView k `ProgrammaticParams.aspx` stránku `BasicReporting` složky a přidejte nový prvek ObjectDataSource jako svůj zdroj dat.</span><span class="sxs-lookup"><span data-stu-id="ee444-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="ee444-151">Konfigurace ObjectDataSource používat `EmployeesBLL` třídy s `SelectMethod` nastavena na `GetEmployeesByHiredDateMonth(month)`.</span><span class="sxs-lookup"><span data-stu-id="ee444-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>


<span data-ttu-id="ee444-152">[![Použití třídy EmployeesBLL](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ee444-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image16.png)</span></span>

<span data-ttu-id="ee444-153">**Obrázek 6**: použijte `EmployeesBLL` třídy ([kliknutím ji zobrazíte obrázek v plné velikosti](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="ee444-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image18.png))</span></span>


<span data-ttu-id="ee444-154">[![Vyberte z the GetEmployeesByHiredDateMonth(month) – metoda](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ee444-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image19.png)</span></span>

<span data-ttu-id="ee444-155">**Obrázek 7**: vyberte z `GetEmployeesByHiredDateMonth(month)` – metoda ([kliknutím ji zobrazíte obrázek v plné velikosti](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ee444-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image21.png))</span></span>


<span data-ttu-id="ee444-156">Poslední obrazovka zobrazí dotaz, abychom mohli poskytovat `month` zdroje hodnotu parametru.</span><span class="sxs-lookup"><span data-stu-id="ee444-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="ee444-157">Vzhledem k tomu, že tato hodnota nastavíme prostřednictvím kódu programu, ponechejte zdroji parametru nastavenou na výchozí hodnotu None možnosti a klikněte na tlačítko Dokončit.</span><span class="sxs-lookup"><span data-stu-id="ee444-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>


<span data-ttu-id="ee444-158">[![Ponechte zdrojová sada parametr na hodnotu None](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ee444-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image22.png)</span></span>

<span data-ttu-id="ee444-159">**Obrázek 8**: ponechte zdrojový parametr nastaven na hodnotu None ([kliknutím ji zobrazíte obrázek v plné velikosti](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="ee444-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image24.png))</span></span>


<span data-ttu-id="ee444-160">Tím se vytvoří `Parameter` objektu v prvku ObjectDataSource `SelectParameters` kolekce, ve kterém není zadána žádná hodnota.</span><span class="sxs-lookup"><span data-stu-id="ee444-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>


[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample2.aspx)]

<span data-ttu-id="ee444-161">Nastavení této hodnoty prostřednictvím kódu programu, potřebujeme vytvořit obslužnou rutinu události pro ObjectDataSource `Selecting` událostí.</span><span class="sxs-lookup"><span data-stu-id="ee444-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="ee444-162">Chcete-li to provést, přejděte do zobrazení návrhu a dvakrát klikněte na panel prvku ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ee444-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="ee444-163">Alternativně vyberte ObjectDataSource, přejděte do okna Vlastnosti a klikněte ikonu blesku.</span><span class="sxs-lookup"><span data-stu-id="ee444-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="ee444-164">V dalším kroku buď poklepejte na položku v textovém poli vedle `Selecting` události nebo zadejte název obslužné rutiny události, kterou chcete použít.</span><span class="sxs-lookup"><span data-stu-id="ee444-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span> <span data-ttu-id="ee444-165">Třetí možností, můžete vytvořit obslužnou rutinu události tak, že vyberete ObjectDataSource a jeho `Selecting` události ze dvou seznamů rozevíracího seznamu v horní části třídy modelu code-behind stránky.</span><span class="sxs-lookup"><span data-stu-id="ee444-165">As a third option, you can create the event handler by selecting the ObjectDataSource and its `Selecting` event from the two drop-down lists at the top of the page's code-behind class.</span></span>


![Klikněte na na ikonu blesku v okně Vlastnosti události ovládacího prvku seznam](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image25.png)

<span data-ttu-id="ee444-167">**Obrázek 9**: klikněte na na ikonu blesku v okně Vlastnosti události ovládacího prvku seznam</span><span class="sxs-lookup"><span data-stu-id="ee444-167">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>


<span data-ttu-id="ee444-168">Všechny tři přístupy přidat novou obslužnou rutinu události pro ObjectDataSource `Selecting` událostí k použití modelu code-behind třídy stránky.</span><span class="sxs-lookup"><span data-stu-id="ee444-168">All three approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="ee444-169">V této obslužné rutiny události jsme čtení a zápis do hodnot parametru pomocí `e.InputParameters(parameterName)`, kde *`parameterName`* je hodnota `Name` atribut `<asp:Parameter>` značky ( `InputParameters` kolekce může být také indexované ordinally, stejně jako v `e.InputParameters(index)`).</span><span class="sxs-lookup"><span data-stu-id="ee444-169">In this event handler we can read and write to the parameter values using `e.InputParameters(parameterName)`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters(index)`).</span></span> <span data-ttu-id="ee444-170">Chcete-li nastavit `month` parametr pro aktuální měsíc, přidejte následující text do `Selecting` obslužné rutiny události:</span><span class="sxs-lookup"><span data-stu-id="ee444-170">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>


[!code-vb[Main](programmatically-setting-the-objectdatasource-s-parameter-values-vb/samples/sample3.vb)]

<span data-ttu-id="ee444-171">Při návštěvě této stránky prostřednictvím prohlížeče můžeme vidět pouze jednoho zaměstnance byl přijat tento měsíc (březen) Novák Laura, který byl od 1994 ve společnosti.</span><span class="sxs-lookup"><span data-stu-id="ee444-171">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>


<span data-ttu-id="ee444-172">[![Tyto zaměstnanci, jejichž výročí tento měsíc jsou uvedeny.](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="ee444-172">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image26.png)</span></span>

<span data-ttu-id="ee444-173">**Obrázek 10**: těch zaměstnanci jejichž výročí tento měsíc jsou uvedeny ([kliknutím ji zobrazíte obrázek v plné velikosti](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="ee444-173">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-vb/_static/image28.png))</span></span>


## <a name="summary"></a><span data-ttu-id="ee444-174">Souhrn</span><span class="sxs-lookup"><span data-stu-id="ee444-174">Summary</span></span>

<span data-ttu-id="ee444-175">Když prvku ObjectDataSource parametry obvykle lze nastavit hodnoty deklarativní, bez nutnosti psát kód, je snadné programové nastavení hodnot parametrů.</span><span class="sxs-lookup"><span data-stu-id="ee444-175">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="ee444-176">Všechny musíme udělat, je vytvořit obslužnou rutinu události pro ObjectDataSource `Selecting` událost, která se vyvolá před základní objekt metoda vyvolána a ručně nastavit hodnoty pro jeden nebo více parametrů prostřednictvím `InputParameters` kolekce.</span><span class="sxs-lookup"><span data-stu-id="ee444-176">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="ee444-177">V tomto kurzu končí část základní tvorbou sestav.</span><span class="sxs-lookup"><span data-stu-id="ee444-177">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="ee444-178">[Další kurz](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) zahajuje filtrování a scénáře hlavních-podrobných oddílu, ve kterém vytvoříme podívejte se na techniky umožňující návštěvníka pro filtrování dat a k podrobnostem z hlavní sestavy do sestavy podrobností.</span><span class="sxs-lookup"><span data-stu-id="ee444-178">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="ee444-179">Všechno nejlepší programování!</span><span class="sxs-lookup"><span data-stu-id="ee444-179">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ee444-180">O autorovi</span><span class="sxs-lookup"><span data-stu-id="ee444-180">About the Author</span></span>

<span data-ttu-id="ee444-181">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a Zakladatel [4GuysFromRolla.com](http://www.4guysfromrolla.com), má práce s Microsoft webových technologiích od roku 1998.</span><span class="sxs-lookup"><span data-stu-id="ee444-181">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ee444-182">Scott funguje jako nezávislý konzultant, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="ee444-182">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ee444-183">Jeho nejnovější knihy [ *Edice nakladatelství Sams naučit sami ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="ee444-183">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ee444-184">Může být dosáhl v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ee444-184">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ee444-185">nebo prostřednictvím jeho blogu, který lze nalézt v [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="ee444-185">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ee444-186">Speciální k</span><span class="sxs-lookup"><span data-stu-id="ee444-186">Special Thanks To</span></span>

<span data-ttu-id="ee444-187">V této sérii kurzů byl recenzován uživatelem mnoho užitečných revidující.</span><span class="sxs-lookup"><span data-stu-id="ee444-187">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ee444-188">Vedoucí kontrolor pro účely tohoto kurzu byla Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="ee444-188">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="ee444-189">Zajímat téma Moje nadcházejících článcích MSDN?</span><span class="sxs-lookup"><span data-stu-id="ee444-189">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ee444-190">Pokud ano, vyřaďte mě řádek na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ee444-190">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="ee444-191">Předchozí</span><span class="sxs-lookup"><span data-stu-id="ee444-191">Previous</span></span>](declarative-parameters-vb.md)
