---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
title: Zpracování výjimek na úrovni knihoven BLL a DAL (VB) | Dokumentace Microsoftu
author: rick-anderson
description: V tomto kurzu se podíváme tactfully zpracování výjimky vyvolána během pracovního postupu aktualizace upravitelné DataList.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: ca665073-b379-4239-9404-f597663ca65e
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/handling-bll-and-dal-level-exceptions-vb
msc.type: authoredcontent
ms.openlocfilehash: e71ad365ecbfc1bb33117a6c93e7108a4b3866a6
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/16/2018
ms.locfileid: "41755451"
---
<a name="handling-bll--and-dal-level-exceptions-vb"></a><span data-ttu-id="82f34-103">Zpracování výjimek na úrovni knihoven BLL a DAL (VB)</span><span class="sxs-lookup"><span data-stu-id="82f34-103">Handling BLL- and DAL-Level Exceptions (VB)</span></span>
====================
<span data-ttu-id="82f34-104">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="82f34-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="82f34-105">[Stáhněte si ukázkovou aplikaci](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) nebo [stahovat PDF](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="82f34-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_38_VB.exe) or [Download PDF](handling-bll-and-dal-level-exceptions-vb/_static/datatutorial38vb1.pdf)</span></span>

> <span data-ttu-id="82f34-106">V tomto kurzu se podíváme tactfully zpracování výjimky vyvolána během pracovního postupu aktualizace upravitelné DataList.</span><span class="sxs-lookup"><span data-stu-id="82f34-106">In this tutorial, we'll see how to tactfully handle exceptions raised during an editable DataList's updating workflow.</span></span>


## <a name="introduction"></a><span data-ttu-id="82f34-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="82f34-107">Introduction</span></span>

<span data-ttu-id="82f34-108">V [Přehled úprav a odstraňování dat v ovládacím prvku DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) kurzu jsme vytvořili DataList, která nabízejí jednoduché úpravy a odstranění funkce.</span><span class="sxs-lookup"><span data-stu-id="82f34-108">In the [Overview of Editing and Deleting Data in the DataList](an-overview-of-editing-and-deleting-data-in-the-datalist-cs.md) tutorial, we created a DataList that offered simple editing and deleting capabilities.</span></span> <span data-ttu-id="82f34-109">Zatímco plně funkční, bylo téměř uživatelsky přívětivé jako všechny chyby, ke které došlo během úpravy nebo odstranění proces vedl k neošetřené výjimce.</span><span class="sxs-lookup"><span data-stu-id="82f34-109">While fully functional, it was hardly user-friendly, as any error that occurred during the editing or deleting process resulted in an unhandled exception.</span></span> <span data-ttu-id="82f34-110">Například vynechání produkt s názvem nebo při úpravách produktu, zadáním hodnoty cena velmi cenově!, dojde k výjimce.</span><span class="sxs-lookup"><span data-stu-id="82f34-110">For example, omitting the product s name or, when editing a product, entering a price value of Very affordable!, throws an exception.</span></span> <span data-ttu-id="82f34-111">Vzhledem k tomu, že tato výjimka není zachycena v kódu, bubliny až modul runtime ASP.NET, která zobrazí podrobnosti o výjimce s na webové stránce.</span><span class="sxs-lookup"><span data-stu-id="82f34-111">Since this exception is not caught in code, it bubbles up to the ASP.NET runtime, which then displays the exception s details in the web page.</span></span>

<span data-ttu-id="82f34-112">Jak jsme viděli v [zpracování knihoven BLL a výjimek úrovni DAL na stránce ASP.NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) kurz, pokud je vyvolána výjimka z hlubin obchodní logikou nebo vrstvy přístupu k datům, podrobnosti výjimky jsou vráceny do ObjectDataSource a potom do prvku GridView.</span><span class="sxs-lookup"><span data-stu-id="82f34-112">As we saw in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md) tutorial, if an exception is raised from the depths of the Business Logic or Data Access Layers, the exception details are returned to the ObjectDataSource and then to the GridView.</span></span> <span data-ttu-id="82f34-113">Jsme viděli, jak tyto výjimky elegantně zpracovat tak, že vytvoříte `Updated` nebo `RowUpdated` obslužné rutiny událostí pro prvek ObjectDataSource nebo prvku GridView, kontrola výjimku a pak označující, že výjimka byla zpracována.</span><span class="sxs-lookup"><span data-stu-id="82f34-113">We saw how to gracefully handle these exceptions by creating `Updated` or `RowUpdated` event handlers for the ObjectDataSource or GridView, checking for an exception, and then indicating that the exception was handled.</span></span>

<span data-ttu-id="82f34-114">Naše DataList kurzy, ale nejsou t pro aktualizace a odstranění dat pomocí ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="82f34-114">Our DataList tutorials, however, aren t using the ObjectDataSource for updating and deleting data.</span></span> <span data-ttu-id="82f34-115">Místo toho spolupracujeme přímo proti BLL.</span><span class="sxs-lookup"><span data-stu-id="82f34-115">Instead, we are working directly against the BLL.</span></span> <span data-ttu-id="82f34-116">Aby bylo možné zjišťování výjimek pocházejících z knihoven BLL a DAL, musíme implementovat kódu v rámci kódu naši stránku ASP.NET pro zpracování výjimek.</span><span class="sxs-lookup"><span data-stu-id="82f34-116">In order to detect exceptions originating from the BLL or DAL, we need to implement exception handling code within the code-behind of our ASP.NET page.</span></span> <span data-ttu-id="82f34-117">V tomto kurzu uvidíme více tactfully zpracování výjimky vyvolána během upravitelné DataList s aktualizace pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="82f34-117">In this tutorial, we'll see how to more tactfully handle exceptions raised during an editable DataList s updating workflow.</span></span>

> [!NOTE]
> <span data-ttu-id="82f34-118">V *přehled o úpravy a odstraňování dat v ovládacím prvku DataList* pomocí ObjectDataSource pro aktualizaci zahrnuty některé techniky kurzu jsme probírali různých postupů pro úpravy a odstraňování dat v ovládacím prvku DataList a Odstraňuje se.</span><span class="sxs-lookup"><span data-stu-id="82f34-118">In the *An Overview of Editing and Deleting Data in the DataList* tutorial we discussed different techniques for editing and deleting data from the DataList, Some techniques involved using an ObjectDataSource for updating and deleting.</span></span> <span data-ttu-id="82f34-119">Pokud tyto postupy, můžete zpracovávat výjimky z knihoven BLL a DAL pomocí prvku ObjectDataSource s `Updated` nebo `Deleted` obslužných rutin událostí.</span><span class="sxs-lookup"><span data-stu-id="82f34-119">If you employ these techniques, you can handle exceptions from the BLL or DAL through the ObjectDataSource s `Updated` or `Deleted` event handlers.</span></span>


## <a name="step-1-creating-an-editable-datalist"></a><span data-ttu-id="82f34-120">Krok 1: Vytvoření upravitelné DataList</span><span class="sxs-lookup"><span data-stu-id="82f34-120">Step 1: Creating an Editable DataList</span></span>

<span data-ttu-id="82f34-121">Předtím, než jsme starat o zpracování výjimek, ke kterým dochází při aktualizaci pracovního postupu, umožní s nejprve vytvořit upravitelné DataList.</span><span class="sxs-lookup"><span data-stu-id="82f34-121">Before we worry about handling exceptions that occur during the updating workflow, let s first create an editable DataList.</span></span> <span data-ttu-id="82f34-122">Otevřít `ErrorHandling.aspx` stránku `EditDeleteDataList` složky, přidat a v prvku DataList do návrháře, nastavte jeho `ID` vlastnost `Products`, a přidejte nový prvek ObjectDataSource s názvem `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="82f34-122">Open the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder, add a DataList to the Designer, set its `ID` property to `Products`, and add a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="82f34-123">Konfigurace ObjectDataSource používat `ProductsBLL` třída s `GetProducts()` zaznamenává metodu pro výběr; nastavte rozevírací seznamy v INSERT, UPDATE a odstranit karty na (žádný).</span><span class="sxs-lookup"><span data-stu-id="82f34-123">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="82f34-124">[![Vrátí informace o produktu pomocí GetProducts() – metoda](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="82f34-124">[![Return the Product Information Using the GetProducts() Method](handling-bll-and-dal-level-exceptions-vb/_static/image2.png)](handling-bll-and-dal-level-exceptions-vb/_static/image1.png)</span></span>

<span data-ttu-id="82f34-125">**Obrázek 1**: vrátit informací pomocí produktu `GetProducts()` – metoda ([kliknutím ji zobrazíte obrázek v plné velikosti](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="82f34-125">**Figure 1**: Return the Product Information Using the `GetProducts()` Method ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image3.png))</span></span>


<span data-ttu-id="82f34-126">Po dokončení Průvodce prvek ObjectDataSource, vytvoří Visual Studio automaticky `ItemTemplate` pro prvku DataList.</span><span class="sxs-lookup"><span data-stu-id="82f34-126">After completing the ObjectDataSource wizard, Visual Studio will automatically create an `ItemTemplate` for the DataList.</span></span> <span data-ttu-id="82f34-127">Nahraďte ho názvem `ItemTemplate` , který se zobrazí každý produkt s názvem a ceny a obsahuje tlačítko pro úpravy.</span><span class="sxs-lookup"><span data-stu-id="82f34-127">Replace this with an `ItemTemplate` that displays each product s name and price and includes an Edit button.</span></span> <span data-ttu-id="82f34-128">Dále vytvořte `EditItemTemplate` s ovládacím prvkem webového textové pole pro název a ceny a aktualizace a zrušit.</span><span class="sxs-lookup"><span data-stu-id="82f34-128">Next, create an `EditItemTemplate` with a TextBox Web control for name and price and Update and Cancel buttons.</span></span> <span data-ttu-id="82f34-129">Nakonec nastavte DataList s `RepeatColumns` vlastnost na 2.</span><span class="sxs-lookup"><span data-stu-id="82f34-129">Finally, set the DataList s `RepeatColumns` property to 2.</span></span>

<span data-ttu-id="82f34-130">Po provedení těchto změn kódu s deklarativní stránky s by měl vypadat nějak takto.</span><span class="sxs-lookup"><span data-stu-id="82f34-130">After these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="82f34-131">Překontrolujte, ujistěte se, že úprav, zrušení, a aktualizace tlačítka mají jejich `CommandName` vlastnosti nastavení upravit, zrušit a aktualizovat v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="82f34-131">Double-check to make certain that the Edit, Cancel, and Update buttons have their `CommandName` properties set to Edit, Cancel, and Update, respectively.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="82f34-132">Pro účely tohoto kurzu prvku DataList musí být povolen stav zobrazení s.</span><span class="sxs-lookup"><span data-stu-id="82f34-132">For this tutorial the DataList s view state must be enabled.</span></span>


<span data-ttu-id="82f34-133">Za chvíli zobrazíte náš postup přes prohlížeč (viz obrázek 2).</span><span class="sxs-lookup"><span data-stu-id="82f34-133">Take a moment to view our progress through a browser (see Figure 2).</span></span>


<span data-ttu-id="82f34-134">[![Každý produkt obsahuje tlačítko pro úpravy](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="82f34-134">[![Each Product Includes an Edit Button](handling-bll-and-dal-level-exceptions-vb/_static/image5.png)](handling-bll-and-dal-level-exceptions-vb/_static/image4.png)</span></span>

<span data-ttu-id="82f34-135">**Obrázek 2**: každý produkt obsahuje tlačítko Upravit ([kliknutím ji zobrazíte obrázek v plné velikosti](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="82f34-135">**Figure 2**: Each Product Includes an Edit Button ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image6.png))</span></span>


<span data-ttu-id="82f34-136">V současné době na tlačítko Upravit pouze vyvolá zpětné volání je t kódu ještě používání produktu snazší upravovat.</span><span class="sxs-lookup"><span data-stu-id="82f34-136">Currently, the Edit button only causes a postback it doesn t yet make the product editable.</span></span> <span data-ttu-id="82f34-137">Aby se povolily úpravy, potřebujeme vytvořit obslužné rutiny událostí pro DataList s `EditCommand`, `CancelCommand`, a `UpdateCommand` události.</span><span class="sxs-lookup"><span data-stu-id="82f34-137">To enable editing, we need to create event handlers for the DataList s `EditCommand`, `CancelCommand`, and `UpdateCommand` events.</span></span> <span data-ttu-id="82f34-138">`EditCommand` a `CancelCommand` události jednoduše aktualizovat DataList s `EditItemIndex` vlastnost a obnovení vazby dat k ovládacím prvku DataList:</span><span class="sxs-lookup"><span data-stu-id="82f34-138">The `EditCommand` and `CancelCommand` events simply update the DataList s `EditItemIndex` property and rebind the data to the DataList:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample2.vb)]

<span data-ttu-id="82f34-139">`UpdateCommand` Obslužná rutina události se tak zapojí o něco víc.</span><span class="sxs-lookup"><span data-stu-id="82f34-139">The `UpdateCommand` event handler is a bit more involved.</span></span> <span data-ttu-id="82f34-140">Je potřeba si přečíst také upravených produktu s `ProductID` z `DataKeys` spolu s produkt s názvem a cenu z textových polí v kolekci `EditItemTemplate`a následně zavolat `ProductsBLL` třída s `UpdateProduct` metoda před vrácením prvku DataList do předem úprav stavu.</span><span class="sxs-lookup"><span data-stu-id="82f34-140">It needs to read in the edited product s `ProductID` from the `DataKeys` collection along with the product s name and price from the TextBoxes in the `EditItemTemplate`, and then call the `ProductsBLL` class s `UpdateProduct` method before returning the DataList to its pre-editing state.</span></span>

<span data-ttu-id="82f34-141">Prozatím použijte umožňují s právě přesně stejný kód z `UpdateCommand` obslužné rutině událostí ve *Přehled úprav a odstraňování dat v ovládacím prvku DataList* kurzu.</span><span class="sxs-lookup"><span data-stu-id="82f34-141">For now, let s just use the exact same code from the `UpdateCommand` event handler in the *Overview of Editing and Deleting Data in the DataList* tutorial.</span></span> <span data-ttu-id="82f34-142">Přidáme kód pro pohodlné zpracování výjimek v kroku 2.</span><span class="sxs-lookup"><span data-stu-id="82f34-142">We'll add the code to gracefully handle exceptions in step 2.</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample3.vb)]

<span data-ttu-id="82f34-143">I v případě neplatné zadání, což může být ve formě nesprávně formátovaná Jednotková cena, hodnotu neplatná jednotka cena takto: $5.00 nebo vynechání s název produktu, který bude vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="82f34-143">In the face of invalid input which can be in the form of an improperly formatted unit price, an illegal unit price value like -$5.00, or the omission of the product s name an exception will be raised.</span></span> <span data-ttu-id="82f34-144">Vzhledem k tomu, `UpdateCommand` obslužná rutina události neobsahuje žádné kód v tomto okamžiku zpracování výjimek, výjimky je předána do modulu runtime ASP.NET, ve kterém se zobrazí koncovému uživateli (viz obrázek 3).</span><span class="sxs-lookup"><span data-stu-id="82f34-144">Since the `UpdateCommand` event handler does not include any exception handling code at this point, the exception will bubble up to the ASP.NET runtime, where it will be displayed to the end user (see Figure 3).</span></span>


![Když dojde k neošetřené výjimce koncovému uživateli se zobrazí chybová stránka](handling-bll-and-dal-level-exceptions-vb/_static/image7.png)

<span data-ttu-id="82f34-146">**Obrázek 3**: když dojde k neošetřené výjimce koncovému uživateli se zobrazí chybová stránka</span><span class="sxs-lookup"><span data-stu-id="82f34-146">**Figure 3**: When an Unhandled Exception Occurs, the End User Sees an Error Page</span></span>


## <a name="step-2-gracefully-handling-exceptions-in-the-updatecommand-event-handler"></a><span data-ttu-id="82f34-147">Krok 2: Řádně zpracování výjimek v obslužné rutině události UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="82f34-147">Step 2: Gracefully Handling Exceptions in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="82f34-148">Během aktualizace pracovního postupu, může dojít k výjimkám v `UpdateCommand` obslužná rutina události, BLL nebo vrstvy DAL.</span><span class="sxs-lookup"><span data-stu-id="82f34-148">During the updating workflow, exceptions can occur in the `UpdateCommand` event handler, the BLL, or the DAL.</span></span> <span data-ttu-id="82f34-149">Například, pokud uživatel zadá cenu příliš drahé, `Decimal.Parse` příkaz v `UpdateCommand` vyvolá obslužnou rutinu události `FormatException` výjimky.</span><span class="sxs-lookup"><span data-stu-id="82f34-149">For example, if a user enters a price of Too expensive, the `Decimal.Parse` statement in the `UpdateCommand` event handler will throw a `FormatException` exception.</span></span> <span data-ttu-id="82f34-150">Pokud uživatel vynechá s názvem produktu nebo cena má zápornou hodnotu, bude DAL vyvolat výjimku.</span><span class="sxs-lookup"><span data-stu-id="82f34-150">If the user omits the product s name or if the price has a negative value, the DAL will raise an exception.</span></span>

<span data-ttu-id="82f34-151">Když dojde k výjimce, chceme zobrazit informativní zprávy v rámci samotné stránky.</span><span class="sxs-lookup"><span data-stu-id="82f34-151">When an exception occurs, we want to display an informative message within the page itself.</span></span> <span data-ttu-id="82f34-152">Přidat popisek webový ovládací prvek na stránce, jehož `ID` je nastavena na `ExceptionDetails`.</span><span class="sxs-lookup"><span data-stu-id="82f34-152">Add a Label Web control to the page whose `ID` is set to `ExceptionDetails`.</span></span> <span data-ttu-id="82f34-153">Konfigurace zobrazovaný v červené, velmi velká, písmo tučné písmo a kurzíva přiřazením text popisku s jeho `CssClass` vlastnost `Warning` třídu šablony stylů CSS, která je definována v `Styles.css` souboru.</span><span class="sxs-lookup"><span data-stu-id="82f34-153">Configure the Label s text to display in a red, extra-large, bold and italic font by assigning its `CssClass` property to the `Warning` CSS class, which is defined in the `Styles.css` file.</span></span>

<span data-ttu-id="82f34-154">Když dojde k chybě, chceme jenom popisek, který se zobrazí pouze jednou.</span><span class="sxs-lookup"><span data-stu-id="82f34-154">When an error occurs, we only want the Label to be displayed once.</span></span> <span data-ttu-id="82f34-155">To znamená by měl popisek s upozornění na následné postbacky zmizet.</span><span class="sxs-lookup"><span data-stu-id="82f34-155">That is, on subsequent postbacks, the Label s warning message should disappear.</span></span> <span data-ttu-id="82f34-156">Můžete to udělat buď vymazání si popisek s `Text` vlastnost nebo nastavení jeho `Visible` vlastnost `False` v `Page_Load` obslužné rutiny události (jako jsme to udělali v [zpracování knihoven BLL a DAL úrovni výjimky v ASP Stránku technologie .NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) kurzu) nebo zakázáním podpory popisek s zobrazení stavu.</span><span class="sxs-lookup"><span data-stu-id="82f34-156">This can be accomplished by either clearing out the Label s `Text` property or settings its `Visible` property to `False` in the `Page_Load` event handler (as we did back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial) or by disabling the Label s view state support.</span></span> <span data-ttu-id="82f34-157">Umožní s použít druhou možnost.</span><span class="sxs-lookup"><span data-stu-id="82f34-157">Let s use the latter option.</span></span>


[!code-aspx[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample4.aspx)]

<span data-ttu-id="82f34-158">Když je vyvolána výjimka, přiřadíme podrobnosti výjimka, která má `ExceptionDetails` ovládacímu prvku s popisek `Text` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="82f34-158">When an exception is raised, we'll assign the details of the exception to the `ExceptionDetails` Label control s `Text` property.</span></span> <span data-ttu-id="82f34-159">Protože svůj stav zobrazení je zakázané v následných zpětného odeslání `Text` vlastnost s programové změny budou ztraceny, návrat k výchozí text (prázdný řetězec), a tím skrytí upozornění.</span><span class="sxs-lookup"><span data-stu-id="82f34-159">Since its view state is disabled, on subsequent postbacks the `Text` property s programmatic changes will be lost, reverting back to the default text (an empty string), thereby hiding the warning message.</span></span>

<span data-ttu-id="82f34-160">Pokud chcete zjistit, kdy bylo vyvoláno chybu mohla zobrazit na stránce užitečné zprávu, potřebujeme přidat `Try ... Catch` bloku `UpdateCommand` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="82f34-160">To determine when an error has been raised in order to display a helpful message on the page, we need to add a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="82f34-161">`Try` Část obsahuje kód, který může způsobit výjimku, zatímco `Catch` blok obsahuje kód, který se spustí i v případě výjimku.</span><span class="sxs-lookup"><span data-stu-id="82f34-161">The `Try` portion contains code that may lead to an exception, while the `Catch` block contains code that is executed in the face of an exception.</span></span> <span data-ttu-id="82f34-162">Podívejte se [Základy zpracování výjimek](https://msdn.microsoft.com/library/2w8f0bss.aspx) tématu v dokumentaci k rozhraní .NET Framework pro další informace o `Try ... Catch` bloku.</span><span class="sxs-lookup"><span data-stu-id="82f34-162">Check out the [Exception Handling Fundamentals](https://msdn.microsoft.com/library/2w8f0bss.aspx) section in the .NET Framework documentation for more information on the `Try ... Catch` block.</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample5.vb)]

<span data-ttu-id="82f34-163">Při vyvolání výjimky libovolného typu kódu v rámci `Try` bloku `Catch` kód bloku s začne provádění.</span><span class="sxs-lookup"><span data-stu-id="82f34-163">When an exception of any type is thrown by code within the `Try` block, the `Catch` block s code will begin executing.</span></span> <span data-ttu-id="82f34-164">Typ výjimky, která je vyvolána `DbException`, `NoNullAllowedException`, `ArgumentException`a tak dále, co přesně, závisí na prvním místě srážejí chybu.</span><span class="sxs-lookup"><span data-stu-id="82f34-164">The type of exception that is thrown `DbException`, `NoNullAllowedException`, `ArgumentException`, and so on depends on what, exactly, precipitated the error in the first place.</span></span> <span data-ttu-id="82f34-165">Pokud se tam s problém na úrovni databáze `DbException` bude vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="82f34-165">If there s a problem at the database level, a `DbException` will be thrown.</span></span> <span data-ttu-id="82f34-166">Pokud je zadána neplatná hodnota pro `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, nebo `ReorderLevel` pole, `ArgumentException` bude vyvolána výjimka, protože jsme přidali kód pro ověření tyto hodnoty polí v `ProductsDataTable` třídy (najdete v článku [ Vytvoření vrstvy obchodní logiky](../introduction/creating-a-business-logic-layer-vb.md) kurzu).</span><span class="sxs-lookup"><span data-stu-id="82f34-166">If an illegal value is entered for the `UnitPrice`, `UnitsInStock`, `UnitsOnOrder`, or `ReorderLevel` fields, an `ArgumentException` will be thrown, as we added code to validate these field values in the `ProductsDataTable` class (see the [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) tutorial).</span></span>

<span data-ttu-id="82f34-167">Můžeme poskytnout užitečné vysvětlení pro koncového uživatele tak, že zvolíte text zprávy pro typ zachycena výjimka.</span><span class="sxs-lookup"><span data-stu-id="82f34-167">We can provide a more helpful explanation to the end user by basing the message text on the type of exception caught.</span></span> <span data-ttu-id="82f34-168">Následující kód, který byl použit ve formě skoro stejné zpátky [zpracování knihoven BLL a výjimek úrovni DAL na stránce ASP.NET](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) kurz obsahuje tato úroveň podrobností:</span><span class="sxs-lookup"><span data-stu-id="82f34-168">The following code which was used in a nearly identical form back in the [Handling BLL- and DAL-Level Exceptions in an ASP.NET Page](../editing-inserting-and-deleting-data/handling-bll-and-dal-level-exceptions-in-an-asp-net-page-vb.md) tutorial provides this level of detail:</span></span>


[!code-vb[Main](handling-bll-and-dal-level-exceptions-vb/samples/sample6.vb)]

<span data-ttu-id="82f34-169">K dokončení tohoto kurzu, jednoduše zavolejte `DisplayExceptionDetails` metodu z `Catch` bloku předávajícího zachycené `Exception` instance (`ex`).</span><span class="sxs-lookup"><span data-stu-id="82f34-169">To complete this tutorial, simply call the `DisplayExceptionDetails` method from the `Catch` block passing in the caught `Exception` instance (`ex`).</span></span>

<span data-ttu-id="82f34-170">S `Try ... Catch` blokovat na místě, uživatelům se zobrazí chybovou zprávu dál jako hodnoty 4 a 5 zobrazit.</span><span class="sxs-lookup"><span data-stu-id="82f34-170">With the `Try ... Catch` block in place, users are presented with a more informative error message, as Figures 4 and 5 show.</span></span> <span data-ttu-id="82f34-171">Všimněte si, že i v případě výjimky prvku DataList zůstane v režimu úprav.</span><span class="sxs-lookup"><span data-stu-id="82f34-171">Note that in the face of an exception the DataList remains in edit mode.</span></span> <span data-ttu-id="82f34-172">Je to proto, jakmile dojde k výjimce, toku řízení okamžitě přesměrován `Catch` bloku, bez použití kódu, který vrátí do stavu před úpravy prvku DataList.</span><span class="sxs-lookup"><span data-stu-id="82f34-172">This is because once the exception occurs, the control flow is immediately redirected to the `Catch` block, bypassing the code that returns the DataList to its pre-editing state.</span></span>


<span data-ttu-id="82f34-173">[![Pokud uživatel vynechá povinné pole, zobrazí se chybová zpráva](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="82f34-173">[![An Error Message is Displayed if a User Omits a Required Field](handling-bll-and-dal-level-exceptions-vb/_static/image9.png)](handling-bll-and-dal-level-exceptions-vb/_static/image8.png)</span></span>

<span data-ttu-id="82f34-174">**Obrázek 4**: Pokud uživatel vynechá povinné pole, zobrazí se chybová zpráva ([kliknutím ji zobrazíte obrázek v plné velikosti](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="82f34-174">**Figure 4**: An Error Message is Displayed if a User Omits a Required Field ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image10.png))</span></span>


<span data-ttu-id="82f34-175">[![Chybová zpráva se zobrazí při zadání záporné cena](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="82f34-175">[![An Error Message is Displayed When Entering a Negative Price](handling-bll-and-dal-level-exceptions-vb/_static/image12.png)](handling-bll-and-dal-level-exceptions-vb/_static/image11.png)</span></span>

<span data-ttu-id="82f34-176">**Obrázek 5**: chybová zpráva se zobrazí při zadání záporné cena ([kliknutím ji zobrazíte obrázek v plné velikosti](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="82f34-176">**Figure 5**: An Error Message is Displayed When Entering a Negative Price ([Click to view full-size image](handling-bll-and-dal-level-exceptions-vb/_static/image13.png))</span></span>


## <a name="summary"></a><span data-ttu-id="82f34-177">Souhrn</span><span class="sxs-lookup"><span data-stu-id="82f34-177">Summary</span></span>

<span data-ttu-id="82f34-178">GridView a ObjectDataSource poskytují po úrovně obslužné rutiny, které obsahují informace o žádné výjimky, které byly vyvolány během pracovního postupu aktualizace a odstranění, jakož i vlastnosti, které lze nastavit k označení, zda byla výjimka zpracovat.</span><span class="sxs-lookup"><span data-stu-id="82f34-178">The GridView and ObjectDataSource provide post-level event handlers that include information about any exceptions that were raised during the updating and deleting workflow, as well as properties that can be set to indicate whether or not the exception has been handled.</span></span> <span data-ttu-id="82f34-179">Tyto funkce, ale nejsou k dispozici při práci s prvku DataList a použití BLL přímo.</span><span class="sxs-lookup"><span data-stu-id="82f34-179">These features, however, are unavailable when working with the DataList and using the BLL directly.</span></span> <span data-ttu-id="82f34-180">Místo toho jsme zodpovídají za implementaci zpracování výjimek.</span><span class="sxs-lookup"><span data-stu-id="82f34-180">Instead, we are responsible for implementing exception handling.</span></span>

<span data-ttu-id="82f34-181">V tomto kurzu jsme viděli, jak přidat zpracování výjimek pro upravitelné DataList s aktualizace pracovního postupu tak, že přidáte `Try ... Catch` bloku `UpdateCommand` obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="82f34-181">In this tutorial we saw how to add exception handling to an editable DataList s updating workflow by adding a `Try ... Catch` block to the `UpdateCommand` event handler.</span></span> <span data-ttu-id="82f34-182">Pokud se během aktualizace pracovního postupu, je vyvolána výjimka `Catch` spustí kód bloku s, užitečné informace v zobrazení `ExceptionDetails` popisek.</span><span class="sxs-lookup"><span data-stu-id="82f34-182">If an exception is raised during the updating workflow, the `Catch` block s code executes, displaying helpful information in the `ExceptionDetails` Label.</span></span>

<span data-ttu-id="82f34-183">V tomto okamžiku prvku DataList nevyvine žádnou akci zabránit výjimky, pokud chcete zabránit vzniku na prvním místě.</span><span class="sxs-lookup"><span data-stu-id="82f34-183">At this point, the DataList makes no effort to prevent exceptions from happening in the first place.</span></span> <span data-ttu-id="82f34-184">I když víme, že negativní cena způsobí výjimku, jsme některé t ještě přidány žádné funkce k proaktivnímu zabránit uživateli v zadávání těchto neplatný vstup.</span><span class="sxs-lookup"><span data-stu-id="82f34-184">Even though we know that a negative price will result in an exception, we haven t yet added any functionality to proactively prevent a user from entering such invalid input.</span></span> <span data-ttu-id="82f34-185">V následujícím kurzem uvidíme, jak snížit výjimky způsobené Neplatný uživatelský vstup ve přidání validačních ovládacích prvků v `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="82f34-185">In our next tutorial we'll see how to help reduce the exceptions caused by invalid user input by adding validation controls in the `EditItemTemplate`.</span></span>

<span data-ttu-id="82f34-186">Všechno nejlepší programování!</span><span class="sxs-lookup"><span data-stu-id="82f34-186">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="82f34-187">Další čtení</span><span class="sxs-lookup"><span data-stu-id="82f34-187">Further Reading</span></span>

<span data-ttu-id="82f34-188">Další informace o tématech, které jsou popsané v tomto kurzu najdete na následujících odkazech:</span><span class="sxs-lookup"><span data-stu-id="82f34-188">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="82f34-189">Pokyny k návrhu pro výjimky</span><span class="sxs-lookup"><span data-stu-id="82f34-189">Design Guidelines for Exceptions</span></span>](https://msdn.microsoft.com/library/ms298399.aspx)
- <span data-ttu-id="82f34-190">[Chyba protokolovací moduly a obslužné rutiny (ELMAH)](http://workspaces.gotdotnet.com/elmah) (knihovny open source pro protokolování chyb)</span><span class="sxs-lookup"><span data-stu-id="82f34-190">[Error Logging Modules and Handlers (ELMAH)](http://workspaces.gotdotnet.com/elmah) (an open-source library for logging errors)</span></span>
- <span data-ttu-id="82f34-191">[Enterprise Library pro .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (včetně bloku výjimky správy aplikace)</span><span class="sxs-lookup"><span data-stu-id="82f34-191">[Enterprise Library for .NET Framework 2.0](https://www.microsoft.com/downloads/details.aspx?familyid=5A14E870-406B-4F2A-B723-97BA84AE80B5&amp;displaylang=en) (includes the Exception Management Application Block)</span></span>

## <a name="about-the-author"></a><span data-ttu-id="82f34-192">O autorovi</span><span class="sxs-lookup"><span data-stu-id="82f34-192">About the Author</span></span>

<span data-ttu-id="82f34-193">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a Zakladatel [4GuysFromRolla.com](http://www.4guysfromrolla.com), má práce s Microsoft webových technologiích od roku 1998.</span><span class="sxs-lookup"><span data-stu-id="82f34-193">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="82f34-194">Scott funguje jako nezávislý konzultant, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="82f34-194">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="82f34-195">Jeho nejnovější knihy [ *Edice nakladatelství Sams naučit sami ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="82f34-195">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="82f34-196">Může být dosáhl v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="82f34-196">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="82f34-197">nebo prostřednictvím jeho blogu, který lze nalézt v [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="82f34-197">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="82f34-198">Speciální k</span><span class="sxs-lookup"><span data-stu-id="82f34-198">Special Thanks To</span></span>

<span data-ttu-id="82f34-199">V této sérii kurzů byl recenzován uživatelem mnoho užitečných revidující.</span><span class="sxs-lookup"><span data-stu-id="82f34-199">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="82f34-200">Vedoucí kontrolor pro účely tohoto kurzu byla Ken Pespisa.</span><span class="sxs-lookup"><span data-stu-id="82f34-200">Lead reviewer for this tutorial was Ken Pespisa.</span></span> <span data-ttu-id="82f34-201">Zajímat téma Moje nadcházejících článcích MSDN?</span><span class="sxs-lookup"><span data-stu-id="82f34-201">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="82f34-202">Pokud ano, vyřaďte mě řádek na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="82f34-202">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="82f34-203">[Předchozí](performing-batch-updates-vb.md)
> [další](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="82f34-203">[Previous](performing-batch-updates-vb.md)
[Next](adding-validation-controls-to-the-datalist-s-editing-interface-vb.md)</span></span>
