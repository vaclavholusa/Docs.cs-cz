---
uid: web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
title: Vytvoření vrstvy přístupu k datům (C#) | Dokumentace Microsoftu
author: rick-anderson
description: V tomto kurzu začneme od úplného začátku a vytvořit na datový přístup vrstvou DAL, pomocí zadané datové sady, přístup k informacím v databázi.
ms.author: riande
ms.date: 04/05/2010
ms.assetid: cfe2a6a0-1e56-4dc8-9537-c8ec76ba96a4
msc.legacyurl: /web-forms/overview/data-access/introduction/creating-a-data-access-layer-cs
msc.type: authoredcontent
ms.openlocfilehash: fca6119b2e78c246724d6dd7277d5c4dc521f49c
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/16/2018
ms.locfileid: "41756404"
---
<a name="creating-a-data-access-layer-c"></a><span data-ttu-id="e0c9c-103">Vytvoření vrstvy přístupu k datům (C#)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-103">Creating a Data Access Layer (C#)</span></span>
====================
<span data-ttu-id="e0c9c-104">podle [Scott Meisnerová](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e0c9c-105">[Stáhněte si ukázkovou aplikaci](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_1_CS.exe) nebo [stahovat PDF](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-105">[Download Sample App](http://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_1_CS.exe) or [Download PDF](creating-a-data-access-layer-cs/_static/datatutorial01cs1.pdf)</span></span>

> <span data-ttu-id="e0c9c-106">V tomto kurzu začneme od úplného začátku a vytvořit na datový přístup vrstvou DAL, pomocí zadané datové sady, přístup k informacím v databázi.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-106">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), using typed DataSets, to access the information in a database.</span></span>


## <a name="introduction"></a><span data-ttu-id="e0c9c-107">Úvod</span><span class="sxs-lookup"><span data-stu-id="e0c9c-107">Introduction</span></span>

<span data-ttu-id="e0c9c-108">Jako webové vývojáře naše životy – ať točí kolem práce s daty.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-108">As web developers, our lives revolve around working with data.</span></span> <span data-ttu-id="e0c9c-109">Vytvoříme databáze k ukládání dat, kód pro načítání a úpravy a webových aplikací, aby shromažďujících a shrnujících ho.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-109">We create databases to store the data, code to retrieve and modify it, and web pages to collect and summarize it.</span></span> <span data-ttu-id="e0c9c-110">Toto je první kurz zdlouhavé série, se bude věnovat technik implementace těchto běžných vzorů v technologii ASP.NET 2.0.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-110">This is the first tutorial in a lengthy series that will explore techniques for implementing these common patterns in ASP.NET 2.0.</span></span> <span data-ttu-id="e0c9c-111">Začneme s vytvářením [softwarovou architekturu](http://en.wikipedia.org/wiki/Software_architecture) skládající se z na datový přístup vrstvou DAL pomocí datové vrstvy obchodní logiky (BLL) zadané sady, která vynucuje vlastní podniková pravidla a prezentační vrstva skládá z technologie ASP.NET, které stránky Sdílejte společný rozložení stránky.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-111">We'll start with creating a [software architecture](http://en.wikipedia.org/wiki/Software_architecture) composed of a Data Access Layer (DAL) using Typed DataSets, a Business Logic Layer (BLL) that enforces custom business rules, and a presentation layer composed of ASP.NET pages that share a common page layout.</span></span> <span data-ttu-id="e0c9c-112">Jakmile tento back-endu základy byla přijata, přejdeme do vytváření sestav, ukazuje, jak zobrazit, shrnout, shromažďovat a ověřit data z webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-112">Once this backend groundwork has been laid, we'll move into reporting, showing how to display, summarize, collect, and validate data from a web application.</span></span> <span data-ttu-id="e0c9c-113">Tyto kurzy jsou zaměřené na být stručné a poskytují podrobné pokyny s dostatečným snímky obrazovky, který vás provede procesem vizuálně.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-113">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="e0c9c-114">Každý kurz je dostupná v C# a Visual Basic verze a nabízí ke stažení kompletní kód používá.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-114">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span> <span data-ttu-id="e0c9c-115">(Tento první kurz je poměrně dlouhé, ale ostatní jsou uvedeny v mnohem více stravitelné bloků.)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-115">(This first tutorial is quite lengthy, but the rest are presented in much more digestible chunks.)</span></span>

<span data-ttu-id="e0c9c-116">Pro tyto kurzy budeme používat Microsoft SQL Server 2005 Express Edition verzi databáze Northwind, umístí do **aplikace\_Data** adresáře.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-116">For these tutorials we'll be using a Microsoft SQL Server 2005 Express Edition version of the Northwind database placed in the **App\_Data** directory.</span></span> <span data-ttu-id="e0c9c-117">Kromě souborů databáze **aplikace\_Data** složka také obsahuje skripty SQL pro vytvoření databáze, v případě, že chcete použít jiné databázi verze.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-117">In addition to the database file, the **App\_Data** folder also contains the SQL scripts for creating the database, in case you want to use a different database version.</span></span> <span data-ttu-id="e0c9c-118">Tyto skripty mohou také být [stáhnout přímo od Microsoftu](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), pokud si přejete.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-118">These scripts can be also be [downloaded directly from Microsoft](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en), if you'd prefer.</span></span> <span data-ttu-id="e0c9c-119">Pokud používáte jinou verzi systému SQL Server databáze Northwind, budete muset aktualizovat **NORTHWNDConnectionString** nastavení v aplikačním **Web.config** souboru.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-119">If you use a different SQL Server version of the Northwind database, you will need to update the **NORTHWNDConnectionString** setting in the application's **Web.config** file.</span></span> <span data-ttu-id="e0c9c-120">Webová aplikace byla vytvořena pomocí Visual Studio 2005 Professional Edition jako projekt webu založeného na systému souborů.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-120">The web application was built using Visual Studio 2005 Professional Edition as a file system-based Web site project.</span></span> <span data-ttu-id="e0c9c-121">Všechny kurzy, ale bude fungovat stejně dobře s bezplatnou verzi Visual Studio 2005 [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span><span class="sxs-lookup"><span data-stu-id="e0c9c-121">However, all of the tutorials will work equally well with the free version of Visual Studio 2005, [Visual Web Developer](https://msdn.microsoft.com/vstudio/express/vwd/).</span></span>  
  
<span data-ttu-id="e0c9c-122">V tomto kurzu začneme od úplného začátku a vytvořit na datový přístup vrstvou DAL, za nímž následuje vytváření obchodní logiky vrstvy (BLL) v druhé části kurzu a práci na rozložení stránky a navigace ve třetí.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-122">In this tutorial we'll start from the very beginning and create the Data Access Layer (DAL), followed by creating the Business Logic Layer (BLL) in the second tutorial, and working on page layout and navigation in the third.</span></span> <span data-ttu-id="e0c9c-123">V kurzech po třetí příkaz budou vycházejí z základ podle první tři.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-123">The tutorials after the third one will build upon the foundation laid in the first three.</span></span> <span data-ttu-id="e0c9c-124">Máme hodně na klientech v tomto prvním kurzu, takže pusťte sady Visual Studio a můžeme začít!</span><span class="sxs-lookup"><span data-stu-id="e0c9c-124">We've got a lot to cover in this first tutorial, so fire up Visual Studio and let's get started!</span></span>

## <a name="step-1-creating-a-web-project-and-connecting-to-the-database"></a><span data-ttu-id="e0c9c-125">Krok 1: Vytvoření webového projektu a připojení k databázi</span><span class="sxs-lookup"><span data-stu-id="e0c9c-125">Step 1: Creating a Web Project and Connecting to the Database</span></span>

<span data-ttu-id="e0c9c-126">Než vytvoříme našich dat přístup vrstvy DAL (), nejprve musíme vytvořit webovou stránku a nastavit naší databázi.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-126">Before we can create our Data Access Layer (DAL), we first need to create a web site and setup our database.</span></span> <span data-ttu-id="e0c9c-127">Začněte tím, že vytvoříte nový soubor na základě systému ASP.NET Web.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-127">Start by creating a new file system-based ASP.NET web site.</span></span> <span data-ttu-id="e0c9c-128">K tomu, přejděte do nabídky soubor a zvolte nový web zobrazení dialogového okna Nový web.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-128">To accomplish this, go to the File menu and choose New Web Site, displaying the New Web Site dialog box.</span></span> <span data-ttu-id="e0c9c-129">Výběr šablony webové stránky ASP.NET, nastavte rozevírací seznam umístění do systému souborů, vyberte složku, umístěte na webu a nastavit jazyk C#.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-129">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to C#.</span></span>


<span data-ttu-id="e0c9c-130">[![Vytvoření nového souboru na základě systému webového serveru](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-130">[![Create a New File System-Based Web Site](creating-a-data-access-layer-cs/_static/image2.png)](creating-a-data-access-layer-cs/_static/image1.png)</span></span>

<span data-ttu-id="e0c9c-131">**Obrázek 1**: vytvoření webu New File System-Based ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-131">**Figure 1**: Create a New File System-Based Web Site ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image3.png))</span></span>


<span data-ttu-id="e0c9c-132">Tím se vytvoří nový web s **Default.aspx** stránky technologie ASP.NET a **aplikace\_Data** složky.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-132">This will create a new web site with a **Default.aspx** ASP.NET page and an **App\_Data** folder.</span></span>

<span data-ttu-id="e0c9c-133">Se vytvořili na webu dalším krokem je přidání odkazu do databáze v Průzkumníku serveru Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-133">With the web site created, the next step is to add a reference to the database in Visual Studio's Server Explorer.</span></span> <span data-ttu-id="e0c9c-134">Přidejte databázi do Průzkumníka serveru můžete přidat tabulky, uložené procedury, zobrazení a tak dále všechny z Visual Studia.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-134">By adding a database to the Server Explorer you can add tables, stored procedures, views, and so on all from within Visual Studio.</span></span> <span data-ttu-id="e0c9c-135">Můžete také zobrazit data tabulky nebo vytvořit ručně nebo graficky své vlastní dotazy pomocí Tvůrce dotazů.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-135">You can also view table data or create your own queries either by hand or graphically via the Query Builder.</span></span> <span data-ttu-id="e0c9c-136">Navíc když vytváříme typované datové sady pro vrstvy DAL potřebujeme bodu Visual Studio k databázi, ze kterého třeba vytvořit datové sady typu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-136">Furthermore, when we build the Typed DataSets for the DAL we'll need to point Visual Studio to the database from which the Typed DataSets should be constructed.</span></span> <span data-ttu-id="e0c9c-137">Zatímco můžeme poskytnout tyto informace o připojení v tomto okamžiku v čase, Visual Studio automaticky naplní rozevírací seznam databází už zaregistrovaný v Průzkumníku serveru.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-137">While we can provide this connection information at that point in time, Visual Studio automatically populates a drop-down list of the databases already registered in the Server Explorer.</span></span>

<span data-ttu-id="e0c9c-138">Kroky pro přidání databáze Northwind do Průzkumníka serveru závisí na tom, jestli chcete použít databázi SQL Server 2005 Express Edition v **aplikace\_Data** složky nebo pokud máte Microsoft SQL Server 2000 nebo 2005 nastavení serveru databáze, kterou chcete použít místo toho.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-138">The steps for adding the Northwind database to the Server Explorer depend on whether you want to use the SQL Server 2005 Express Edition database in the **App\_Data** folder or if you have a Microsoft SQL Server 2000 or 2005 database server setup that you want to use instead.</span></span>

## <a name="using-a-database-in-theappdatafolder"></a><span data-ttu-id="e0c9c-139">Použití databáze v theApp\_%{datafolder/</span><span class="sxs-lookup"><span data-stu-id="e0c9c-139">Using a Database in theApp\_DataFolder</span></span>

<span data-ttu-id="e0c9c-140">Pokud máte SQL Server 2000 nebo 2005 databázový server pro připojení k nebo chcete jednoduše vyhnout se tak nutnosti přidat databázi k databázovému serveru, můžete použít SQL Server 2005 Express Edition verzi databáze Northwind, který se nachází v stažený websit e's **aplikace\_Data** složky (**NORTHWND. MDF**).</span><span class="sxs-lookup"><span data-stu-id="e0c9c-140">If you do not have a SQL Server 2000 or 2005 database server to connect to, or you simply want to avoid having to add the database to a database server, you can use the SQL Server 2005 Express Edition version of the Northwind database that is located in the downloaded website's **App\_Data** folder (**NORTHWND.MDF**).</span></span>

<span data-ttu-id="e0c9c-141">Databáze umístěn v **aplikace\_Data** složku se automaticky přidá do Průzkumníka serveru.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-141">A database placed in the **App\_Data** folder is automatically added to the Server Explorer.</span></span> <span data-ttu-id="e0c9c-142">Za předpokladu, že máte SQL Server 2005 Express Edition na vašem počítači nainstalovaný byste měli vidět uzel s názvem NORTHWND. MDF v Průzkumníku serveru, který lze rozbalit a prozkoumat její tabulek, zobrazení, uložené procedury a tak dále (viz obrázek 2).</span><span class="sxs-lookup"><span data-stu-id="e0c9c-142">Assuming you have SQL Server 2005 Express Edition installed on your machine you should see a node named NORTHWND.MDF in the Server Explorer, which you can expand and explore its tables, views, stored procedure, and so on (see Figure 2).</span></span>

<span data-ttu-id="e0c9c-143">**Aplikace\_Data** složky může také obsahovat aplikace Microsoft Access **.mdb** soubory, které jako jejich protějšky v systému SQL Server, se automaticky přidají do Průzkumníka serveru.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-143">The **App\_Data** folder can also hold Microsoft Access **.mdb** files, which, like their SQL Server counterparts, are automatically added to the Server Explorer.</span></span> <span data-ttu-id="e0c9c-144">Pokud nechcete použít některou z možností SQL serveru, můžete vždy [stažení aplikace Microsoft Access verzi souboru databáze Northwind](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) myší do **aplikace\_Data** adresáře.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-144">If you don't want to use any of the SQL Server options, you can always [download a Microsoft Access version of the Northwind database file](https://www.microsoft.com/downloads/details.aspx?FamilyID=C6661372-8DBE-422B-8676-C632D66C529C&amp;displaylang=EN) and drop into the **App\_Data** directory.</span></span> <span data-ttu-id="e0c9c-145">Mějte na paměti, ale který Accessové databáze nejsou jako plně funkční jako SQL Server a nejsou určeny pro použití ve scénářích webu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-145">Keep in mind, however, that Access databases aren't as feature-rich as SQL Server, and aren't designed to be used in web site scenarios.</span></span> <span data-ttu-id="e0c9c-146">Kromě toho několik více než 35 kurzy budou využívat určité funkce úrovni databáze, které nejsou podporovány přístup.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-146">Furthermore, a couple of the 35+ tutorials will utilize certain database-level features that aren't supported by Access.</span></span>

## <a name="connecting-to-the-database-in-a-microsoft-sql-server-2000-or-2005-database-server"></a><span data-ttu-id="e0c9c-147">Připojení k databázi v databázi serveru Microsoft SQL Server 2000 nebo 2005</span><span class="sxs-lookup"><span data-stu-id="e0c9c-147">Connecting to the Database in a Microsoft SQL Server 2000 or 2005 Database Server</span></span>

<span data-ttu-id="e0c9c-148">Alternativně může připojit k databázi Northwind na databázovém serveru nainstalovaná.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-148">Alternatively, you may connect to a Northwind database installed on a database server.</span></span> <span data-ttu-id="e0c9c-149">Pokud databázový server ještě není nainstalována databáze Northwind, nejprve musíte přidat ho k databázovému serveru spuštěním skriptu instalace zahrnuté v tomto kurzu stažení nebo podle [stahování verze systému SQL Server 2000 Northwind a instalační skript](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) přímo z webu společnosti Microsoft.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-149">If the database server does not already have the Northwind database installed, you first must add it to database server by running the installation script included in this tutorial's download or by [downloading the SQL Server 2000 version of Northwind and installation script](https://www.microsoft.com/downloads/details.aspx?FamilyID=06616212-0356-46a0-8da2-eebc53a68034&amp;DisplayLang=en) directly from Microsoft's web site.</span></span>

<span data-ttu-id="e0c9c-150">Jakmile budete mít databázi nainstalovat, přejděte do Průzkumníka serveru v sadě Visual Studio, klikněte pravým tlačítkem na uzel datové připojení a zvolte Přidat připojení.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-150">Once you have the database installed, go to the Server Explorer in Visual Studio, right-click on the Data Connections node, and choose Add Connection.</span></span> <span data-ttu-id="e0c9c-151">Pokud nevidíte přejděte do zobrazení Průzkumníka serveru / Průzkumník serveru nebo přístupů Ctrl + Alt + S.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-151">If you don't see the Server Explorer go to the View / Server Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="e0c9c-152">Tím se otevře dialogové okno Přidat připojení, kde můžete určit server pro připojení k, informace o ověřování a název databáze.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-152">This will bring up the Add Connection dialog box, where you can specify the server to connect to, the authentication information, and the database name.</span></span> <span data-ttu-id="e0c9c-153">Jakmile úspěšně jste nakonfigurovali informace o připojení databáze a kliknutí na tlačítko OK, přidá se jako uzel pod uzlem datová připojení databáze.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-153">Once you have successfully configured the database connection information and clicked the OK button, the database will be added as a node underneath the Data Connections node.</span></span> <span data-ttu-id="e0c9c-154">Rozbalte databázi a prozkoumejte tabulek, zobrazení, uložené procedury a tak dále.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-154">You can expand the database node to explore its tables, views, stored procedures, and so on.</span></span>


![Přidat připojení k databázi Northwind databázový Server](creating-a-data-access-layer-cs/_static/image4.png)

<span data-ttu-id="e0c9c-156">**Obrázek 2**: Přidání připojení k databázi Northwind databázový Server</span><span class="sxs-lookup"><span data-stu-id="e0c9c-156">**Figure 2**: Add a Connection to Your Database Server's Northwind Database</span></span>


## <a name="step-2-creating-the-data-access-layer"></a><span data-ttu-id="e0c9c-157">Krok 2: Vytvoření vrstvy přístupu k datům</span><span class="sxs-lookup"><span data-stu-id="e0c9c-157">Step 2: Creating the Data Access Layer</span></span>

<span data-ttu-id="e0c9c-158">Při práci s data jednou z možností je vložení logiky týkající se dat přímo do prezentační vrstvy (ve webové aplikaci, tvoří prezentační vrstvy pro stránky ASP.NET).</span><span class="sxs-lookup"><span data-stu-id="e0c9c-158">When working with data one option is to embed the data-specific logic directly into the presentation layer (in a web application, the ASP.NET pages make up the presentation layer).</span></span> <span data-ttu-id="e0c9c-159">To může být ve tvaru psaní kódu technologie ADO.NET v části kódu stránky technologie ASP.NET nebo pomocí ovládacího prvku SqlDataSource z část kódu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-159">This may take the form of writing ADO.NET code in the ASP.NET page's code portion or using the SqlDataSource control from the markup portion.</span></span> <span data-ttu-id="e0c9c-160">V obou případech se tento přístup pevně spojuje logikou přístupu dat s prezentační vrstvy.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-160">In either case, this approach tightly couples the data access logic with the presentation layer.</span></span> <span data-ttu-id="e0c9c-161">Doporučený postup je však k oddělení logiky přístupu k datům od prezentační vrstvy.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-161">The recommended approach, however, is to separate the data access logic from the presentation layer.</span></span> <span data-ttu-id="e0c9c-162">Tato vrstva samostatné se označuje jako vrstva přístupu k datům, DAL zkráceně a obvykle je implementována jako samostatný projekt knihovny tříd.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-162">This separate layer is referred to as the Data Access Layer, DAL for short, and is typically implemented as a separate Class Library project.</span></span> <span data-ttu-id="e0c9c-163">Výhody této vrstvy architektury jsou dobře zdokumentovaná (viz oddíl "Další čtení" na konci tohoto kurzu o tyto výhody) a my podnikneme v této sérii přístup.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-163">The benefits of this layered architecture are well documented (see the "Further Readings" section at the end of this tutorial for information on these advantages) and is the approach we will take in this series.</span></span>

<span data-ttu-id="e0c9c-164">Veškerý kód, který je specifický pro podkladovému zdroji dat, jako je například vytváření připojení k databázi, vydávání **vyberte**, **vložit**, **aktualizace**, a  **Odstranit** příkazy a tak dále musíte umístit do vrstvy DAL.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-164">All code that is specific to the underlying data source such as creating a connection to the database, issuing **SELECT**, **INSERT**, **UPDATE**, and **DELETE** commands, and so on should be located in the DAL.</span></span> <span data-ttu-id="e0c9c-165">Prezentační vrstva by neměl obsahovat žádné odkazy na takový kód přístupu k datům, ale místo toho by měl provádět volání do vrstvy DAL pro všechny požadavky.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-165">The presentation layer should not contain any references to such data access code, but should instead make calls into the DAL for any and all data requests.</span></span> <span data-ttu-id="e0c9c-166">Vrstvy přístupu k datům obvykle obsahují metody pro přístup k datům podkladové databáze.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-166">Data Access Layers typically contain methods for accessing the underlying database data.</span></span> <span data-ttu-id="e0c9c-167">Databáze Northwind, například obsahuje **produkty** a **kategorie** tabulek, které zaznamenávají produktů pro prodej a kategorie, do kterých patří.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-167">The Northwind database, for example, has **Products** and **Categories** tables that record the products for sale and the categories to which they belong.</span></span> <span data-ttu-id="e0c9c-168">V našem DAL máme metody, například:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-168">In our DAL we will have methods like:</span></span>

- <span data-ttu-id="e0c9c-169">**GetCategories(),** která vrátí informace o všech kategorií</span><span class="sxs-lookup"><span data-stu-id="e0c9c-169">**GetCategories(),** which will return information about all of the categories</span></span>
- <span data-ttu-id="e0c9c-170">**GetProducts()**, která vrátí informace o všech produktů</span><span class="sxs-lookup"><span data-stu-id="e0c9c-170">**GetProducts()**, which will return information about all of the products</span></span>
- <span data-ttu-id="e0c9c-171">**GetProductsByCategoryID (*categoryID*)**, která vrátí všechny produkty, které patří do zadané kategorie</span><span class="sxs-lookup"><span data-stu-id="e0c9c-171">**GetProductsByCategoryID(*categoryID*)**, which will return all products that belong to a specified category</span></span>
- <span data-ttu-id="e0c9c-172">**GetProductByProductID (*productID*)**, která vrátí informace o daném produktu</span><span class="sxs-lookup"><span data-stu-id="e0c9c-172">**GetProductByProductID(*productID*)**, which will return information about a particular product</span></span>

<span data-ttu-id="e0c9c-173">Tyto metody při vyvolání, bude připojení k databázi, proveďte odpovídající dotaz a vrátí výsledky.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-173">These methods, when invoked, will connect to the database, issue the appropriate query, and return the results.</span></span> <span data-ttu-id="e0c9c-174">Jakým způsobem jsme vrátit výsledky, je důležité.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-174">How we return these results is important.</span></span> <span data-ttu-id="e0c9c-175">Tyto metody může jednoduše vrací datovou sadu nebo DataReader vyplněn databázového dotazu, ale v ideálním případě tyto výsledky by měly být vráceny za použití *objektů se silným typem*.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-175">These methods could simply return a DataSet or DataReader populated by the database query, but ideally these results should be returned using *strongly-typed objects*.</span></span> <span data-ttu-id="e0c9c-176">Objekt se silnou typovou je jedním jehož schéma je pevně definovaná v době kompilace, zatímco opak volného typu objektu, je jedna jehož schéma není znám, dokud modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-176">A strongly-typed object is one whose schema is rigidly defined at compile time, whereas the opposite, a loosely-typed object, is one whose schema is not known until runtime.</span></span>

<span data-ttu-id="e0c9c-177">Objektu DataReader a datovou sadu (ve výchozím nastavení) jsou objekty volného typu, protože jejich schématu je definovaný podle sloupců vrácených dotazem databáze použitých k naplnění je.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-177">For example, the DataReader and the DataSet (by default) are loosely-typed objects since their schema is defined by the columns returned by the database query used to populate them.</span></span> <span data-ttu-id="e0c9c-178">Pro přístup ke konkrétním sloupci z DataTable volného typu musíme použijte syntax jako:  <strong><em>DataTable</em>. Řádky [<em>index</em>] ["<em>Názevsloupce</em>"]</strong>.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-178">To access a particular column from a loosely-typed DataTable we need to use syntax like: <strong><em>DataTable</em>.Rows[<em>index</em>]["<em>columnName</em>"]</strong>.</span></span> <span data-ttu-id="e0c9c-179">Vykazují dojde ke ztrátě zadáním objektu DataTable v tomto příkladu je skutečnost, že budeme potřebovat pro přístup k názvu sloupce použít řetězec nebo index pořadových.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-179">The DataTable's loose typing in this example is exhibited by the fact that we need to access the column name using a string or ordinal index.</span></span> <span data-ttu-id="e0c9c-180">Objekt DataTable silného typu na druhé straně, budou mít všechny její sloupce implementovány jako vlastnosti, výsledkem je kód, který bude vypadat takto:  <strong><em>DataTable</em>. Řádky [<em>index</em>]. *Názevsloupce</strong>*.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-180">A strongly-typed DataTable, on the other hand, will have each of its columns implemented as properties, resulting in code that looks like: <strong><em>DataTable</em>.Rows[<em>index</em>].*columnName</strong>*.</span></span>

<span data-ttu-id="e0c9c-181">K vrácení objektů se silným typem, vývojáře můžou vytvořit své vlastní objekty vlastních obchodních nebo používají typované datové sady.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-181">To return strongly-typed objects, developers can either create their own custom business objects or use Typed DataSets.</span></span> <span data-ttu-id="e0c9c-182">Obchodní objekt je implementoval vývojář, protože představuje třídu, jejíž vlastnosti obvykle zahrnují sloupce základní tabulky databáze, obchodní objekt.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-182">A business object is implemented by the developer as a class whose properties typically reflect the columns of the underlying database table the business object represents.</span></span> <span data-ttu-id="e0c9c-183">Typované datové sady je třída, vygeneruje se pro vás sada Visual Studio na základě schématu databáze a jejíž členové jsou silného typu podle tohoto schématu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-183">A Typed DataSet is a class generated for you by Visual Studio based on a database schema and whose members are strongly-typed according to this schema.</span></span> <span data-ttu-id="e0c9c-184">Zadané samotná datová sada se skládá z třídy, které rozšiřují třídy DataSet technologie ADO.NET, DataTable a objekt DataRow.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-184">The Typed DataSet itself consists of classes that extend the ADO.NET DataSet, DataTable, and DataRow classes.</span></span> <span data-ttu-id="e0c9c-185">Kromě DataTables silného typu zadané datové sady teď také obsahují objekty TableAdapter, které jsou třídy pomocí metody pro naplnění datové sady DataTables změny a šíření změn v rámci DataTables zpět do databáze.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-185">In addition to strongly-typed DataTables, Typed DataSets now also include TableAdapters, which are classes with methods for populating the DataSet's DataTables and propagating modifications within the DataTables back to the database.</span></span>

> [!NOTE]
> <span data-ttu-id="e0c9c-186">Další informace na výhody a nevýhody používání typované datové sady a vlastní obchodní objekty [navrhování komponenty datové vrstvy a předávání dat prostřednictvím vrstev](https://msdn.microsoft.com/library/ms978496.aspx).</span><span class="sxs-lookup"><span data-stu-id="e0c9c-186">For more information on the advantages and disadvantages of using Typed DataSets versus custom business objects, refer to [Designing Data Tier Components and Passing Data Through Tiers](https://msdn.microsoft.com/library/ms978496.aspx).</span></span>


<span data-ttu-id="e0c9c-187">Pro architekturu těchto kurzů použijeme silně typovaných datových sad.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-187">We'll use strongly-typed DataSets for these tutorials' architecture.</span></span> <span data-ttu-id="e0c9c-188">Obrázek 3 znázorňuje pracovní postupy mezi různé vrstvy aplikace, která používá zadané datové sady.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-188">Figure 3 illustrates the workflow between the different layers of an application that uses Typed DataSets.</span></span>


<span data-ttu-id="e0c9c-189">[![Všechny kód přístupu k datům je předané centrům vrstvy Dal](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-189">[![All Data Access Code is Relegated to the DAL](creating-a-data-access-layer-cs/_static/image6.png)](creating-a-data-access-layer-cs/_static/image5.png)</span></span>

<span data-ttu-id="e0c9c-190">**Obrázek 3**: všechny kód přístupu k datům je předané centrům vrstvy Dal ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-190">**Figure 3**: All Data Access Code is Relegated to the DAL ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image7.png))</span></span>


## <a name="creating-a-typed-dataset-and-table-adapter"></a><span data-ttu-id="e0c9c-191">Vytvoření typové datové sady a tabulka adaptéru</span><span class="sxs-lookup"><span data-stu-id="e0c9c-191">Creating a Typed DataSet and Table Adapter</span></span>

<span data-ttu-id="e0c9c-192">Zahajte proces vytváření naše DAL, začneme přidáním typované datové sady do projektu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-192">To begin creating our DAL, we start by adding a Typed DataSet to our project.</span></span> <span data-ttu-id="e0c9c-193">Chcete-li to provést, klikněte pravým tlačítkem na uzel projektu v Průzkumníku řešení a zvolte Přidat novou položku.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-193">To accomplish this, right-click on the project node in the Solution Explorer and choose Add a New Item.</span></span> <span data-ttu-id="e0c9c-194">Vybrat datovou sadu ze seznamu šablon a pojmenujte ho **Northwind.xsd**.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-194">Select the DataSet option from the list of templates and name it **Northwind.xsd**.</span></span>


<span data-ttu-id="e0c9c-195">[![Přidat novou datovou sadu do projektu](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-195">[![Choose to Add a New DataSet to Your Project](creating-a-data-access-layer-cs/_static/image9.png)](creating-a-data-access-layer-cs/_static/image8.png)</span></span>

<span data-ttu-id="e0c9c-196">**Obrázek 4**: chcete přidat novou datovou sadu do vašeho projektu ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-196">**Figure 4**: Choose to Add a New DataSet to Your Project ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image10.png))</span></span>


<span data-ttu-id="e0c9c-197">Po kliknutí na tlačítko Přidat, po zobrazení výzvy k přidat datovou sadu, která **aplikace\_kód** složky, zvolte Ano.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-197">After clicking Add, when prompted to add the DataSet to the **App\_Code** folder, choose Yes.</span></span> <span data-ttu-id="e0c9c-198">Návrhář pro zadané datové sady se potom zobrazí a se spustí Průvodce nastavením TableAdapter, vám umožňuje přidat k datové sadě zadán první TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-198">The Designer for the Typed DataSet will then be displayed, and the TableAdapter Configuration Wizard will start, allowing you to add your first TableAdapter to the Typed DataSet.</span></span>

<span data-ttu-id="e0c9c-199">Datové sady typu slouží jako kolekce silného typu dat; skládá se z silného typu instance objektu DataTable zase z nichž každý se skládá z instance objektu DataRow silného typu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-199">A Typed DataSet serves as a strongly-typed collection of data; it is composed of strongly-typed DataTable instances, each of which is in turn composed of strongly-typed DataRow instances.</span></span> <span data-ttu-id="e0c9c-200">Vytvoříme objekt DataTable silného typu pro každou z podkladové databázové tabulky, které potřebujeme pro práci v této sérii kurzů.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-200">We will create a strongly-typed DataTable for each of the underlying database tables that we need to work with in this tutorials series.</span></span> <span data-ttu-id="e0c9c-201">Začněme vytvořením datové tabulky pro **produkty** tabulky.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-201">Let's start with creating a DataTable for the **Products** table.</span></span>

<span data-ttu-id="e0c9c-202">Uvědomte si, že silného typu DataTables neobsahují žádné informace o tom, jak přistupovat k datům z jejich podkladové databázové tabulky.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-202">Keep in mind that strongly-typed DataTables do not include any information on how to access data from their underlying database table.</span></span> <span data-ttu-id="e0c9c-203">Pokud chcete načíst data pro naplnění DataTable, používáme třídy TableAdapter, který funguje jako náš vrstvy přístupu k datům.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-203">In order to retrieve the data to populate the DataTable, we use a TableAdapter class, which functions as our Data Access Layer.</span></span> <span data-ttu-id="e0c9c-204">Pro naše **produkty** DataTable, TableAdapter bude obsahovat metody **GetProducts()**, **GetProductByCategoryID (*categoryID*)**, a tak dále, který jsme vám vyvolat od prezentační vrstvy.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-204">For our **Products** DataTable, the TableAdapter will contain the methods **GetProducts()**, **GetProductByCategoryID(*categoryID*)**, and so on that we'll invoke from the presentation layer.</span></span> <span data-ttu-id="e0c9c-205">Role DataTable je sloužit jako silně typované objekty sloužící k předávání dat mezi vrstvami.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-205">The DataTable's role is to serve as the strongly-typed objects used to pass data between the layers.</span></span>

<span data-ttu-id="e0c9c-206">Průvodce nastavením TableAdapter začíná výzvou k výběru databázi, kterou chcete pracovat.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-206">The TableAdapter Configuration Wizard begins by prompting you to select which database to work with.</span></span> <span data-ttu-id="e0c9c-207">Rozevíracím seznamu zobrazí tyto databáze v Průzkumníku serveru.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-207">The drop-down list shows those databases in the Server Explorer.</span></span> <span data-ttu-id="e0c9c-208">Pokud databázi Northwind nebyl přidán do Průzkumníka serveru, můžete kliknutím na tlačítko nové připojení v tuto chvíli k tomu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-208">If you did not add the Northwind database to the Server Explorer, you can click the New Connection button at this time to do so.</span></span>


<span data-ttu-id="e0c9c-209">[![Z rozevíracího seznamu zvolte databázi Northwind](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-209">[![Choose the Northwind Database from the Drop-Down List](creating-a-data-access-layer-cs/_static/image12.png)](creating-a-data-access-layer-cs/_static/image11.png)</span></span>

<span data-ttu-id="e0c9c-210">**Obrázek 5**: z rozevíracího seznamu zvolte databázi Northwind ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-210">**Figure 5**: Choose the Northwind Database from the Drop-Down List ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image13.png))</span></span>


<span data-ttu-id="e0c9c-211">Po výběru databáze a kliknutí na tlačítko Další, budete požádáni Pokud chcete uložit připojovací řetězec **Web.config** souboru.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-211">After selecting the database and clicking Next, you'll be asked if you want to save the connection string in the **Web.config** file.</span></span> <span data-ttu-id="e0c9c-212">Uložením připojovací řetězec budete vyhnout, minimu měl pevné zakódovat třídy TableAdapter, což zjednodušuje věci, pokud se v budoucnu změní informace o připojovacím řetězci.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-212">By saving the connection string you'll avoid having it hard coded in the TableAdapter classes, which simplifies things if the connection string information changes in the future.</span></span> <span data-ttu-id="e0c9c-213">Pokud se připojíte k uložení připojovacího řetězce v konfiguračním souboru je umístěný v **&lt;connectionStrings&gt;** oddíl, což může být [volitelně šifrované](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) lepší zabezpečení nebo upravené později pomocí nové stránky vlastností ASP.NET 2.0 v rámci služby IIS grafickým uživatelským rozhraním nástroj pro správu, což je více ideální pro správce.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-213">If you opt to save the connection string in the configuration file it's placed in the **&lt;connectionStrings&gt;** section, which can be [optionally encrypted](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx) for improved security or modified later through the new ASP.NET 2.0 Property Page within the IIS GUI Admin Tool, which is more ideal for administrators.</span></span>


<span data-ttu-id="e0c9c-214">[![Uložit připojovací řetězec do souboru Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-214">[![Save the Connection String to Web.config](creating-a-data-access-layer-cs/_static/image15.png)](creating-a-data-access-layer-cs/_static/image14.png)</span></span>

<span data-ttu-id="e0c9c-215">**Obrázek 6**: Uložit připojovací řetězec do **Web.config** ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-215">**Figure 6**: Save the Connection String to **Web.config** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image16.png))</span></span>


<span data-ttu-id="e0c9c-216">Dále musíme definovat schéma pro první objekt DataTable silného typu a představují první metodu pro naše TableAdapter při naplňování datové sady silného typu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-216">Next, we need to define the schema for the first strongly-typed DataTable and provide the first method for our TableAdapter to use when populating the strongly-typed DataSet.</span></span> <span data-ttu-id="e0c9c-217">Tyto dva kroky jsou současně lze provést tak, že vytvoříte dotaz, který vrátí sloupce z tabulky, že má být v naší datové tabulky.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-217">These two steps are accomplished simultaneously by creating a query that returns the columns from the table that we want reflected in our DataTable.</span></span> <span data-ttu-id="e0c9c-218">Na konci průvodce poskytujeme název metody tohoto dotazu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-218">At the end of the wizard we'll give a method name to this query.</span></span> <span data-ttu-id="e0c9c-219">Jakmile, který se provádí, tuto metodu lze volat z našich prezentační vrstvy.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-219">Once that's been accomplished, this method can be invoked from our presentation layer.</span></span> <span data-ttu-id="e0c9c-220">Metoda spustí definovaný dotaz a naplnit DataTable silného typu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-220">The method will execute the defined query and populate a strongly-typed DataTable.</span></span>

<span data-ttu-id="e0c9c-221">Abyste mohli začít definovat dotaz SQL musí nejprve Udáváme jak chceme TableAdapter vydat dotaz.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-221">To get started defining the SQL query we must first indicate how we want the TableAdapter to issue the query.</span></span> <span data-ttu-id="e0c9c-222">Jsme můžete použít příkaz SQL ad-hoc, vytvořit novou úložnou proceduru nebo použít stávající úložnou proceduru.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-222">We can use an ad-hoc SQL statement, create a new stored procedure, or use an existing stored procedure.</span></span> <span data-ttu-id="e0c9c-223">Těchto kurzech používáme SQL příkazy ad-hoc.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-223">For these tutorials we'll use ad-hoc SQL statements.</span></span> <span data-ttu-id="e0c9c-224">Odkazovat na [Ano/Ne Brian](http://briannoyes.net/)uživatele na článek, [vytvoření vrstvy přístupu k datům s návrháři datové sady Visual Studio 2005](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) příklad použití uložených procedur.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-224">Refer to [Brian Noyes](http://briannoyes.net/)'s article, [Build a Data Access Layer with the Visual Studio 2005 DataSet Designer](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner) for an example of using stored procedures.</span></span>


<span data-ttu-id="e0c9c-225">[![Dotazování dat pomocí příkazu SQL Ad-Hoc](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-225">[![Query the Data Using an Ad-Hoc SQL Statement](creating-a-data-access-layer-cs/_static/image18.png)](creating-a-data-access-layer-cs/_static/image17.png)</span></span>

<span data-ttu-id="e0c9c-226">**Obrázek 7**: dotazování dat pomocí příkazu SQL Ad-Hoc ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-226">**Figure 7**: Query the Data Using an Ad-Hoc SQL Statement ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image19.png))</span></span>


<span data-ttu-id="e0c9c-227">V tuto chvíli jsme můžete zadat v dotazu SQL ručně.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-227">At this point we can type in the SQL query by hand.</span></span> <span data-ttu-id="e0c9c-228">Při vytváření první metoda v TableAdapter obvykle chcete dotaz vrátit sloupce, které musí být vyjádřena v odpovídajícím objektu DataTable.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-228">When creating the first method in the TableAdapter you typically want to have the query return those columns that need to be expressed in the corresponding DataTable.</span></span> <span data-ttu-id="e0c9c-229">Můžeme to provést tak, že vytvoříte dotaz, který vrátí všechny sloupce a všechny řádky z **produkty** tabulky:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-229">We can accomplish this by creating a query that returns all columns and all rows from the **Products** table:</span></span>


<span data-ttu-id="e0c9c-230">[![Do textového pole zadejte příkaz jazyka SQL](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-230">[![Enter the SQL Query Into the Textbox](creating-a-data-access-layer-cs/_static/image21.png)](creating-a-data-access-layer-cs/_static/image20.png)</span></span>

<span data-ttu-id="e0c9c-231">**Obrázek 8**: Zadejte SQL dotazu do textovém poli ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-231">**Figure 8**: Enter the SQL Query Into the Textbox ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image22.png))</span></span>


<span data-ttu-id="e0c9c-232">Můžete také pomocí Tvůrce dotazů a graficky vytvořit dotaz, jak je znázorněno na obrázku 9.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-232">Alternatively, use the Query Builder and graphically construct the query, as shown in Figure 9.</span></span>


<span data-ttu-id="e0c9c-233">[![Vytvořit dotaz graficky, pomocí editoru dotazů](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-233">[![Create the Query Graphically, through the Query Editor](creating-a-data-access-layer-cs/_static/image24.png)](creating-a-data-access-layer-cs/_static/image23.png)</span></span>

<span data-ttu-id="e0c9c-234">**Obrázek 9**: vytvořit dotaz graficky, pomocí editoru dotazů ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-234">**Figure 9**: Create the Query Graphically, through the Query Editor ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image25.png))</span></span>


<span data-ttu-id="e0c9c-235">Po vytvoření dotazu, ale před přechodem na další obrazovce klikněte na tlačítko Upřesnit možnosti.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-235">After creating the query, but before moving onto the next screen, click the Advanced Options button.</span></span> <span data-ttu-id="e0c9c-236">V projektech webových stránek "příkazy Generovat Insert, Update a Delete" je jediná rozšířené možnosti vybrané ve výchozím nastavení; tohoto průvodce spustíte z knihovny tříd nebo projekt Windows bude také vybrána možnost "Pomocí optimistického řízení souběžnosti".</span><span class="sxs-lookup"><span data-stu-id="e0c9c-236">In Web Site Projects, "Generate Insert, Update, and Delete statements" is the only advanced option selected by default; if you run this wizard from a Class Library or a Windows Project the "Use optimistic concurrency" option will also be selected.</span></span> <span data-ttu-id="e0c9c-237">Zatím nechejte nastavené možnosti "Pomocí optimistického řízení souběžnosti" není zaškrtnuto.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-237">Leave the "Use optimistic concurrency" option unchecked for now.</span></span> <span data-ttu-id="e0c9c-238">Prozkoumáme optimistického řízení souběžnosti v budoucích kurzech.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-238">We'll examine optimistic concurrency in future tutorials.</span></span>


<span data-ttu-id="e0c9c-239">[![Vyberte pouze generovat Insert, Update a Delete příkazy možnost](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-239">[![Select Only the Generate Insert, Update, and Delete statements Option](creating-a-data-access-layer-cs/_static/image27.png)](creating-a-data-access-layer-cs/_static/image26.png)</span></span>

<span data-ttu-id="e0c9c-240">**Obrázek 10**: vyberte pouze generovat Insert, Update a Delete příkazy možnost ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-240">**Figure 10**: Select Only the Generate Insert, Update, and Delete statements Option ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image28.png))</span></span>


<span data-ttu-id="e0c9c-241">Po ověření rozšířené možnosti, klikněte na tlačítko Další přejděte na poslední obrazovce.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-241">After verifying the advanced options, click Next to proceed to the final screen.</span></span> <span data-ttu-id="e0c9c-242">Tady jsme se výzva k výběru které metody chcete přidat do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-242">Here we are asked to select which methods to add to the TableAdapter.</span></span> <span data-ttu-id="e0c9c-243">Existují dva způsoby pro naplňování dat:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-243">There are two patterns for populating data:</span></span>

- <span data-ttu-id="e0c9c-244">**Naplnit DataTable** s tímto přístupem vytvoří metodu, která přijímá jako parametr DataTable a naplní ho na základě výsledků dotazu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-244">**Fill a DataTable** with this approach a method is created that takes in a DataTable as a parameter and populates it based on the results of the query.</span></span> <span data-ttu-id="e0c9c-245">Třída adaptéru dat ADO.NET, například implementuje tento model s jeho **Fill()** metody.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-245">The ADO.NET DataAdapter class, for example, implements this pattern with its **Fill()** method.</span></span>
- <span data-ttu-id="e0c9c-246">**Vrátit tabulku DataTable** s tímto přístupem metoda vytvoří a naplňuje objekt DataTable za vás a vrátí jej jako návratová hodnota metody.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-246">**Return a DataTable** with this approach the method creates and fills the DataTable for you and returns it as the methods return value.</span></span>

<span data-ttu-id="e0c9c-247">Můžete mít TableAdapter, implementujte jeden nebo oba tyto vzory.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-247">You can have the TableAdapter implement one or both of these patterns.</span></span> <span data-ttu-id="e0c9c-248">Můžete také přejmenovat metody tady.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-248">You can also rename the methods provided here.</span></span> <span data-ttu-id="e0c9c-249">Ponecháme obou políček zaškrtnuto, přestože jenom popíšeme druhý případ v rámci těchto kurzů.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-249">Let's leave both checkboxes checked, even though we'll only be using the latter pattern throughout these tutorials.</span></span> <span data-ttu-id="e0c9c-250">Navíc přejmenujme spíše obecný **GetData** metodu **GetProducts**.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-250">Also, let's rename the rather generic **GetData** method to **GetProducts**.</span></span>

<span data-ttu-id="e0c9c-251">Pokud je zaškrtnuto, finální zaškrtávací políčko "GenerateDBDirectMethods," vytvoří **Insert()**, **Update()**, a **Delete()** metody pro TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-251">If checked, the final checkbox, "GenerateDBDirectMethods," creates **Insert()**, **Update()**, and **Delete()** methods for the TableAdapter.</span></span> <span data-ttu-id="e0c9c-252">Pokud tuhle možnost necháte nezaškrtnuté, všechny aktualizace, bude nutné provést prostřednictvím jediného objektu TableAdapter **Update()** metoda, která přebírá zadané datové sady, datové tabulky, jednoho datového řádku nebo pole DataRows.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-252">If you leave this option unchecked, all updates will need to be done through the TableAdapter's sole **Update()** method, which takes in the Typed DataSet, a DataTable, a single DataRow, or an array of DataRows.</span></span> <span data-ttu-id="e0c9c-253">(Pokud jste toto políčko zaškrtnuté políčko "generovat Insert, Update a Delete příkazy" možnost rozšířené vlastnosti na obrázku 9 nastavení nebude mít žádný efekt.) Ponecháme toto políčko zaškrtnuto.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-253">(If you've unchecked the "Generate Insert, Update, and Delete statements" option from the advanced properties in Figure 9 this checkbox's setting will have no effect.) Let's leave this checkbox selected.</span></span>


<span data-ttu-id="e0c9c-254">[![Změnit název metody z GetData na GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-254">[![Change the Method Name from GetData to GetProducts](creating-a-data-access-layer-cs/_static/image30.png)](creating-a-data-access-layer-cs/_static/image29.png)</span></span>

<span data-ttu-id="e0c9c-255">**Obrázek 11**: změnit název metody z **GetData** k **GetProducts** ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-255">**Figure 11**: Change the Method Name from **GetData** to **GetProducts** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image31.png))</span></span>


<span data-ttu-id="e0c9c-256">Dokončete průvodce kliknutím na tlačítko Dokončit.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-256">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="e0c9c-257">Po zavření průvodce jsme se vrátí do návrháře datových sad, které zobrazuje objekt DataTable, že jsme právě vytvořili.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-257">After the wizard closes we are returned to the DataSet Designer which shows the DataTable we just created.</span></span> <span data-ttu-id="e0c9c-258">Zobrazí se seznam sloupců v **produkty** DataTable (**ProductID**, **ProductName**, a tak dále), stejně jako metody  **ProductsTableAdapter** (**Fill()** a **GetProducts()**).</span><span class="sxs-lookup"><span data-stu-id="e0c9c-258">You can see the list of columns in the **Products** DataTable (**ProductID**, **ProductName**, and so on), as well as the methods of the **ProductsTableAdapter** (**Fill()** and **GetProducts()**).</span></span>


<span data-ttu-id="e0c9c-259">[![Objekt DataTable produkty a ProductsTableAdapter byly přidány k datové sadě zadán](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-259">[![The Products DataTable and ProductsTableAdapter have been Added to the Typed DataSet](creating-a-data-access-layer-cs/_static/image33.png)](creating-a-data-access-layer-cs/_static/image32.png)</span></span>

<span data-ttu-id="e0c9c-260">**Obrázek 12**: **produkty** DataTable a **ProductsTableAdapter** byly přidány k datové sadě zadán ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-260">**Figure 12**: The **Products** DataTable and **ProductsTableAdapter** have been Added to the Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image34.png))</span></span>


<span data-ttu-id="e0c9c-261">V tuto chvíli máme typované datové sady jedné datové tabulky (**Northwind.Products**) a třídu adaptéru dat silného typu (**NorthwindTableAdapters.ProductsTableAdapter**) s  **GetProducts()** metody.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-261">At this point we have a Typed DataSet with a single DataTable (**Northwind.Products**) and a strongly-typed DataAdapter class (**NorthwindTableAdapters.ProductsTableAdapter**) with a **GetProducts()** method.</span></span> <span data-ttu-id="e0c9c-262">Tyto objekty lze použít pro přístup k seznamu všech produktů, které z kódu, jako jsou:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-262">These objects can be used to access a list of all products from code like:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample1.html)]

<span data-ttu-id="e0c9c-263">Tento kód nevyžadoval nám napsat jeden bit kód specifické pro přístup k datům.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-263">This code did not require us to write one bit of data access-specific code.</span></span> <span data-ttu-id="e0c9c-264">Nebylo nutné k vytvoření instance libovolné třídy rozhraní ADO.NET, jsme neměli k odkazování na libovolné púřipojovací řetězce dotazů SQL nebo uložených procedur komponentami TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-264">We did not have to instantiate any ADO.NET classes, we didn't have to refer to any connection strings, SQL queries, or stored procedures.</span></span> <span data-ttu-id="e0c9c-265">Místo toho TableAdapter přístupový kód nízké úrovně dat nám poskytuje.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-265">Instead, the TableAdapter provides the low-level data access code for us.</span></span>

<span data-ttu-id="e0c9c-266">Každý objekt použitý v tomto příkladu je také silného typu, což Visual Studio, abyste technologie IntelliSense a kontrola typu v době kompilace.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-266">Each object used in this example is also strongly-typed, allowing Visual Studio to provide IntelliSense and compile-time type checking.</span></span> <span data-ttu-id="e0c9c-267">A to nejlepší z všechny datové tabulky vrácené TableAdapter může být vázaný na data technologie ASP.NET webové ovládací prvky, například prvku GridView, DetailsView, DropDownList, CheckBoxList a několik dalších.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-267">And best of all the DataTables returned by the TableAdapter can be bound to ASP.NET data Web controls, such as the GridView, DetailsView, DropDownList, CheckBoxList, and several others.</span></span> <span data-ttu-id="e0c9c-268">Následující příklad ukazuje vazby vrácený objekt DataTable **GetProducts()** metodu GridView v kódu v rámci jen omezená kapacita tři řádky **stránky\_zatížení** obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-268">The following example illustrates binding the DataTable returned by the **GetProducts()** method to a GridView in just a scant three lines of code within the **Page\_Load** event handler.</span></span>

<span data-ttu-id="e0c9c-269">AllProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="e0c9c-269">AllProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample2.aspx)]

<span data-ttu-id="e0c9c-270">AllProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="e0c9c-270">AllProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample3.cs)]


<span data-ttu-id="e0c9c-271">[![Zobrazí se seznam produktů v GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-271">[![The List of Products is Displayed in a GridView](creating-a-data-access-layer-cs/_static/image36.png)](creating-a-data-access-layer-cs/_static/image35.png)</span></span>

<span data-ttu-id="e0c9c-272">**Obrázek 13**: seznam produktů se zobrazí v GridView ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-272">**Figure 13**: The List of Products is Displayed in a GridView ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image37.png))</span></span>


<span data-ttu-id="e0c9c-273">V tomto příkladu vyžadují napíšeme tři řádky kódu na naší stránce ASP.NET **stránky\_zatížení** obslužná rutina události, v budoucích kurzech prozkoumáme postupy použití ovládacího prvku ObjectDataSource deklarativně načítat data z VRSTVY DAL.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-273">While this example required that we write three lines of code in our ASP.NET page's **Page\_Load** event handler, in future tutorials we'll examine how to use the ObjectDataSource to declaratively retrieve the data from the DAL.</span></span> <span data-ttu-id="e0c9c-274">Ovládacím prvkem ObjectDataSource jsme není potřeba psát jakýkoli kód a získáte také podporu stránkování a řazení.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-274">With the ObjectDataSource we'll not have to write any code and will get paging and sorting support as well!</span></span>

## <a name="step-3-adding-parameterized-methods-to-the-data-access-layer"></a><span data-ttu-id="e0c9c-275">Krok 3: Přidání parametry metody pro vrstvy přístupu k datům</span><span class="sxs-lookup"><span data-stu-id="e0c9c-275">Step 3: Adding Parameterized Methods to the Data Access Layer</span></span>

<span data-ttu-id="e0c9c-276">V tomto okamžiku naše **ProductsTableAdapter** třída má ale jedna metoda **GetProducts()**, který vrátí všechny produkty v databázi.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-276">At this point our **ProductsTableAdapter** class has but one method, **GetProducts()**, which returns all of the products in the database.</span></span> <span data-ttu-id="e0c9c-277">Schopnost pracovat u všech produktů je jednoznačně užitečné, jsou časy, kdy jsme budete chtít načíst informace o konkrétní produkt nebo všechny produkty, které patří do určité kategorie.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-277">While being able to work with all products is definitely useful, there are times when we'll want to retrieve information about a specific product, or all products that belong to a particular category.</span></span> <span data-ttu-id="e0c9c-278">Přidejte tyto funkce do našich vrstvy přístupu k datům jsme parametry metody přidat do TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-278">To add such functionality to our Data Access Layer we can add parameterized methods to the TableAdapter.</span></span>

<span data-ttu-id="e0c9c-279">Přidejme **GetProductsByCategoryID (*categoryID*)** metody.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-279">Let's add the **GetProductsByCategoryID(*categoryID*)** method.</span></span> <span data-ttu-id="e0c9c-280">Chcete-li přidat novou metodu vrstvy Dal, vraťte se na návrháři datových sad klikněte pravým tlačítkem **ProductsTableAdapter** a zvolte Přidat dotaz.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-280">To add a new method to the DAL, return to the DataSet Designer, right-click in the **ProductsTableAdapter** section, and choose Add Query.</span></span>


![Klikněte pravým tlačítkem na TableAdapter a zvolte Přidat dotaz](creating-a-data-access-layer-cs/_static/image38.png)

<span data-ttu-id="e0c9c-282">**Obrázek 14**: klikněte pravým tlačítkem na TableAdapter a zvolte Přidat dotaz</span><span class="sxs-lookup"><span data-stu-id="e0c9c-282">**Figure 14**: Right-Click on the TableAdapter and Choose Add Query</span></span>


<span data-ttu-id="e0c9c-283">Můžeme se nejdřív zobrazí výzva o, jestli chcete přístup k databázi pomocí ad-hoc příkazu SQL nebo uloženou proceduru nové nebo existující.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-283">We are first prompted about whether we want to access the database using an ad-hoc SQL statement or a new or existing stored procedure.</span></span> <span data-ttu-id="e0c9c-284">Umožňuje zvolit použití příkazu SQL ad-hoc znovu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-284">Let's choose to use an ad-hoc SQL statement again.</span></span> <span data-ttu-id="e0c9c-285">Dále jsme se výzva, jaký typ dotazu SQL, jsme chtěli použít.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-285">Next, we are asked what type of SQL query we'd like to use.</span></span> <span data-ttu-id="e0c9c-286">Protože chceme vrátit všechny produkty, které patří do zadané kategorie, chceme napsat **vyberte** příkaz, který vrátí řádky.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-286">Since we want to return all products that belong to a specified category, we want to write a **SELECT** statement which returns rows.</span></span>


<span data-ttu-id="e0c9c-287">[![Můžete vytvořit příkaz SELECT, který vrátí řádky](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-287">[![Choose to Create a SELECT Statement Which Returns Rows](creating-a-data-access-layer-cs/_static/image40.png)](creating-a-data-access-layer-cs/_static/image39.png)</span></span>

<span data-ttu-id="e0c9c-288">**Obrázek 15**: Zvolte možnost vytvořit **vyberte** příkaz který vrací řádky ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-288">**Figure 15**: Choose to Create a **SELECT** Statement Which Returns Rows ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image41.png))</span></span>


<span data-ttu-id="e0c9c-289">Dalším krokem je definování dotaz SQL použitý pro přístup k datům.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-289">The next step is to define the SQL query used to access the data.</span></span> <span data-ttu-id="e0c9c-290">Protože chceme vrátit pouze produkty, které patří do určité kategorie, použiji stejný <strong>vyberte</strong> příkaz z <strong>GetProducts()</strong>, ale přidejte následující <strong>kde</strong> klauzule: <strong>kde CategoryID = @CategoryID</strong> .</span><span class="sxs-lookup"><span data-stu-id="e0c9c-290">Since we want to return only those products that belong to a particular category, I use the same <strong>SELECT</strong> statement from <strong>GetProducts()</strong>, but add the following <strong>WHERE</strong> clause: <strong>WHERE CategoryID = @CategoryID</strong>.</span></span> <span data-ttu-id="e0c9c-291"><strong>@CategoryID</strong> Parametr označuje do Průvodce vytvořením objektu TableAdapter, že metoda vytváříme budou vyžadovat vstupní parametr typu odpovídající (konkrétně, s možnou hodnotou Null celé číslo).</span><span class="sxs-lookup"><span data-stu-id="e0c9c-291">The <strong>@CategoryID</strong> parameter indicates to the TableAdapter wizard that the method we're creating will require an input parameter of the corresponding type (namely, a nullable integer).</span></span>


<span data-ttu-id="e0c9c-292">[![Zadejte dotaz a vrátit pouze produktech v určené kategorii](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-292">[![Enter a Query to Only Return Products in a Specified Category](creating-a-data-access-layer-cs/_static/image43.png)](creating-a-data-access-layer-cs/_static/image42.png)</span></span>

<span data-ttu-id="e0c9c-293">**Obrázek 16**: Zadejte dotaz pouze vrátit produktů v zadané kategorii ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-293">**Figure 16**: Enter a Query to Only Return Products in a Specified Category ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image44.png))</span></span>


<span data-ttu-id="e0c9c-294">V posledním kroku, abychom si mohli vybrat který vzorce a používat, stejně jako vlastní názvy metod, vygeneruje pro přístup k datům.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-294">In the final step we can choose which data access patterns to use, as well as customize the names of the methods generated.</span></span> <span data-ttu-id="e0c9c-295">Vzorek výplně Změníme název, který má <strong>FillByCategoryID</strong> a pro vrácený objekt DataTable vrátí vzor ( <strong>získat*X</strong>*  metody), použijeme  <strong>GetProductsByCategoryID</strong>.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-295">For the Fill pattern, let's change the name to <strong>FillByCategoryID</strong> and for the return a DataTable return pattern (the <strong>Get*X</strong>* methods), let's use <strong>GetProductsByCategoryID</strong>.</span></span>


<span data-ttu-id="e0c9c-296">[![Zvolte názvy metody třídy TableAdapter](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-296">[![Choose the Names for the TableAdapter Methods](creating-a-data-access-layer-cs/_static/image46.png)](creating-a-data-access-layer-cs/_static/image45.png)</span></span>

<span data-ttu-id="e0c9c-297">**Obrázek 17**: Zvolte názvy metody třídy TableAdapter ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-297">**Figure 17**: Choose the Names for the TableAdapter Methods ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image47.png))</span></span>


<span data-ttu-id="e0c9c-298">Po dokončení průvodce, návrháři datových sad zahrnuje nové metody třídy TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-298">After completing the wizard, the DataSet Designer includes the new TableAdapter methods.</span></span>


![Dotazování na produkty můžete nyní podle kategorie](creating-a-data-access-layer-cs/_static/image48.png)

<span data-ttu-id="e0c9c-300">**Obrázek 18**: dotazování produkty můžete nyní podle kategorie</span><span class="sxs-lookup"><span data-stu-id="e0c9c-300">**Figure 18**: The Products Can Now be Queried by Category</span></span>


<span data-ttu-id="e0c9c-301">Za chvíli přidat **GetProductByProductID (*productID*)** metodu pomocí stejným způsobem.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-301">Take a moment to add a **GetProductByProductID(*productID*)** method using the same technique.</span></span>

<span data-ttu-id="e0c9c-302">Tyto parametrizovaných dotazů můžete otestovat přímo v návrháři datových sad.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-302">These parameterized queries can be tested directly from the DataSet Designer.</span></span> <span data-ttu-id="e0c9c-303">Klikněte pravým tlačítkem na metodu v TableAdapter a zvolit Data ve verzi Preview.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-303">Right-click on the method in the TableAdapter and choose Preview Data.</span></span> <span data-ttu-id="e0c9c-304">Pak zadejte hodnoty pro parametry a klikněte na tlačítko ve verzi Preview.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-304">Next, enter the values to use for the parameters and click Preview.</span></span>


<span data-ttu-id="e0c9c-305">[![Jsou uvedeny tyto produkty, který patří do kategorie Nápoje](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-305">[![Those Products Belonging to the Beverages Category are Shown](creating-a-data-access-layer-cs/_static/image50.png)](creating-a-data-access-layer-cs/_static/image49.png)</span></span>

<span data-ttu-id="e0c9c-306">**Obrázek 19**: jsou uvedeny tyto produkty, který patří do kategorie nápoje ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-306">**Figure 19**: Those Products Belonging to the Beverages Category are Shown ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image51.png))</span></span>


<span data-ttu-id="e0c9c-307">S **GetProductsByCategoryID (*categoryID*)** metoda v našich DAL, teď můžeme vytvořit stránku ASP.NET, která se zobrazí jenom produkty v určené kategorii.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-307">With the **GetProductsByCategoryID(*categoryID*)** method in our DAL, we can now create an ASP.NET page that displays only those products in a specified category.</span></span> <span data-ttu-id="e0c9c-308">Následující příklad ukazuje všechny produkty, které jsou do kategorie Nápoje, které mají **CategoryID** 1.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-308">The following example shows all products that are in the Beverages category, which have a **CategoryID** of 1.</span></span>

<span data-ttu-id="e0c9c-309">Beverages.ASP</span><span class="sxs-lookup"><span data-stu-id="e0c9c-309">Beverages.asp</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample4.aspx)]

<span data-ttu-id="e0c9c-310">Beverages.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="e0c9c-310">Beverages.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample5.cs)]


<span data-ttu-id="e0c9c-311">[![Se zobrazují tyto produkty do kategorie Nápoje](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-311">[![Those Products in the Beverages Category are Displayed](creating-a-data-access-layer-cs/_static/image53.png)](creating-a-data-access-layer-cs/_static/image52.png)</span></span>

<span data-ttu-id="e0c9c-312">**Obrázek 20**: se zobrazují tyto produkty do kategorie nápoje ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-312">**Figure 20**: Those Products in the Beverages Category are Displayed ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image54.png))</span></span>


## <a name="step-4-inserting-updating-and-deleting-data"></a><span data-ttu-id="e0c9c-313">Krok 4: Vložení, aktualizace a odstranění dat</span><span class="sxs-lookup"><span data-stu-id="e0c9c-313">Step 4: Inserting, Updating, and Deleting Data</span></span>

<span data-ttu-id="e0c9c-314">Existují dva způsoby, které se běžně používá pro vkládání, aktualizaci a odstraňování dat.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-314">There are two patterns commonly used for inserting, updating, and deleting data.</span></span> <span data-ttu-id="e0c9c-315">První vzor, který budu jim říkat přímé model databáze, zahrnuje vytvoření metody, že při vyvolání, problém **vložit**, **aktualizace**, nebo **odstranit** příkaz databáze, která funguje na záznam v jedné databázi.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-315">The first pattern, which I'll call the database direct pattern, involves creating methods that, when invoked, issue an **INSERT**, **UPDATE**, or **DELETE** command to the database that operates on a single database record.</span></span> <span data-ttu-id="e0c9c-316">Tyto metody jsou obvykle předány v řadě skalárních hodnot (celá čísla, řetězce, logické hodnoty, data a času a tak dále), které odpovídají hodnotám vložit, aktualizovat nebo odstranit.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-316">Such methods are typically passed in a series of scalar values (integers, strings, Booleans, DateTimes, and so on) that correspond to the values to insert, update, or delete.</span></span> <span data-ttu-id="e0c9c-317">Například s tímto modelem stačí pro **produkty** tabulky metodu delete padl parametr celé číslo, určující **ProductID** z záznam, který chcete odstranit, zatímco metoda vložit padl řetězec **ProductName**, decimal pro **UnitPrice**, celé číslo pro **UnitsOnStock**, a tak dále.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-317">For example, with this pattern for the **Products** table the delete method would take in an integer parameter, indicating the **ProductID** of the record to delete, while the insert method would take in a string for the **ProductName**, a decimal for the **UnitPrice**, an integer for the **UnitsOnStock**, and so on.</span></span>


<span data-ttu-id="e0c9c-318">[![Každý Insert, Update a Delete žádosti je odeslána databáze hned](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-318">[![Each Insert, Update, and Delete Request is Sent to the Database Immediately](creating-a-data-access-layer-cs/_static/image56.png)](creating-a-data-access-layer-cs/_static/image55.png)</span></span>

<span data-ttu-id="e0c9c-319">**Obrázek 21**: každý vložení, aktualizace a odstranění žádosti je odeslána do databáze okamžitě ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-319">**Figure 21**: Each Insert, Update, and Delete Request is Sent to the Database Immediately ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image57.png))</span></span>


<span data-ttu-id="e0c9c-320">Další vzor, který jsem budete odkazovat dávkové aktualizaci vzor, je aktualizovat celé datové sady, datové tabulky nebo kolekce DataRows v jedné metody volání.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-320">The other pattern, which I'll refer to as the batch update pattern, is to update an entire DataSet, DataTable, or collection of DataRows in one method call.</span></span> <span data-ttu-id="e0c9c-321">S tímto modelem stačí vývojář odstraní, vloží a změní DataRows v datové tabulce a pak předá do metodu aktualizace těchto DataRows ani objekt DataTable.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-321">With this pattern a developer deletes, inserts, and modifies the DataRows in a DataTable and then passes those DataRows or DataTable into an update method.</span></span> <span data-ttu-id="e0c9c-322">Tato metoda pak vytvoří výčet DataRows předaný, určuje, zda jsou jsme se změnily, přidat nebo odstranit (prostřednictvím objekt DataRow [RowState vlastnost](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) hodnota) a vydá požadavek příslušnou databázi pro každý záznam.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-322">This method then enumerates the DataRows passed in, determines whether or not they've been modified, added, or deleted (via the DataRow's [RowState property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) value), and issues the appropriate database request for each record.</span></span>


<span data-ttu-id="e0c9c-323">[![Všechny změny jsou synchronizovány s databází při vyvolání metody Update](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-323">[![All Changes are Synchronized with the Database When the Update Method is Invoked](creating-a-data-access-layer-cs/_static/image59.png)](creating-a-data-access-layer-cs/_static/image58.png)</span></span>

<span data-ttu-id="e0c9c-324">**Obrázek 22**: všechny změny jsou synchronizovány s databází při vyvolání metody Update ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-324">**Figure 22**: All Changes are Synchronized with the Database When the Update Method is Invoked ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image60.png))</span></span>


<span data-ttu-id="e0c9c-325">TableAdapter používá vzor aktualizace služby batch ve výchozím nastavení, ale také podporuje model s přímým přístupem DB.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-325">The TableAdapter uses the batch update pattern by default, but also supports the DB direct pattern.</span></span> <span data-ttu-id="e0c9c-326">Protože jsme vybrali možnost "příkazy Generovat Insert, Update a Delete" Upřesnit vlastnosti při vytváření naší třídy TableAdapter **ProductsTableAdapter** obsahuje **Update()** metody která implementuje vzor aktualizace služby batch.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-326">Since we selected the "Generate Insert, Update, and Delete statements" option from the Advanced Properties when creating our TableAdapter, the **ProductsTableAdapter** contains an **Update()** method, which implements the batch update pattern.</span></span> <span data-ttu-id="e0c9c-327">Konkrétně obsahuje TableAdapter **Update()** metodu, která je možné předat typované datové sady, datové tabulky silného typu nebo jeden nebo více DataRows.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-327">Specifically, the TableAdapter contains an **Update()** method that can be passed the Typed DataSet, a strongly-typed DataTable, or one or more DataRows.</span></span> <span data-ttu-id="e0c9c-328">Pokud jste nechali zaškrtnuté políčko "GenerateDBDirectMethods" při prvním vytvoření objektu TableAdapter s přímým přístupem vzor DB budou prováděny také prostřednictvím **Insert()**, **Update()**, a **Delete()**  metody.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-328">If you left the "GenerateDBDirectMethods" checkbox checked when first creating the TableAdapter the DB direct pattern will also be implemented via **Insert()**, **Update()**, and **Delete()** methods.</span></span>

<span data-ttu-id="e0c9c-329">Oba vzorky úpravy dat pomocí objektu TableAdapter **událost InsertCommand**, **událost UpdateCommand**, a **událost DeleteCommand** vlastnosti vydat jejich **vložit** , **Aktualizace**, a **odstranit** příkazů do databáze.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-329">Both data modification patterns use the TableAdapter's **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties to issue their **INSERT**, **UPDATE**, and **DELETE** commands to the database.</span></span> <span data-ttu-id="e0c9c-330">Můžete zkontrolovat a upravit **událost InsertCommand**, **událost UpdateCommand**, a **událost DeleteCommand** vlastnosti kliknutím na TableAdapter v návrháři datových sad a pak v okně Vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-330">You can inspect and modify the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** properties by clicking on the TableAdapter in the DataSet Designer and then going to the Properties window.</span></span> <span data-ttu-id="e0c9c-331">(Ujistěte se, že jste vybrali TableAdapter a že **ProductsTableAdapter** objektu je vybrali v rozevíracím seznamu v okně Vlastnosti.)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-331">(Make sure you have selected the TableAdapter, and that the **ProductsTableAdapter** object is the one selected in the drop-down list in the Properties window.)</span></span>


<span data-ttu-id="e0c9c-332">[![TableAdapter má událost InsertCommand událost UpdateCommand a událost DeleteCommand vlastnosti](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-332">[![The TableAdapter has InsertCommand, UpdateCommand, and DeleteCommand Properties](creating-a-data-access-layer-cs/_static/image62.png)](creating-a-data-access-layer-cs/_static/image61.png)</span></span>

<span data-ttu-id="e0c9c-333">**Obrázek 23**: The TableAdapter nemá **událost InsertCommand**, **událost UpdateCommand**, a **událost DeleteCommand** vlastnosti ([klikněte na zobrazit reklamy Obrázek](creating-a-data-access-layer-cs/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-333">**Figure 23**: The TableAdapter has **InsertCommand**, **UpdateCommand**, and **DeleteCommand** Properties ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image63.png))</span></span>


<span data-ttu-id="e0c9c-334">Pokud chcete zkontrolovat nebo změnit libovolné z těchto vlastností příkazu databáze, klikněte na **CommandText** dílčí vlastnosti, které se otevře Tvůrce dotazů.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-334">To examine or modify any of these database command properties, click on the **CommandText** subproperty, which will bring up the Query Builder.</span></span>


<span data-ttu-id="e0c9c-335">[![Konfigurace INSERT, UPDATE a DELETE příkazy v editoru dotazů](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-335">[![Configure the INSERT, UPDATE, and DELETE Statements in the Query Builder](creating-a-data-access-layer-cs/_static/image65.png)](creating-a-data-access-layer-cs/_static/image64.png)</span></span>

<span data-ttu-id="e0c9c-336">**Obrázek 24**: konfigurace **vložit**, **aktualizace**, a **odstranit** příkazy v editoru dotazů ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image66.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-336">**Figure 24**: Configure the **INSERT**, **UPDATE**, and **DELETE** Statements in the Query Builder ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image66.png))</span></span>


<span data-ttu-id="e0c9c-337">Následující příklad kódu ukazuje, jak dvakrát cena všechny produkty, které nejsou není podporován a, které mají 25 jednotek v zásobách nebo i rychleji pomocí vzoru aktualizace služby batch:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-337">The following code example shows how to use the batch update pattern to double the price of all products that are not discontinued and that have 25 units in stock or less:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample6.cs)]

<span data-ttu-id="e0c9c-338">Následující kód ukazuje, jak pomocí vzoru s přímým přístupem DB prostřednictvím kódu programu odstranit konkrétní produkt a potom aktualizovat jeden a pak přidejte nový:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-338">The code below illustrates how to use the DB direct pattern to programmatically delete a particular product, then update one, and then add a new one:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample7.cs)]

## <a name="creating-custom-insert-update-and-delete-methods"></a><span data-ttu-id="e0c9c-339">Vytvoření vlastní Insert, Update a Delete metody</span><span class="sxs-lookup"><span data-stu-id="e0c9c-339">Creating Custom Insert, Update, and Delete Methods</span></span>

<span data-ttu-id="e0c9c-340">**Insert()**, **Update()**, a **Delete()** metody vytvořené DB přímé metody mohou být o něco náročnější, zejména u tabulek s mnoha sloupci.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-340">The **Insert()**, **Update()**, and **Delete()** methods created by the DB direct method can be a bit cumbersome, especially for tables with many columns.</span></span> <span data-ttu-id="e0c9c-341">Hledání v předcházejícím příkladu, bez pomoci IntelliSense pro není zejména jasné, co **produkty** sloupec tabulky mapuje pro každý vstupní parametr **Update()** a **Insert()**  metody.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-341">Looking at the previous code example, without IntelliSense's help it's not particularly clear what **Products** table column maps to each input parameter to the **Update()** and **Insert()** methods.</span></span> <span data-ttu-id="e0c9c-342">Může nastat situace, kdy chceme jenom aktualizace jednoho sloupce nebo dvě, nebo má vlastní **Insert()** metodu, která bude možná, návratová hodnota nově vložený záznam **IDENTITY** (automatické zvyšování čísla) pole.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-342">There may be times when we only want to update a single column or two, or want a customized **Insert()** method that will, perhaps, return the value of the newly inserted record's **IDENTITY** (auto-increment) field.</span></span>

<span data-ttu-id="e0c9c-343">Chcete-li vytvořit vlastní metodu, vraťte se na návrháři datových sad.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-343">To create such a custom method, return to the DataSet Designer.</span></span> <span data-ttu-id="e0c9c-344">Klikněte pravým tlačítkem na TableAdapter a zvolte Přidat dotaz vrací do Průvodce vytvořením objektu TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-344">Right-click on the TableAdapter and choose Add Query, returning to the TableAdapter wizard.</span></span> <span data-ttu-id="e0c9c-345">Na druhé obrazovce mohou Udáváme typu dotazu k vytvoření.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-345">On the second screen we can indicate the type of query to create.</span></span> <span data-ttu-id="e0c9c-346">Vytvoříme metodu, která přidá nový produkt a vrátí hodnotu nově přidaný záznam **ProductID**.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-346">Let's create a method that adds a new product and then returns the value of the newly added record's **ProductID**.</span></span> <span data-ttu-id="e0c9c-347">Proto se rozhodnout vytvořit **vložit** dotazu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-347">Therefore, opt to create an **INSERT** query.</span></span>


<span data-ttu-id="e0c9c-348">[![Vytvoření metody přidání nový řádek do tabulky produktů](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-348">[![Create a Method to Add a New Row to the Products Table](creating-a-data-access-layer-cs/_static/image68.png)](creating-a-data-access-layer-cs/_static/image67.png)</span></span>

<span data-ttu-id="e0c9c-349">**Obrázek 25**: vytvoření metody přidání na nový řádek pro **produkty** tabulky ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image69.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-349">**Figure 25**: Create a Method to Add a New Row to the **Products** Table ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image69.png))</span></span>


<span data-ttu-id="e0c9c-350">Na další obrazovce **událost InsertCommand**společnosti **CommandText** se zobrazí.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-350">On the next screen the **InsertCommand**'s **CommandText** appears.</span></span> <span data-ttu-id="e0c9c-351">Tento dotaz rozšířit přidáním **vyberte rozsah\_IDENTITY()** na konec dotazu, která vrátí poslední hodnotu identity, které jsou vloženy do **IDENTITY** sloupce ve stejném oboru.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-351">Augment this query by adding **SELECT SCOPE\_IDENTITY()** at the end of the query, which will return the last identity value inserted into an **IDENTITY** column in the same scope.</span></span> <span data-ttu-id="e0c9c-352">(Najdete v článku [technickou dokumentaci](https://msdn.microsoft.com/library/ms190315.aspx) Další informace o **oboru\_IDENTITY()** a proč budete pravděpodobně chtít [použít OBOR\_IDENTITY() náhrada @ @IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Zajistěte, že jste **vložit** příkaz středníkem před přidáním **vyberte** příkazu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-352">(See the [technical documentation](https://msdn.microsoft.com/library/ms190315.aspx) for more information about **SCOPE\_IDENTITY()** and why you probably want to [use SCOPE\_IDENTITY() in lieu of @@IDENTITY](http://weblogs.sqlteam.com/travisl/archive/2003/10/29/405.aspx).) Make sure that you end the **INSERT** statement with a semi-colon before adding the **SELECT** statement.</span></span>


<span data-ttu-id="e0c9c-353">[![Upravte dotaz, který vrací hodnotu SCOPE_IDENTITY()](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-353">[![Augment the Query to Return the SCOPE_IDENTITY() Value](creating-a-data-access-layer-cs/_static/image71.png)](creating-a-data-access-layer-cs/_static/image70.png)</span></span>

<span data-ttu-id="e0c9c-354">**Obrázek 26**: Upravte dotaz pro návrat **oboru\_IDENTITY()** hodnotu ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image72.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-354">**Figure 26**: Augment the Query to Return the **SCOPE\_IDENTITY()** Value ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image72.png))</span></span>


<span data-ttu-id="e0c9c-355">A konečně, pojmenujte novou metodu **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-355">Finally, name the new method **InsertProduct**.</span></span>


<span data-ttu-id="e0c9c-356">[![Nastavte název nové metody InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-356">[![Set the New Method Name to InsertProduct](creating-a-data-access-layer-cs/_static/image74.png)](creating-a-data-access-layer-cs/_static/image73.png)</span></span>

<span data-ttu-id="e0c9c-357">**Obrázek 27**: nastavte název nové metody **InsertProduct** ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image75.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-357">**Figure 27**: Set the New Method Name to **InsertProduct** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image75.png))</span></span>


<span data-ttu-id="e0c9c-358">Po návratu do návrháře DataSet uvidíte, že **ProductsTableAdapter** obsahuje novou metodu **InsertProduct**.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-358">When you return to the DataSet Designer you'll see that the **ProductsTableAdapter** contains a new method, **InsertProduct**.</span></span> <span data-ttu-id="e0c9c-359">Pokud tato nová metoda nemá parametr pro každý sloupec v **produkty** tabulky, je pravděpodobné jste zapomněli ukončení **vložit** příkaz oddělíte středníkem.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-359">If this new method doesn't have a parameter for each column in the **Products** table, chances are you forgot to terminate the **INSERT** statement with a semi-colon.</span></span> <span data-ttu-id="e0c9c-360">Konfigurace **InsertProduct** metoda a ujistěte se, máte středníkem omezující **vložit** a **vyberte** příkazy.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-360">Configure the **InsertProduct** method and ensure you have a semi-colon delimiting the **INSERT** and **SELECT** statements.</span></span>

<span data-ttu-id="e0c9c-361">Ve výchozím nastavení vložte metody problém není dotazem metody, což znamená, že vrátí počet ovlivněných řádků.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-361">By default, insert methods issue non-query methods, meaning that they return the number of affected rows.</span></span> <span data-ttu-id="e0c9c-362">Chceme, ale **InsertProduct** metoda k vrácení hodnoty vrácené dotazem, ne počet ovlivněných řádků.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-362">However, we want the **InsertProduct** method to return the value returned by the query, not the number of rows affected.</span></span> <span data-ttu-id="e0c9c-363">Chcete-li to provést, upravte **InsertProduct** metody **ExecuteMode** vlastnost **skalární**.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-363">To accomplish this, adjust the **InsertProduct** method's **ExecuteMode** property to **Scalar**.</span></span>


<span data-ttu-id="e0c9c-364">[![Změňte vlastnost ExecuteMode na skalár](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-364">[![Change the ExecuteMode Property to Scalar](creating-a-data-access-layer-cs/_static/image77.png)](creating-a-data-access-layer-cs/_static/image76.png)</span></span>

<span data-ttu-id="e0c9c-365">**Obrázek 28**: Změna **ExecuteMode** vlastnost **skalární** ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image78.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-365">**Figure 28**: Change the **ExecuteMode** Property to **Scalar** ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image78.png))</span></span>


<span data-ttu-id="e0c9c-366">Následující kód ukazuje tento nový **InsertProduct** metodu v akci:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-366">The following code shows this new **InsertProduct** method in action:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample8.cs)]

## <a name="step-5-completing-the-data-access-layer"></a><span data-ttu-id="e0c9c-367">Krok 5: Dokončení vrstvy přístupu k datům</span><span class="sxs-lookup"><span data-stu-id="e0c9c-367">Step 5: Completing the Data Access Layer</span></span>

<span data-ttu-id="e0c9c-368">Všimněte si, že **ProductsTableAdapters** třídy vrátí **CategoryID** a **KódDodavatele** hodnoty z **produkty** tabulky, ale neobsahuje **CategoryName** sloupec z **kategorie** tabulky nebo **CompanyName** sloupec z **Dodavatelé**tabulky, přestože jde pravděpodobně o sloupce chceme zobrazit při zobrazování informací o produktu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-368">Note that the **ProductsTableAdapters** class returns the **CategoryID** and **SupplierID** values from the **Products** table, but doesn't include the **CategoryName** column from the **Categories** table or the **CompanyName** column from the **Suppliers** table, although these are likely the columns we want to display when showing product information.</span></span> <span data-ttu-id="e0c9c-369">Můžeme rozšířit počáteční metody objektu TableAdapter **GetProducts()**, oba **CategoryName** a **CompanyName** hodnoty sloupce, které se aktualizuje silného typu objektu DataTable zahrnout tyto nové sloupce.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-369">We can augment the TableAdapter's initial method, **GetProducts()**, to include both the **CategoryName** and **CompanyName** column values, which will update the strongly-typed DataTable to include these new columns as well.</span></span>

<span data-ttu-id="e0c9c-370">Může to znamenat problém, ale jako metody objektu TableAdapter pro vkládání, aktualizací a odstraňování dat vychází z této metody počáteční.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-370">This can present a problem, however, as the TableAdapter's methods for inserting, updating, and deleting data are based off of this initial method.</span></span> <span data-ttu-id="e0c9c-371">Naštěstí automaticky generované metody pro vkládání, aktualizaci a odstraňování nejsou ovlivněny poddotazy v **vyberte** klauzuli.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-371">Fortunately, the auto-generated methods for inserting, updating, and deleting are not affected by subqueries in the **SELECT** clause.</span></span> <span data-ttu-id="e0c9c-372">Protože se stará přidáte náš dotazy na **kategorie** a **Dodavatelé** jako poddotazy, spíše než **připojte se k** s, můžeme vám vyhnout se tak nutnosti přepracovat tyto metody pro úpravu dat.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-372">By taking care to add our queries to **Categories** and **Suppliers** as subqueries, rather than **JOIN** s, we'll avoid having to rework those methods for modifying data.</span></span> <span data-ttu-id="e0c9c-373">Klikněte pravým tlačítkem na **GetProducts()** metodu **ProductsTableAdapter** a zvolením možnosti konfigurovat.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-373">Right-click on the **GetProducts()** method in the **ProductsTableAdapter** and choose Configure.</span></span> <span data-ttu-id="e0c9c-374">Potom upravte **vyberte** klauzule tak, že vypadají, jako jsou:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-374">Then, adjust the **SELECT** clause so that it looks like:</span></span>

[!code-sql[Main](creating-a-data-access-layer-cs/samples/sample9.sql)]


<span data-ttu-id="e0c9c-375">[![Aktualizace příkazu SELECT pro GetProducts() – metoda](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-375">[![Update the SELECT Statement for the GetProducts() Method](creating-a-data-access-layer-cs/_static/image80.png)](creating-a-data-access-layer-cs/_static/image79.png)</span></span>

<span data-ttu-id="e0c9c-376">**Obrázek 29**: aktualizace **vyberte** příkaz **GetProducts()** – metoda ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image81.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-376">**Figure 29**: Update the **SELECT** Statement for the **GetProducts()** Method ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image81.png))</span></span>


<span data-ttu-id="e0c9c-377">Po aktualizaci **GetProducts()** metoda se má použít tento nový dotaz objekt DataTable bude obsahovat dva nové sloupce: **CategoryName** a **dodavatel**.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-377">After updating the **GetProducts()** method to use this new query the DataTable will include two new columns: **CategoryName** and **SupplierName**.</span></span>


![Objekt DataTable produkty má dva nové sloupce](creating-a-data-access-layer-cs/_static/image82.png)

<span data-ttu-id="e0c9c-379">**Obrázek 30**: **produkty** DataTable má dva nové sloupce</span><span class="sxs-lookup"><span data-stu-id="e0c9c-379">**Figure 30**: The **Products** DataTable has Two New Columns</span></span>


<span data-ttu-id="e0c9c-380">Za chvíli se aktualizovat **vyberte** klauzuli v **GetProductsByCategoryID (*categoryID*)** také metody.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-380">Take a moment to update the **SELECT** clause in the **GetProductsByCategoryID(*categoryID*)** method as well.</span></span>

<span data-ttu-id="e0c9c-381">Pokud aktualizujete **GetProducts()** **vyberte** pomocí **připojení** syntaxe Návrhář DataSet nebudou moct automaticky vygenerovat metody pro vkládání, aktualizaci a odstraňování použití modelu s přímým přístupem DB dat z databáze.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-381">If you update the **GetProducts()** **SELECT** using **JOIN** syntax the DataSet Designer won't be able to auto-generate the methods for inserting, updating, and deleting database data using the DB direct pattern.</span></span> <span data-ttu-id="e0c9c-382">Místo toho budete muset ručně vytvořit je podobně jako jsme to udělali s **InsertProduct** metoda dříve v tomto kurzu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-382">Instead, you'll have to manually create them much like we did with the **InsertProduct** method earlier in this tutorial.</span></span> <span data-ttu-id="e0c9c-383">Kromě toho ručně musíte poskytnout **událost InsertCommand**, **událost UpdateCommand**, a **událost DeleteCommand** hodnoty vlastnosti, pokud chcete používat službu batch, aktualizuje se vzor.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-383">Furthermore, you'll manually have to provide the **InsertCommand**, **UpdateCommand**, and **DeleteCommand** property values if you want to use the batch updating pattern.</span></span>

## <a name="adding-the-remaining-tableadapters"></a><span data-ttu-id="e0c9c-384">Přidání zbývající objekty TableAdapter</span><span class="sxs-lookup"><span data-stu-id="e0c9c-384">Adding the Remaining TableAdapters</span></span>

<span data-ttu-id="e0c9c-385">Až dosud podívali jsme se jenom na práci s jeden TableAdapter pro izolovanou databázi tabulku.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-385">Up until now, we've only looked at working with a single TableAdapter for a single database table.</span></span> <span data-ttu-id="e0c9c-386">Databáze Northwind však obsahuje několik související tabulky, které budeme potřebovat pro práci s naší webové aplikaci.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-386">However, the Northwind database contains several related tables that we'll need to work with in our web application.</span></span> <span data-ttu-id="e0c9c-387">Typované datové sady mohou obsahovat více souvisejících DataTables.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-387">A Typed DataSet can contain multiple, related DataTables.</span></span> <span data-ttu-id="e0c9c-388">Proto k dokončení našich DAL potřebujeme přidat DataTables pro tabulky, které budeme používat v těchto kurzech.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-388">Therefore, to complete our DAL we need to add DataTables for the other tables we'll be using in these tutorials.</span></span> <span data-ttu-id="e0c9c-389">Přidání nového TableAdapter k datové sadě zadán, otevřete návrhář datových sad, klikněte pravým tlačítkem myši v návrháři a zvolte Přidat / TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-389">To add a new TableAdapter to a Typed DataSet, open the DataSet Designer, right-click in the Designer, and choose Add / TableAdapter.</span></span> <span data-ttu-id="e0c9c-390">To vytvoří nový objekt DataTable a TableAdapter a průvodce, který jsme se zaměřili dříve v tomto kurzu vás provedou.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-390">This will create a new DataTable and TableAdapter and walk you through the wizard we examined earlier in this tutorial.</span></span>

<span data-ttu-id="e0c9c-391">Trvat pár minut vytvořit následující objekty TableAdapter a metod pomocí následující dotazy.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-391">Take a few minutes to create the following TableAdapters and methods using the following queries.</span></span> <span data-ttu-id="e0c9c-392">Všimněte si, že dotazy v **ProductsTableAdapter** zahrnují poddotazy a zkopírujte názvy kategorií a dodavatele každého produktu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-392">Note that the queries in the **ProductsTableAdapter** include the subqueries to grab each product's category and supplier names.</span></span> <span data-ttu-id="e0c9c-393">Kromě toho, pokud jste postupovali podle, jste už přidali **ProductsTableAdapter** třídy **GetProducts()** a **GetProductsByCategoryID (*ID kategorie* )** metody.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-393">Additionally, if you've been following along, you've already added the **ProductsTableAdapter** class's **GetProducts()** and **GetProductsByCategoryID(*categoryID*)** methods.</span></span>

- <span data-ttu-id="e0c9c-394">**ProductsTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="e0c9c-394">**ProductsTableAdapter**</span></span>

  - <span data-ttu-id="e0c9c-395">**GetProducts**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-395">**GetProducts**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample10.sql)]
  - <span data-ttu-id="e0c9c-396">**GetProductsByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-396">**GetProductsByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample11.sql)]
  - <span data-ttu-id="e0c9c-397">**GetProductsBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-397">**GetProductsBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample12.sql)]
  - <span data-ttu-id="e0c9c-398">**GetProductByProductID**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-398">**GetProductByProductID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample13.sql)]
- <span data-ttu-id="e0c9c-399">**CategoriesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="e0c9c-399">**CategoriesTableAdapter**</span></span>

  - <span data-ttu-id="e0c9c-400">**GetCategories**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-400">**GetCategories**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample14.sql)]
  - <span data-ttu-id="e0c9c-401">**GetCategoryByCategoryID**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-401">**GetCategoryByCategoryID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample15.sql)]
- <span data-ttu-id="e0c9c-402">**SuppliersTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="e0c9c-402">**SuppliersTableAdapter**</span></span>

  - <span data-ttu-id="e0c9c-403">**GetSuppliers**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-403">**GetSuppliers**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample16.sql)]
  - <span data-ttu-id="e0c9c-404">**GetSuppliersByCountry**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-404">**GetSuppliersByCountry**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample17.sql)]
  - <span data-ttu-id="e0c9c-405">**GetSupplierBySupplierID**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-405">**GetSupplierBySupplierID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample18.sql)]
- <span data-ttu-id="e0c9c-406">**EmployeesTableAdapter**</span><span class="sxs-lookup"><span data-stu-id="e0c9c-406">**EmployeesTableAdapter**</span></span>

  - <span data-ttu-id="e0c9c-407">**GetEmployees**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-407">**GetEmployees**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample19.sql)]
  - <span data-ttu-id="e0c9c-408">**GetEmployeesByManager**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-408">**GetEmployeesByManager**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample20.sql)]
  - <span data-ttu-id="e0c9c-409">**GetEmployeeByEmployeeID**:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-409">**GetEmployeeByEmployeeID**:</span></span> 

      [!code-sql[Main](creating-a-data-access-layer-cs/samples/sample21.sql)]


<span data-ttu-id="e0c9c-410">[![Návrhář DataSet po přidání čtyři objekty TableAdapter](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-410">[![The DataSet Designer After the Four TableAdapters Have Been Added](creating-a-data-access-layer-cs/_static/image84.png)](creating-a-data-access-layer-cs/_static/image83.png)</span></span>

<span data-ttu-id="e0c9c-411">**Obrázek 31**: The datovou sadu návrháře po the čtyři objekty TableAdapter jsou přidané ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image85.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-411">**Figure 31**: The DataSet Designer After the Four TableAdapters Have Been Added ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image85.png))</span></span>


## <a name="adding-custom-code-to-the-dal"></a><span data-ttu-id="e0c9c-412">Přidání vlastního kódu vrstvy Dal</span><span class="sxs-lookup"><span data-stu-id="e0c9c-412">Adding Custom Code to the DAL</span></span>

<span data-ttu-id="e0c9c-413">Objekty TableAdapter a přidat k datové sadě zadán DataTables jsou vyjádřeny jako soubor XML Schema Definition (**Northwind.xsd**).</span><span class="sxs-lookup"><span data-stu-id="e0c9c-413">The TableAdapters and DataTables added to the Typed DataSet are expressed as an XML Schema Definition file (**Northwind.xsd**).</span></span> <span data-ttu-id="e0c9c-414">Tyto informace schématu můžete zobrazit kliknutím pravým tlačítkem na **Northwind.xsd** souboru v Průzkumníku řešení a zvolíte zobrazení kódu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-414">You can view this schema information by right-clicking on the **Northwind.xsd** file in the Solution Explorer and choosing View Code.</span></span>


<span data-ttu-id="e0c9c-415">[![Soubor definice (XSD) schématu XML pro Lhota zadaná datová sada](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-415">[![The XML Schema Definition (XSD) File for the Northwinds Typed DataSet](creating-a-data-access-layer-cs/_static/image87.png)](creating-a-data-access-layer-cs/_static/image86.png)</span></span>

<span data-ttu-id="e0c9c-416">**Obrázek 32**: soubor definice schématu XML (XSD) pro typová Lhota ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image88.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-416">**Figure 32**: The XML Schema Definition (XSD) File for the Northwinds Typed DataSet ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image88.png))</span></span>


<span data-ttu-id="e0c9c-417">Tyto informace schématu je přeložit do kódu jazyka C# nebo Visual Basic v době návrhu při kompilaci nebo za běhu (v případě potřeby), v tomto okamžiku můžete krokovat přes něj s ladicím programem.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-417">This schema information is translated into C# or Visual Basic code at design time when compiled or at runtime (if needed), at which point you can step through it with the debugger.</span></span> <span data-ttu-id="e0c9c-418">Chcete-li zobrazit tento automaticky generovaný kód přejděte na zobrazení tříd a zotavení po havárii na třídy TableAdapter nebo typované datové sady.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-418">To view this auto-generated code go to the Class View and drill down to the TableAdapter or Typed DataSet classes.</span></span> <span data-ttu-id="e0c9c-419">Pokud nevidíte zobrazení tříd na obrazovce, přejděte do nabídky zobrazení a vyberte ho z něj nebo stiskněte kombinaci kláves Ctrl + Shift + C.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-419">If you don't see the Class View on your screen, go to the View menu and select it from there, or hit Ctrl+Shift+C.</span></span> <span data-ttu-id="e0c9c-420">V zobrazení tříd můžete zobrazit vlastnosti, metody a události tříd typované datové sady a TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-420">From the Class View you can see the properties, methods, and events of the Typed DataSet and TableAdapter classes.</span></span> <span data-ttu-id="e0c9c-421">Chcete-li zobrazit kód pro konkrétní metody, dvakrát klikněte na název metody v zobrazení tříd nebo klikněte pravým tlačítkem myši na něj a možnost Přejít na definici.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-421">To view the code for a particular method, double-click the method name in the Class View or right-click on it and choose Go To Definition.</span></span>


![Prozkoumejte automaticky generovaný kód tak, že vyberete přejít k definici zobrazení tříd](creating-a-data-access-layer-cs/_static/image89.png)

<span data-ttu-id="e0c9c-423">**Obrázek 33**: Zkontrolujte automaticky generovaný kód tak, že vyberete přejít k definici zobrazení tříd</span><span class="sxs-lookup"><span data-stu-id="e0c9c-423">**Figure 33**: Inspect the Auto-Generated Code by Selecting Go To Definition from the Class View</span></span>


<span data-ttu-id="e0c9c-424">Automaticky generovaný kód mohou být spoustu skvělých času, kód je často velmi obecná a je třeba přizpůsobit podle jedinečných potřeb aplikace.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-424">While auto-generated code can be a great time saver, the code is often very generic and needs to be customized to meet the unique needs of an application.</span></span> <span data-ttu-id="e0c9c-425">Riziko rozšíření automaticky generovaný kód, ale je, že nástroj, který vygeneruje kód rozhodnout, že je čas na "obnovit" a přepsat vaše vlastní nastavení.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-425">The risk of extending auto-generated code, though, is that the tool that generated the code might decide it's time to "regenerate" and overwrite your customizations.</span></span> <span data-ttu-id="e0c9c-426">Pomocí rozhraní .NET 2.0 nový koncept částečné třídy je snadné rozdělení třídy do více souborů.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-426">With .NET 2.0's new partial class concept, it's easy to split a class across multiple files.</span></span> <span data-ttu-id="e0c9c-427">Umožňuje nám to přidat vlastní metody, vlastnosti a události na automaticky generované třídy bez nutnosti starat o přepsání naše přizpůsobení sady Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-427">This enables us to add our own methods, properties, and events to the auto-generated classes without having to worry about Visual Studio overwriting our customizations.</span></span>

<span data-ttu-id="e0c9c-428">Abychom si předvedli, jak přizpůsobit DAL, přidáme **GetProducts()** metodu **SuppliersRow** třídy.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-428">To demonstrate how to customize the DAL, let's add a **GetProducts()** method to the **SuppliersRow** class.</span></span> <span data-ttu-id="e0c9c-429">**SuppliersRow** třída představuje jeden záznam v **Dodavatelé** tabulky; každý poskytovatel může dodavatele nula řada produktů, tak **GetProducts()** ty vrátí produkty zadané dodavatele.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-429">The **SuppliersRow** class represents a single record in the **Suppliers** table; each supplier can provider zero to many products, so **GetProducts()** will return those products of the specified supplier.</span></span> <span data-ttu-id="e0c9c-430">Provedete to vytvořte nový soubor třídy v **aplikace\_kód** složku s názvem **SuppliersRow.cs** a přidejte následující kód:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-430">To accomplish this create a new class file in the **App\_Code** folder named **SuppliersRow.cs** and add the following code:</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample22.cs)]

<span data-ttu-id="e0c9c-431">Tato částečná třída instruuje kompilátor, že sestavení **Northwind.SuppliersRow** třídy, aby obsahoval **GetProducts()** metoda jsme definovali.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-431">This partial class instructs the compiler that when building the **Northwind.SuppliersRow** class to include the **GetProducts()** method we just defined.</span></span> <span data-ttu-id="e0c9c-432">Pokud svůj projekt sestavit a pak se vraťte k zobrazení tříd uvidíte **GetProducts()** teď uvedená jako metoda **Northwind.SuppliersRow**.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-432">If you build your project and then return to the Class View you'll see **GetProducts()** now listed as a method of **Northwind.SuppliersRow**.</span></span>


![Metoda GetProducts() je teď součástí Northwind.SuppliersRow třídy](creating-a-data-access-layer-cs/_static/image90.png)

<span data-ttu-id="e0c9c-434">**Obrázek 34**: **GetProducts()** metoda je nyní součástí **Northwind.SuppliersRow** třídy</span><span class="sxs-lookup"><span data-stu-id="e0c9c-434">**Figure 34**: The **GetProducts()** Method is Now Part of the **Northwind.SuppliersRow** Class</span></span>


<span data-ttu-id="e0c9c-435">**GetProducts()** metoda je nyní možné výčet sadu produktů pro konkrétní dodavatele, jak ukazuje následující kód:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-435">The **GetProducts()** method can now be used to enumerate the set of products for a particular supplier, as the following code shows:</span></span>

[!code-html[Main](creating-a-data-access-layer-cs/samples/sample23.html)]

<span data-ttu-id="e0c9c-436">Tato data lze také zobrazit v libovolném prostředí ASP. Data společnosti NET webové ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-436">This data can also be displayed in any of ASP.NET's data Web controls.</span></span> <span data-ttu-id="e0c9c-437">Na následující stránce používá ovládací prvek GridView s dvě pole:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-437">The following page uses a GridView control with two fields:</span></span>

- <span data-ttu-id="e0c9c-438">Vlastnost BoundField, která zobrazuje název každého dodavatele a</span><span class="sxs-lookup"><span data-stu-id="e0c9c-438">A BoundField that displays the name of each supplier, and</span></span>
- <span data-ttu-id="e0c9c-439">TemplateField obsahuje BulletedList ovládací prvek, který je vázán na výsledky vrácené **GetProducts()** metodu pro každého dodavatele.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-439">A TemplateField that contains a BulletedList control that is bound to the results returned by the **GetProducts()** method for each supplier.</span></span>

<span data-ttu-id="e0c9c-440">Prozkoumáme jak zobrazit tyto hlavní podrobnosti zprávy v budoucích kurzech.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-440">We'll examine how to display such master-detail reports in future tutorials.</span></span> <span data-ttu-id="e0c9c-441">Prozatím se v tomto příkladu je navržená pro ilustraci pomocí vlastní metody přidat do **Northwind.SuppliersRow** třídy.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-441">For now, this example is designed to illustrate using the custom method added to the **Northwind.SuppliersRow** class.</span></span>

<span data-ttu-id="e0c9c-442">SuppliersAndProducts.aspx</span><span class="sxs-lookup"><span data-stu-id="e0c9c-442">SuppliersAndProducts.aspx</span></span>

[!code-aspx[Main](creating-a-data-access-layer-cs/samples/sample24.aspx)]

<span data-ttu-id="e0c9c-443">SuppliersAndProducts.aspx.cs</span><span class="sxs-lookup"><span data-stu-id="e0c9c-443">SuppliersAndProducts.aspx.cs</span></span>

[!code-csharp[Main](creating-a-data-access-layer-cs/samples/sample25.cs)]


<span data-ttu-id="e0c9c-444">[![Název společnosti dodavatele je uvedena ve sloupci vlevo, jejich produkty vpravo](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-444">[![The Supplier's Company Name is Listed in the Left Column, Their Products in the Right](creating-a-data-access-layer-cs/_static/image92.png)](creating-a-data-access-layer-cs/_static/image91.png)</span></span>

<span data-ttu-id="e0c9c-445">**Obrázek 35**: název společnosti dodavatele je uvedena ve sloupci vlevo, jejich produktů v pravém ([kliknutím ji zobrazíte obrázek v plné velikosti](creating-a-data-access-layer-cs/_static/image93.png))</span><span class="sxs-lookup"><span data-stu-id="e0c9c-445">**Figure 35**: The Supplier's Company Name is Listed in the Left Column, Their Products in the Right ([Click to view full-size image](creating-a-data-access-layer-cs/_static/image93.png))</span></span>


## <a name="summary"></a><span data-ttu-id="e0c9c-446">Souhrn</span><span class="sxs-lookup"><span data-stu-id="e0c9c-446">Summary</span></span>

<span data-ttu-id="e0c9c-447">Při vytváření webové aplikace vytváří DAL by měl být jeden z první krůčky, tím, než začnete vytvářet prezentační vrstvy.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-447">When building a web application creating the DAL should be one of your first steps, occurring before you start creating your presentation layer.</span></span> <span data-ttu-id="e0c9c-448">Pomocí sady Visual Studio vytvoření DAL podle zadané datové sady je úkol, který lze provést v 10 až 15 minut bez nutnosti psaní jediného řádku kódu.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-448">With Visual Studio, creating a DAL based on Typed DataSets is a task that can be accomplished in 10-15 minutes without writing a line of code.</span></span> <span data-ttu-id="e0c9c-449">Kurzy v budoucnu budou vycházejí z této vrstvy DAL.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-449">The tutorials moving forward will build upon this DAL.</span></span> <span data-ttu-id="e0c9c-450">V [další kurz](creating-a-business-logic-layer-cs.md) vytvoříme určit řadu obchodních pravidel a zjistit, jak je implementovat v samostatné vrstvy obchodní logiky.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-450">In the [next tutorial](creating-a-business-logic-layer-cs.md) we'll define a number of business rules and see how to implement them in a separate Business Logic Layer.</span></span>

<span data-ttu-id="e0c9c-451">Všechno nejlepší programování!</span><span class="sxs-lookup"><span data-stu-id="e0c9c-451">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="e0c9c-452">Další čtení</span><span class="sxs-lookup"><span data-stu-id="e0c9c-452">Further Reading</span></span>

<span data-ttu-id="e0c9c-453">Další informace o tématech, které jsou popsané v tomto kurzu najdete na následujících odkazech:</span><span class="sxs-lookup"><span data-stu-id="e0c9c-453">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e0c9c-454">Vytváření DAL pomocí silně typované objekty TableAdapter a DataTables ve VS 2005 a technologii ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="e0c9c-454">Building a DAL using Strongly Typed TableAdapters and DataTables in VS 2005 and ASP.NET 2.0</span></span>](https://weblogs.asp.net/scottgu/435498)
- [<span data-ttu-id="e0c9c-455">Navrhování komponenty datové vrstvy a předávání dat prostřednictvím vrstev</span><span class="sxs-lookup"><span data-stu-id="e0c9c-455">Designing Data Tier Components and Passing Data Through Tiers</span></span>](https://msdn.microsoft.com/library/ms978496.aspx)
- [<span data-ttu-id="e0c9c-456">Vytvoření vrstvy přístupu k datům s návrháři datové sady Visual Studio 2005</span><span class="sxs-lookup"><span data-stu-id="e0c9c-456">Build a Data Access Layer with the Visual Studio 2005 DataSet Designer</span></span>](http://www.theserverside.net/articles/showarticle.tss?id=DataSetDesigner)
- [<span data-ttu-id="e0c9c-457">Informace o konfiguraci v technologii ASP.NET 2.0 šifrování aplikací</span><span class="sxs-lookup"><span data-stu-id="e0c9c-457">Encrypting Configuration Information in ASP.NET 2.0 Applications</span></span>](http://aspnet.4guysfromrolla.com/articles/021506-1.aspx)
- [<span data-ttu-id="e0c9c-458">TableAdapter – přehled</span><span class="sxs-lookup"><span data-stu-id="e0c9c-458">TableAdapter Overview</span></span>](https://msdn.microsoft.com/library/bz9tthwx.aspx)
- [<span data-ttu-id="e0c9c-459">Práce s typové datové sady</span><span class="sxs-lookup"><span data-stu-id="e0c9c-459">Working with a Typed DataSet</span></span>](https://msdn.microsoft.com/library/esbykkzb.aspx)
- [<span data-ttu-id="e0c9c-460">Pomocí přístupu k datům silného typu v sadě Visual Studio 2005 a technologií ASP.NET 2.0</span><span class="sxs-lookup"><span data-stu-id="e0c9c-460">Using Strongly-Typed Data Access in Visual Studio 2005 and ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/020806-1.aspx)
- [<span data-ttu-id="e0c9c-461">Postup rozšíření metody třídy TableAdapter</span><span class="sxs-lookup"><span data-stu-id="e0c9c-461">How to Extend TableAdapter Methods</span></span>](https://blogs.msdn.com/vbteam/archive/2005/05/04/ExtendingTableAdapters.aspx)
- [<span data-ttu-id="e0c9c-462">Načítání dat skalární z uložené procedury</span><span class="sxs-lookup"><span data-stu-id="e0c9c-462">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="e0c9c-463">Video od Pluralsightu na témata, které jsou obsažené v tomto kurzu</span><span class="sxs-lookup"><span data-stu-id="e0c9c-463">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="e0c9c-464">Vrstvy přístupu k datům v aplikacích ASP.NET</span><span class="sxs-lookup"><span data-stu-id="e0c9c-464">Data Access Layers in ASP.NET Applications</span></span>](../../../videos/data-access/adonet-data-services/data-access-layers-in-aspnet-applications.md)
- [<span data-ttu-id="e0c9c-465">Postup ruční svázání datové sady s mřížkou DataGrid</span><span class="sxs-lookup"><span data-stu-id="e0c9c-465">How to Manually Bind a Dataset to a Datagrid</span></span>](../../../videos/data-access/adonet-data-services/how-to-manually-bind-a-dataset-to-a-datagrid.md)
- [<span data-ttu-id="e0c9c-466">Postup práce s datovými sadami a filtry z aplikace ASP</span><span class="sxs-lookup"><span data-stu-id="e0c9c-466">How to Work with Datasets and Filters from an ASP Application</span></span>](../../../videos/data-access/adonet-data-services/how-to-work-with-datasets-and-filters-from-an-asp-application.md)

## <a name="about-the-author"></a><span data-ttu-id="e0c9c-467">O autorovi</span><span class="sxs-lookup"><span data-stu-id="e0c9c-467">About the Author</span></span>

<span data-ttu-id="e0c9c-468">[Scott Meisnerová](http://www.4guysfromrolla.com/ScottMitchell.shtml), Autor sedm ASP/ASP.NET knih a Zakladatel [4GuysFromRolla.com](http://www.4guysfromrolla.com), má práce s Microsoft webových technologiích od roku 1998.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-468">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e0c9c-469">Scott funguje jako nezávislý konzultant, trainer a zapisovače.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-469">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e0c9c-470">Jeho nejnovější knihy [ *Edice nakladatelství Sams naučit sami ASP.NET 2.0 za 24 hodin*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e0c9c-470">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e0c9c-471">Může být dosáhl v [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-471">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="e0c9c-472">nebo prostřednictvím jeho blogu, který lze nalézt v [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e0c9c-472">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="e0c9c-473">Speciální k</span><span class="sxs-lookup"><span data-stu-id="e0c9c-473">Special Thanks To</span></span>

<span data-ttu-id="e0c9c-474">V této sérii kurzů byl recenzován uživatelem mnoho užitečných revidující.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-474">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e0c9c-475">Vedoucí revidující pro účely tohoto kurzu byly Ron zelená, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez a Santos Carlose.</span><span class="sxs-lookup"><span data-stu-id="e0c9c-475">Lead reviewers for this tutorial were Ron Green, Hilton Giesenow, Dennis Patterson, Liz Shulok, Abel Gomez, and Carlos Santos.</span></span> <span data-ttu-id="e0c9c-476">Zajímat téma Moje nadcházejících článcích MSDN?</span><span class="sxs-lookup"><span data-stu-id="e0c9c-476">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e0c9c-477">Pokud ano, vyřaďte mě řádek na [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e0c9c-477">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="e0c9c-478">Next</span><span class="sxs-lookup"><span data-stu-id="e0c9c-478">Next</span></span>](creating-a-business-logic-layer-cs.md)
