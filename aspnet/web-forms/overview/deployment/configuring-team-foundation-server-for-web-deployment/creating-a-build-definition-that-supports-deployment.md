---
uid: web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment
title: Vytvoření definice sestavení, která podporuje nasazení | Dokumentace Microsoftu
author: jrjlee
description: Pokud chcete provádět jakékoliv sestavení v Team Foundation Server (TFS) 2010, musíte vytvořit definici sestavení v rámci týmového projektu. Toto téma des...
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: fe47a018-f6d0-4979-80e7-5b1fa75a5865
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/deployment/configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment
msc.type: authoredcontent
ms.openlocfilehash: d0220ee5c7c066d107311c1235949cec5049cc27
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/03/2018
ms.locfileid: "37370280"
---
<a name="creating-a-build-definition-that-supports-deployment"></a><span data-ttu-id="2ebd8-104">Vytvoření definice sestavení, která podporuje nasazení</span><span class="sxs-lookup"><span data-stu-id="2ebd8-104">Creating a Build Definition That Supports Deployment</span></span>
====================
<span data-ttu-id="2ebd8-105">podle [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="2ebd8-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="2ebd8-106">Stáhnout PDF</span><span class="sxs-lookup"><span data-stu-id="2ebd8-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="2ebd8-107">Pokud chcete provádět jakékoliv sestavení v Team Foundation Server (TFS) 2010, musíte vytvořit definici sestavení v rámci týmového projektu.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-107">If you want to perform any kind of build in Team Foundation Server (TFS) 2010, you need to create a build definition within your team project.</span></span> <span data-ttu-id="2ebd8-108">Toto téma popisuje postup vytvoření nové definice sestavení v TFS a řízení nasazení webu jako součást procesu sestavení v Team Build.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-108">This topic describes how to create a new build definition in TFS and how to control web deployment as part of the build process in Team Build.</span></span>


<span data-ttu-id="2ebd8-109">Toto téma je součástí série kurzů podle požadavků na nasazení enterprise fiktivní společnosti s názvem společnosti Fabrikam, Inc. V této sérii kurzů používá ukázkové řešení&#x2014; [řešení Správce kontaktů](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;představující webovou aplikaci s realistické úroveň složitosti, včetně aplikace ASP.NET MVC 3, komunikace Windows Služba Foundation (WCF) a databázový projekt.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-109">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="2ebd8-110">Metody nasazení v srdci těchto kurzů je založen na rozdělení přístupu soubor projektu je popsáno v [vysvětlení souboru projektu](../web-deployment-in-the-enterprise/understanding-the-project-file.md), ve kterém je řízena procesem sestavení a nasazení dva soubory projektu&#x2014;jeden obsahuje pokyny pro sestavení, které platí pro všechny cílové prostředí a jeden obsahuje nastavení pro konkrétní prostředí sestavení a nasazení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-110">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build and deployment process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="2ebd8-111">V okamžiku sestavení souboru projektu specifických pro prostředí se sloučí do souboru projektu bez ohledu na prostředí a vytvoří kompletní sadu pokynů sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-111">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="2ebd8-112">Přehled úloh</span><span class="sxs-lookup"><span data-stu-id="2ebd8-112">Task Overview</span></span>

<span data-ttu-id="2ebd8-113">Definice sestavení je mechanismus, který řídí, jak a kdy dojde k sestavení pro týmové projekty v sadě TFS.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-113">A build definition is the mechanism that controls how and when builds occur for team projects in TFS.</span></span> <span data-ttu-id="2ebd8-114">Každá definice sestavení určuje:</span><span class="sxs-lookup"><span data-stu-id="2ebd8-114">Each build definition specifies:</span></span>

- <span data-ttu-id="2ebd8-115">Věci, které mají být sestaveny jako soubory řešení sady Visual Studio nebo vlastních souborů projektu Microsoft Build Engine (MSBuild).</span><span class="sxs-lookup"><span data-stu-id="2ebd8-115">The things you want to build, like Visual Studio solution files or custom Microsoft Build Engine (MSBuild) project files.</span></span>
- <span data-ttu-id="2ebd8-116">Kritéria určující, když by neměl zabrat sestavení umístit, jako je ruční triggery, kontinuální integrace (CI), nebo hlídané vrácení se změnami se.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-116">The criteria that determine when a build should take place, like manual triggers, continuous integration (CI), or gated check-ins.</span></span>
- <span data-ttu-id="2ebd8-117">Umístění, ke kterému má Team Build odeslat výstupy sestavení, včetně nasazení artefakty stejně jako webových balíčků a databázové skripty.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-117">The location to which Team Build should send build outputs, including deployment artifacts like web packages and database scripts.</span></span>
- <span data-ttu-id="2ebd8-118">Množství času, který by měl být zachován každého sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-118">The amount of time that each build should be retained.</span></span>
- <span data-ttu-id="2ebd8-119">Různé další parametry procesu sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-119">Various other parameters of the build process.</span></span>

> [!NOTE]
> <span data-ttu-id="2ebd8-120">Další informace o definicích sestavení naleznete v tématu [definovat svůj proces sestavení](https://msdn.microsoft.com/library/ms181715.aspx).</span><span class="sxs-lookup"><span data-stu-id="2ebd8-120">For more information on build definitions, see [Define Your Build Process](https://msdn.microsoft.com/library/ms181715.aspx).</span></span>


<span data-ttu-id="2ebd8-121">Toto téma se ukazují, jak vytvořit definici sestavení, která používá CI, tak, aby sestavení se aktivuje, když vývojář vrátí nový obsah.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-121">This topic will show you how to create a build definition that uses CI, so that a build is triggered when a developer checks in new content.</span></span> <span data-ttu-id="2ebd8-122">Pokud byl sestaven úspěšně, sestavovací služba spustí soubor vlastní projekt k nasazení řešení do testovacího prostředí.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-122">If the build succeeds, the build service runs a custom project file to deploy the solution to a test environment.</span></span>

<span data-ttu-id="2ebd8-123">Po aktivaci sestavení, třeba dojít tyto akce:</span><span class="sxs-lookup"><span data-stu-id="2ebd8-123">When you trigger a build, these actions need to happen:</span></span>

- <span data-ttu-id="2ebd8-124">Nejprve Team Build má sestavit řešení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-124">First, Team Build should build the solution.</span></span> <span data-ttu-id="2ebd8-125">V rámci tohoto procesu se vyvolá Team Build Web publikování kanálu (WPP) ke generování balíčky nasazení webu pro jednotlivé projekty webových aplikací v řešení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-125">As part of this process, Team Build will invoke the Web Publishing Pipeline (WPP) to generate web deployment packages for each of the web application projects in the solution.</span></span> <span data-ttu-id="2ebd8-126">Sestavení týmu také spustí všechny testy jednotek, které jsou přidružené k řešení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-126">Team Build will also run any unit tests associated with the solution.</span></span>
- <span data-ttu-id="2ebd8-127">Pokud se nezdaří sestavení řešení, sestavení týmu by neměl zabrat žádná další akce.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-127">If the solution build fails, Team Build should take no further action.</span></span> <span data-ttu-id="2ebd8-128">Selhání testu jednotky by měl být považován za selhání sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-128">Unit test failures should be treated as a build failure.</span></span>
- <span data-ttu-id="2ebd8-129">Pokud bude úspěšné sestavení řešení, by měl Team Build spusťte soubor vlastní projekt, který řídí nasazení řešení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-129">If the solution build succeeds, Team Build should run the custom project file that controls the deployment of the solution.</span></span> <span data-ttu-id="2ebd8-130">Jako součást tohoto procesu Team Build se vyvolá Internetové informační služby (IIS) nástroj pro nasazení webu (nasazení webu) k instalaci zabalené webové aplikace na cílové webové servery a vyvolá nástroj VSDBCMD.exe ke spuštění vytvoření databáze skripty na cílových serverech databáze.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-130">As part of this process, Team Build will invoke the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to install the packaged web applications on the destination web servers, and it will invoke the VSDBCMD.exe utility to run database creation scripts on the destination database servers.</span></span>

<span data-ttu-id="2ebd8-131">To je znázorněn proces:</span><span class="sxs-lookup"><span data-stu-id="2ebd8-131">This illustrates the process:</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image1.png)

<span data-ttu-id="2ebd8-132">[Správce kontaktů](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) ukázkové řešení obsahuje vlastní soubor projektu MSBuild *Publish.proj*, který můžete spustit z nástroje MSBuild nebo Team Build.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-132">The [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution includes a custom MSBuild project file, *Publish.proj*, that you can run from MSBuild or Team Build.</span></span> <span data-ttu-id="2ebd8-133">Jak je popsáno v [Principy procesu sestavení](../web-deployment-in-the-enterprise/understanding-the-build-process.md), tento soubor projektu definuje logiku, která nasadí webových balíčků a databáze do cílové prostředí.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-133">As described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), this project file defines the logic that deploys your web packages and databases to a target environment.</span></span> <span data-ttu-id="2ebd8-134">Soubor obsahuje logiku, která vynechává sestavení a procesem vytváření balíčku, pokud běží ve službě Team Build, byste museli opustit jenom nasazení úlohy pro spuštění.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-134">The file includes logic that omits the building and packaging process if it's running in Team Build, leaving just the deployment tasks to run.</span></span> <span data-ttu-id="2ebd8-135">Toto je vzhledem k tomu, že při automatizaci nasazení tímto způsobem je obvykle vhodné zajistit, že řešení je sestaveno úspěšně a předává všechny testy jednotek, před zahájením procesu nasazení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-135">This is because when you automate deployment in this way, you'll typically want to ensure that the solution builds successfully and passes any unit tests before the deployment process commences.</span></span>

<span data-ttu-id="2ebd8-136">Další části je vysvětlen postup implementace tohoto procesu tak, že vytvoříte novou definici sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-136">The next section explains how to implement this process by creating a new build definition.</span></span>

> [!NOTE]
> <span data-ttu-id="2ebd8-137">Tento postup&#x2014;ve kterém automatizované jeden proces sestavení, testy a nasadí řešení&#x2014;by mohla být nejvhodnější pro nasazení pro testovací prostředí.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-137">This procedure&#x2014;in which a single automated process builds, tests, and deploys a solution&#x2014;is likely to be most suited to deployment to test environments.</span></span> <span data-ttu-id="2ebd8-138">Pro testovací a produkční prostředí budete pravděpodobně mnohem více chcete nasadit obsah z předchozího buildu, který jste již ověření a ověření v testovacím prostředí.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-138">For staging and production environments you're a lot more likely to want to deploy content from a previous build that you've already verified and validated in a test environment.</span></span> <span data-ttu-id="2ebd8-139">Tento postup je popsaný v dalším tématu [nasazení konkrétního sestavení](deploying-a-specific-build.md).</span><span class="sxs-lookup"><span data-stu-id="2ebd8-139">This approach is described in the next topic, [Deploying a Specific Build](deploying-a-specific-build.md).</span></span>


### <a name="who-performs-this-procedure"></a><span data-ttu-id="2ebd8-140">Kdo provádí tento postup?</span><span class="sxs-lookup"><span data-stu-id="2ebd8-140">Who Performs This Procedure?</span></span>

<span data-ttu-id="2ebd8-141">Obvykle provádí správce serveru TFS tento postup.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-141">Typically, a TFS administrator performs this procedure.</span></span> <span data-ttu-id="2ebd8-142">V některých případech může vedoucí týmu pro vývojáře nést odpovědnost za kolekci týmových projektů v TFS.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-142">In some cases, a developer team leader may take responsibility for the team project collection in TFS.</span></span> <span data-ttu-id="2ebd8-143">Chcete-li vytvořit novou definici sestavení, musíte být členem skupiny **správci sestavení kolekcí projektů** pro kolekci týmového projektu, který obsahuje vaše řešení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-143">In order to create a new build definition, you need to be a member of the **Project Collection Build Administrators** group for the team project collection that contains your solution.</span></span>

## <a name="create-a-build-definition-for-ci-and-deployment"></a><span data-ttu-id="2ebd8-144">Vytvořte definici sestavení CI a nasazení</span><span class="sxs-lookup"><span data-stu-id="2ebd8-144">Create a Build Definition for CI and Deployment</span></span>

<span data-ttu-id="2ebd8-145">Následující postup popisuje, jak vytvořit definici sestavení, která aktivuje CI.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-145">The next procedure describes how to create a build definition that CI triggers.</span></span> <span data-ttu-id="2ebd8-146">Pokud byl sestaven úspěšně, je řešení nasadit s použitím logiku vlastního souboru projektu MSBuild.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-146">If the build succeeds, the solution is deployed using the logic in a custom MSBuild project file.</span></span>

<span data-ttu-id="2ebd8-147">**Chcete-li vytvořit definici sestavení CI a nasazení**</span><span class="sxs-lookup"><span data-stu-id="2ebd8-147">**To create a build definition for CI and deployment**</span></span>

1. <span data-ttu-id="2ebd8-148">V sadě Visual Studio 2010 v **Team Exploreru** okna, rozbalte uzel týmového projektu, klikněte pravým tlačítkem na **sestavení**a potom klikněte na tlačítko **nová definice sestavení**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-148">In Visual Studio 2010, in the **Team Explorer** window, expand your team project node, right-click **Builds**, and then click **New Build Definition**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image2.png)
2. <span data-ttu-id="2ebd8-149">Na **Obecné** kartu, zadejte název definice sestavení (například **DeployToTest**) a volitelně také popis.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-149">On the **General** tab, give the build definition a name (for example, **DeployToTest**) and an optional description.</span></span>
3. <span data-ttu-id="2ebd8-150">Na **aktivační událost** kartu, vyberte kritéria, na kterých chcete aktivovat nový build.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-150">On the **Trigger** tab, select the criteria on which you want to trigger a new build.</span></span> <span data-ttu-id="2ebd8-151">Pokud například chcete řešení sestavit a nasadit do testovacího prostředí, pokaždé, když vývojář vrátí nový kód, vyberte **kontinuální integrace**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-151">For example, if you want to build the solution and deploy to the test environment every time a developer checks in new code, select **Continuous Integration**.</span></span>
4. <span data-ttu-id="2ebd8-152">Na **výchozí hodnoty sestavení** kartě **Kopírovat výstup sestavení na následující odkládací složky** zadejte cestu (Universal Naming Convention) odkládací složky (například  **\\TFSBUILD\Drops**).</span><span class="sxs-lookup"><span data-stu-id="2ebd8-152">On the **Build Defaults** tab, in the **Copy build output to the following drop folder** box, type the Universal Naming Convention (UNC) path of your drop folder (for example, **\\TFSBUILD\Drops**).</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image3.png)

    > [!NOTE]
    > <span data-ttu-id="2ebd8-153">Toto umístění přetažení ukládá několik sestavení, v závislosti na vámi nakonfigurovaných zásad uchovávání informací.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-153">This drop location stores several builds, depending on the retention policy you configure.</span></span> <span data-ttu-id="2ebd8-154">Když chcete publikovat artefakty nasazení z konkrétního sestavení pro testovací nebo produkční prostředí, je to, kde najdete ho.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-154">When you want to publish deployment artifacts from a specific build to a staging or production environment, this is where you'll find them.</span></span>
5. <span data-ttu-id="2ebd8-155">Na **procesu** kartě **soubor procesu sestavení** rozevíracího seznamu, ponechejte tuto položku **DefaultTemplate.xaml** vybrané.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-155">On the **Process** tab, in the **Build process file** dropdown list, leave **DefaultTemplate.xaml** selected.</span></span> <span data-ttu-id="2ebd8-156">Toto je jedna z výchozích šablon procesů sestavení, které se přidají do všech nových týmových projektů.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-156">This is one of the default build process templates that get added to all new team projects.</span></span>
6. <span data-ttu-id="2ebd8-157">V **parametry procesu sestavení** tabulku, klikněte na tlačítko v **položky k sestavení** řádku a potom klikněte na tlačítko **tlačítko se třemi tečkami** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-157">In the **Build process parameters** table, click in the **Items to Build** row, and then click the **ellipsis** button.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image4.png)
7. <span data-ttu-id="2ebd8-158">V **položky k sestavení** dialogové okno, klikněte na tlačítko **přidat**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-158">In the **Items to Build** dialog box, click **Add**.</span></span>
8. <span data-ttu-id="2ebd8-159">Přejděte do umístění souboru řešení a potom klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-159">Browse to the location of your solution file, and then click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image5.png)
9. <span data-ttu-id="2ebd8-160">V **položky k sestavení** dialogové okno, klikněte na tlačítko **přidat**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-160">In the **Items to Build** dialog box, click **Add**.</span></span>
10. <span data-ttu-id="2ebd8-161">V **položky typu** rozevíracího seznamu vyberte **soubory projektu MSBuild**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-161">In the **Items of type** dropdown list, select **MSBuild Project files**.</span></span>
11. <span data-ttu-id="2ebd8-162">Přejděte do umístění souboru vlastních projektů, pomocí kterého řízení procesu nasazení, vyberte ho a pak klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-162">Browse to the location of the custom project file with which you control the deployment process, select the file, and then click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image6.png)
12. <span data-ttu-id="2ebd8-163">**Položky k sestavení** dialogové okno by teď zobrazují dvě položky.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-163">The **Items to Build** dialog box should now show two items.</span></span> <span data-ttu-id="2ebd8-164">Klikněte na tlačítko **OK**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-164">Click **OK**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image7.png)
13. <span data-ttu-id="2ebd8-165">Na **procesu** kartě **parametry procesu sestavení** tabulky, rozbalte **Upřesnit** oddílu.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-165">On the **Process** tab, in the **Build process parameters** table, expand the **Advanced** section.</span></span>
14. <span data-ttu-id="2ebd8-166">V **argumenty nástroje MSBuild** řádek, přidejte jakékoli argumenty příkazového řádku MSBuild, který *buď* položek k sestavení vyžaduje.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-166">In the **MSBuild Arguments** row, add any MSBuild command-line arguments that *either* of your items to build requires.</span></span> <span data-ttu-id="2ebd8-167">Scénář řešení Správce kontaktů tyto argumenty jsou povinné:</span><span class="sxs-lookup"><span data-stu-id="2ebd8-167">In the Contact Manager solution scenario, these arguments are required:</span></span>

    [!code-console[Main](creating-a-build-definition-that-supports-deployment/samples/sample1.cmd)]

    ![](creating-a-build-definition-that-supports-deployment/_static/image8.png)
15. <span data-ttu-id="2ebd8-168">V tomto příkladu:</span><span class="sxs-lookup"><span data-stu-id="2ebd8-168">In this example:</span></span>

    1. <span data-ttu-id="2ebd8-169">**DeployOnBuild = true** a **DeployTarget = balíček** argumenty jsou povinné, když vytvoříte řešení Správce kontaktů.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-169">The **DeployOnBuild=true** and **DeployTarget=package** arguments are required when you build the Contact Manager solution.</span></span> <span data-ttu-id="2ebd8-170">Toto nastaví nástroj MSBuild pro vytváření webových balíčky pro nasazení po sestavení projektu každé webové aplikace, jak je popsáno v [sestavení a balení projektů webových aplikací](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span><span class="sxs-lookup"><span data-stu-id="2ebd8-170">This instructs MSBuild to create web deployment packages after building each web application project, as described in [Building and Packaging Web Application Projects](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md).</span></span>
    2. <span data-ttu-id="2ebd8-171">**TargetEnvPropsFile** argument je povinný při vytváření *Publish.proj* souboru.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-171">The **TargetEnvPropsFile** argument is required when you build the *Publish.proj* file.</span></span> <span data-ttu-id="2ebd8-172">Tato vlastnost určuje umístění souboru konfigurace pro konkrétní prostředí, jak je popsáno v [Principy procesu sestavení](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span><span class="sxs-lookup"><span data-stu-id="2ebd8-172">This property indicates the location of the environment-specific configuration file, as described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md).</span></span>
16. <span data-ttu-id="2ebd8-173">Na **zásady uchovávání informací** kartu, nakonfigurujte, kolik sestavení každého typu, které chcete zachovat podle potřeby.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-173">On the **Retention Policy** tab, configure how many builds of each type you want to retain as required.</span></span>
17. <span data-ttu-id="2ebd8-174">Klikněte na tlačítko **Uložit**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-174">Click **Save**.</span></span>

## <a name="queue-a-build"></a><span data-ttu-id="2ebd8-175">Zařazení sestavení do fronty</span><span class="sxs-lookup"><span data-stu-id="2ebd8-175">Queue a Build</span></span>

<span data-ttu-id="2ebd8-176">V tomto okamžiku jste vytvořili aspoň jednu novou definici sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-176">At this point, you have created at least one new build definition.</span></span> <span data-ttu-id="2ebd8-177">Proces sestavení, které jste definovali se teď spustí podle aktivačních událostí, které jste zadali v definici sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-177">The build process you defined will now run according to the triggers you specified in the build definition.</span></span>

<span data-ttu-id="2ebd8-178">Pokud jste nakonfigurovali definici sestavení CI používat, můžete otestovat definici sestavení dvěma způsoby:</span><span class="sxs-lookup"><span data-stu-id="2ebd8-178">If you've configured your build definition to use CI, you can test your build definition in two ways:</span></span>

- <span data-ttu-id="2ebd8-179">Vrátit se změnami nějaký obsah do týmového projektu k aktivaci automatického sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-179">Check in some content to the team project to trigger an automatic build.</span></span>
- <span data-ttu-id="2ebd8-180">Zařadit sestavení do fronty ručně.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-180">Queue a build manually.</span></span>

<span data-ttu-id="2ebd8-181">**Sestavení do fronty ručně**</span><span class="sxs-lookup"><span data-stu-id="2ebd8-181">**To queue a build manually**</span></span>

1. <span data-ttu-id="2ebd8-182">V **Team Exploreru** okna, klikněte pravým tlačítkem na definici sestavení a pak klikněte na tlačítko **zařadit nové sestavení**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-182">In the **Team Explorer** window, right-click the build definition, and then click **Queue New Build**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image9.png)
2. <span data-ttu-id="2ebd8-183">V **zařadit sestavení do fronty** dialogové okno, zkontrolujte vlastnosti sestavení a pak klikněte na tlačítko **fronty**.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-183">In the **Queue Build** dialog box, review the build properties, and then click **Queue**.</span></span>

    ![](creating-a-build-definition-that-supports-deployment/_static/image10.png)

<span data-ttu-id="2ebd8-184">Chcete zkontrolovat průběh a výsledky sestavení&#x2014;bez ohledu na to, zda byla spuštěna ručně nebo automaticky&#x2014;dvakrát na definici sestavení v **Team Exploreru** okna.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-184">To review the progress and the outcome of a build&#x2014;regardless of whether it was triggered manually or automatically&#x2014;double-click the build definition in the **Team Explorer** window.</span></span> <span data-ttu-id="2ebd8-185">Tím se otevře **Průzkumník sestavení** kartu.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-185">This will open a **Build Explorer** tab.</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image11.png)

<span data-ttu-id="2ebd8-186">Zde můžete řešit selhání sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-186">From here, you can troubleshoot failed builds.</span></span> <span data-ttu-id="2ebd8-187">Pokud dvakrát kliknete na jednotlivý build, můžete zobrazit souhrnné informace a proklikejte se k podrobné soubory protokolů.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-187">If you double-click an individual build, you can view summary information and click through to detailed log files.</span></span>

![](creating-a-build-definition-that-supports-deployment/_static/image12.png)

<span data-ttu-id="2ebd8-188">Tyto informace slouží k řešení selhání sestavení a řešit jakékoli problémy, než se pokusíte jiné sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-188">You can use this information to troubleshoot failed builds and address any problems before you attempt another build.</span></span>

> [!NOTE]
> <span data-ttu-id="2ebd8-189">Sestavení, které jsou spouštěny logiky nasazení budou pravděpodobně fungovat, dokud jste udělili server sestavení všechna oprávnění nutná v cílovém prostředí.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-189">Builds that execute deployment logic are likely to fail until you have granted the build server any permissions required in the destination environment.</span></span> <span data-ttu-id="2ebd8-190">Další informace najdete v tématu [konfigurace oprávnění pro nasazení sestavení týmu](configuring-permissions-for-team-build-deployment.md).</span><span class="sxs-lookup"><span data-stu-id="2ebd8-190">For more information, see [Configuring Permissions for Team Build Deployment](configuring-permissions-for-team-build-deployment.md).</span></span>


## <a name="monitor-the-build-process"></a><span data-ttu-id="2ebd8-191">Monitorování procesu sestavení</span><span class="sxs-lookup"><span data-stu-id="2ebd8-191">Monitor the Build Process</span></span>

<span data-ttu-id="2ebd8-192">TFS poskytuje širokou škálu funkcí, které vám pomohou monitorovat proces sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-192">TFS provides a broad range of functionality to help you monitor the build process.</span></span> <span data-ttu-id="2ebd8-193">TFS můžete například odeslat e-mailu nebo zobrazení výstrah v oznamovací oblasti hlavního panelu po dokončení sestavení.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-193">For example, TFS can send you an email or display alerts in your taskbar notification area when a build has completed.</span></span> <span data-ttu-id="2ebd8-194">Další informace najdete v tématu [spuštění a monitorování sestavení](https://msdn.microsoft.com/library/ms181721.aspx).</span><span class="sxs-lookup"><span data-stu-id="2ebd8-194">For more information, see [Run and Monitor Builds](https://msdn.microsoft.com/library/ms181721.aspx).</span></span>

## <a name="conclusion"></a><span data-ttu-id="2ebd8-195">Závěr</span><span class="sxs-lookup"><span data-stu-id="2ebd8-195">Conclusion</span></span>

<span data-ttu-id="2ebd8-196">Toto téma popisuje, jak vytvořit definici sestavení v sadě TFS.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-196">This topic described how to create a build definition in TFS.</span></span> <span data-ttu-id="2ebd8-197">Definice sestavení je nakonfigurovaný pro nepřetržitou Integraci, aby proces sestavení poběží pokaždé, když vývojář vrátí obsah do týmového projektu.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-197">The build definition is configured for CI, so the build process runs whenever a developer checks in content to the team project.</span></span> <span data-ttu-id="2ebd8-198">Definici sestavení spustí vlastní soubor projektu MSBuild k nasazení webových balíčků a databázové skripty do cílového serveru prostředí.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-198">The build definition executes a custom MSBuild project file to deploy web packages and database scripts to a target server environment.</span></span>

<span data-ttu-id="2ebd8-199">V pořadí pro automatické nasazení proběhla úspěšně jako součást procesu sestavení budete muset udělit příslušná oprávnění k účtu sestavovací služby na cílové webové servery a databáze cílový server.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-199">In order for an automated deployment to succeed as part of a build process, you'll need to grant appropriate permissions to the build service account on the target web servers and the target database server.</span></span> <span data-ttu-id="2ebd8-200">V posledním tématu v tomto kurzu se [konfigurace oprávnění pro nasazení sestavení týmu](configuring-permissions-for-team-build-deployment.md), popisuje, jak identifikovat a nakonfigurovat oprávnění požadovaná pro automatické nasazení ze serveru Team Build.</span><span class="sxs-lookup"><span data-stu-id="2ebd8-200">The final topic in this tutorial, [Configuring Permissions for Team Build Deployment](configuring-permissions-for-team-build-deployment.md), describes how to identify and configure the permissions required for automated deployment from a Team Build server.</span></span>

## <a name="further-reading"></a><span data-ttu-id="2ebd8-201">Další čtení</span><span class="sxs-lookup"><span data-stu-id="2ebd8-201">Further Reading</span></span>

<span data-ttu-id="2ebd8-202">Další informace o vytvoření definice sestavení, naleznete v tématu [vytvořit a Basic Build Definition](https://msdn.microsoft.com/library/ms181716.aspx) a [definovat svůj proces sestavení](https://msdn.microsoft.com/library/ms181715.aspx).</span><span class="sxs-lookup"><span data-stu-id="2ebd8-202">For more information on creating build definitions, see [Create a Basic Build Definition](https://msdn.microsoft.com/library/ms181716.aspx) and [Define Your Build Process](https://msdn.microsoft.com/library/ms181715.aspx).</span></span> <span data-ttu-id="2ebd8-203">Další pokyny k řazení sestavení do fronty, naleznete v tématu [zařadit sestavení do fronty](https://msdn.microsoft.com/library/ms181722.aspx).</span><span class="sxs-lookup"><span data-stu-id="2ebd8-203">For more guidance on queuing builds, see [Queue a Build](https://msdn.microsoft.com/library/ms181722.aspx).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2ebd8-204">[Předchozí](configuring-a-tfs-build-server-for-web-deployment.md)
> [další](deploying-a-specific-build.md)</span><span class="sxs-lookup"><span data-stu-id="2ebd8-204">[Previous](configuring-a-tfs-build-server-for-web-deployment.md)
[Next](deploying-a-specific-build.md)</span></span>
