---
uid: web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-production
title: 'Nasazení webu ASP.NET pomocí sady Visual Studio: nasazení do produkčního prostředí | Dokumentace Microsoftu'
author: tdykstra
description: V této sérii kurzů se dozvíte, jak nasadit (publikovat) technologie ASP.NET webové aplikace do Azure App Service Web Apps nebo k poskytovateli hostingu třetích stran, podle usin...
ms.author: aspnetcontent
ms.date: 02/15/2013
ms.assetid: 416438a1-3b2f-4d27-bf53-6b76223c33bf
msc.legacyurl: /web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-production
msc.type: authoredcontent
ms.openlocfilehash: a91feedb9ac09b2a70ca256c72d312a1e78ecbc8
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 07/05/2018
ms.locfileid: "37827874"
---
<a name="aspnet-web-deployment-using-visual-studio-deploying-to-production"></a><span data-ttu-id="58dbc-103">Nasazení webu ASP.NET pomocí sady Visual Studio: nasazení do produkčního prostředí</span><span class="sxs-lookup"><span data-stu-id="58dbc-103">ASP.NET Web Deployment using Visual Studio: Deploying to Production</span></span>
====================
<span data-ttu-id="58dbc-104">podle [Petr Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="58dbc-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="58dbc-105">Stáhnout počáteční projekt</span><span class="sxs-lookup"><span data-stu-id="58dbc-105">Download Starter Project</span></span>](http://go.microsoft.com/fwlink/p/?LinkId=282627)

> <span data-ttu-id="58dbc-106">V této sérii kurzů se dozvíte, jak nasadit (publikovat) technologie ASP.NET webové aplikace do Azure App Service Web Apps nebo k poskytovateli hostingu třetích stran, s použitím sady Visual Studio 2012 nebo Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="58dbc-106">This tutorial series shows you how to deploy (publish) an ASP.NET web application to Azure App Service Web Apps or to a third-party hosting provider, by using Visual Studio 2012 or Visual Studio 2010.</span></span> <span data-ttu-id="58dbc-107">Informace o této sérii, naleznete v tématu [z prvního kurzu této série](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="58dbc-107">For information about the series, see [the first tutorial in the series](introduction.md).</span></span>


## <a name="overview"></a><span data-ttu-id="58dbc-108">Přehled</span><span class="sxs-lookup"><span data-stu-id="58dbc-108">Overview</span></span>

<span data-ttu-id="58dbc-109">V tomto kurzu nastavte si účet Microsoft Azure, vytvořte přípravného a produkčního prostředí a nasazení webové aplikace ASP.NET v přípravném a produkčním prostředí pomocí sady Visual Studio jedním kliknutím publikování funkce.</span><span class="sxs-lookup"><span data-stu-id="58dbc-109">In this tutorial, you set up a Microsoft Azure account, create staging and production environments, and deploy your ASP.NET web application to the staging and production environments by using the Visual Studio one-click publish feature.</span></span>

<span data-ttu-id="58dbc-110">Pokud dáváte přednost, můžete nasadit do poskytovatele hostitelských služeb třetích stran.</span><span class="sxs-lookup"><span data-stu-id="58dbc-110">If you prefer, you can deploy to a third-party hosting provider.</span></span> <span data-ttu-id="58dbc-111">Většinu postupů popsaných v tomto kurzu jsou stejné pro poskytovatele hostingu nebo pro Azure, s tím rozdílem, že každý poskytovatel má své vlastní uživatelské rozhraní pro správu účtu a webové stránky.</span><span class="sxs-lookup"><span data-stu-id="58dbc-111">Most of the procedures described in this tutorial are the same for a hosting provider or for Azure, except that each provider has its own user interface for account and web site management.</span></span> <span data-ttu-id="58dbc-112">Můžete najít v poskytovateli hostingu [Galerie zprostředkovatelů](https://www.microsoft.com/web/hosting) na webu Microsoft.com.</span><span class="sxs-lookup"><span data-stu-id="58dbc-112">You can find a hosting provider in the [gallery of providers](https://www.microsoft.com/web/hosting) on the Microsoft.com web site.</span></span>

<span data-ttu-id="58dbc-113">Připomenutí: Pokud se zobrazí chybová zpráva nebo něco nefunguje tak, jak absolvovat kurz, nezapomeňte se podívat na stránce o řešení problémů v této sérii kurzů.</span><span class="sxs-lookup"><span data-stu-id="58dbc-113">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the Troubleshooting page in this tutorial series.</span></span>

## <a name="get-a-microsoft-azure-account"></a><span data-ttu-id="58dbc-114">Získat účet Microsoft Azure</span><span class="sxs-lookup"><span data-stu-id="58dbc-114">Get a Microsoft Azure account</span></span>

<span data-ttu-id="58dbc-115">Pokud ještě nemáte účet Azure, můžete během několika minut vytvořit Bezplatný zkušební účet.</span><span class="sxs-lookup"><span data-stu-id="58dbc-115">If you don't already have an Azure account, you can create a free trial account in just a couple of minutes.</span></span> <span data-ttu-id="58dbc-116">Podrobnosti najdete v tématu [bezplatnou zkušební verzi Azure](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span><span class="sxs-lookup"><span data-stu-id="58dbc-116">For details, see [Azure Free Trial](https://azure.microsoft.com/free/?WT.mc_id=A443DD604).</span></span>

## <a name="create-a-staging-environment"></a><span data-ttu-id="58dbc-117">Vytvořit testovací prostředí</span><span class="sxs-lookup"><span data-stu-id="58dbc-117">Create a staging environment</span></span>

> [!NOTE]
> <span data-ttu-id="58dbc-118">Protože v tomto kurzu byla zapsána, Azure App Service přidali novou funkci k automatizaci mnoha procesy pro vytvoření přípravného a produkčního prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-118">Since this tutorial was written, Azure App Service added a new feature to automate many of the processes for creating staging and production environments.</span></span> <span data-ttu-id="58dbc-119">Zobrazit [nastavení přípravných prostředí pro web apps ve službě Azure App Service](https://azure.microsoft.com/documentation/articles/web-sites-staged-publishing/).</span><span class="sxs-lookup"><span data-stu-id="58dbc-119">See [Set up staging environments for web apps in Azure App Service](https://azure.microsoft.com/documentation/articles/web-sites-staged-publishing/).</span></span>


<span data-ttu-id="58dbc-120">Jak je vysvětleno v [nasadit testovací prostředí, najdete v kurzu](deploying-to-iis.md), nejvíce spolehlivé testovací prostředí je webová stránka na poskytovatele hostingu, který má stejně jako webové pracoviště.</span><span class="sxs-lookup"><span data-stu-id="58dbc-120">As explained in the [Deploy to the Test Environment tutorial](deploying-to-iis.md), the most reliable test environment is a web site at the hosting provider that's just like the production web site.</span></span> <span data-ttu-id="58dbc-121">V mnoha poskytovatelé hostingu byste museli zvážit výhody tohoto proti významné další poplatky, ale v Azure můžete vytvořit další bezplatná webová aplikace jako pracovní aplikace.</span><span class="sxs-lookup"><span data-stu-id="58dbc-121">At many hosting providers you would have to weigh the benefits of this against significant additional cost, but in Azure you can create an additional free web app as your staging app.</span></span> <span data-ttu-id="58dbc-122">Budete potřebovat databázi a další výdaje za, která přes výdaje provozní databáze bude mít buď žádný nebo minimální.</span><span class="sxs-lookup"><span data-stu-id="58dbc-122">You also need a database, and the additional expense for that over the expense of your production database will be either none or minimal.</span></span> <span data-ttu-id="58dbc-123">V Azure platíte velikost úložiště databáze, které používáte, a nikoli pro každou databázi, a bude minimální velikost dalšího úložiště, které budete používat v testovacím prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-123">In Azure you pay for the amount of database storage you use rather than for each database, and the amount of additional storage you'll use in staging will be minimal.</span></span>

<span data-ttu-id="58dbc-124">Jak je vysvětleno v [nasadit do testovacího prostředí kurzu](deploying-to-iis.md), do pracovního a produkčního prostředí se chystáte nasadit do jedné databáze dvě databáze.</span><span class="sxs-lookup"><span data-stu-id="58dbc-124">As explained in the [Deploy to the Test Environment tutorial](deploying-to-iis.md), in staging and production you're going to deploy your two databases into one database.</span></span> <span data-ttu-id="58dbc-125">Pokud byste chtěli je oddělit, proces by stejné s tím rozdílem, že vytvoříte další databáze pro jednotlivá prostředí a vyberete řetězec správné cíl pro každou databázi, když vytvoříte profil publikování.</span><span class="sxs-lookup"><span data-stu-id="58dbc-125">If you wanted to keep them separate, the process would be the same except that you'd create an additional database for each environment and you would select the correct destination string for each database when you create the publish profile.</span></span>

<span data-ttu-id="58dbc-126">V této části kurzu vytvoříte webovou aplikaci a databázi pro testovací prostředí, a budete nasazení do přípravného prostředí a testování existuje ještě před vytvořením a nasazením do produkčního prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-126">In this section of the tutorial you'll create a web app and database to use for the staging environment, and you'll deploy to staging and test there before creating and deploying to the production environment.</span></span>

> [!NOTE]
> <span data-ttu-id="58dbc-127">Následující kroky ukazují, jak vytvořit webovou aplikaci ve službě Azure App Service pomocí portálu pro správu Azure.</span><span class="sxs-lookup"><span data-stu-id="58dbc-127">The following steps show how to create a web app in Azure App Service by using the Azure management portal.</span></span> <span data-ttu-id="58dbc-128">V nejnovější verzi sady Azure SDK můžete také provést bez opuštění sady Visual Studio pomocí Průzkumníka serveru.</span><span class="sxs-lookup"><span data-stu-id="58dbc-128">In the latest version of the Azure SDK, you can also do this without leaving Visual Studio, by using Server Explorer.</span></span> <span data-ttu-id="58dbc-129">V sadě Visual Studio 2013 můžete také vytvořit webovou aplikaci přímo z dialogového okna pro publikování.</span><span class="sxs-lookup"><span data-stu-id="58dbc-129">In Visual Studio 2013, you can also create a web app directly from the Publish dialog.</span></span> <span data-ttu-id="58dbc-130">Další informace najdete v tématu [vytvoření webové aplikace ASP.NET ve službě Azure App Service.](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet)</span><span class="sxs-lookup"><span data-stu-id="58dbc-130">For more information, see [Create an ASP.NET web app in Azure App Service.](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet)</span></span>


1. <span data-ttu-id="58dbc-131">V [portálu pro správu Azure](https://manage.windowsazure.com/), klikněte na tlačítko **Websites**a potom klikněte na tlačítko **nový**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-131">In the [Azure Management Portal](https://manage.windowsazure.com/), click **Websites**, and then click **New**.</span></span>
2. <span data-ttu-id="58dbc-132">Klikněte na tlačítko **webu**a potom klikněte na tlačítko **vytvořit vlastní**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-132">Click **Website**, and then click **Custom Create**.</span></span>

    <span data-ttu-id="58dbc-133">**Nový - vytvořit vlastní web** otevře se průvodce.</span><span class="sxs-lookup"><span data-stu-id="58dbc-133">The **New Website - Custom Create** wizard opens.</span></span> <span data-ttu-id="58dbc-134">**Vytvořit vlastní** Průvodce vám umožní vytvořit webovou stránku a databází ve stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-134">The **Custom Create** wizard enables you to create a web site and a database at the same time.</span></span>
3. <span data-ttu-id="58dbc-135">V **vytvořit web** kroku v průvodci zadat řetězec **adresy URL** pole použít jako jedinečná adresa URL pro vaši aplikaci prvku přípravného prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-135">In the **Create Website** step of the wizard, enter a string in the **URL** box to use as the unique URL for your application's staging environment.</span></span> <span data-ttu-id="58dbc-136">Zadejte například ContosoUniversity-staging123 (včetně náhodných čísel na konci pro zajištění jeho jedinečnosti v případě, že se používá ContosoUniversity pracovní).</span><span class="sxs-lookup"><span data-stu-id="58dbc-136">For example, enter ContosoUniversity-staging123 (including random numbers at the end to make it unique in case ContosoUniversity-staging is taken).</span></span>

    <span data-ttu-id="58dbc-137">Úplná adresa URL bude obsahovat co zadáte tady a příponu, která se zobrazí vedle textového pole.</span><span class="sxs-lookup"><span data-stu-id="58dbc-137">The complete URL will consist of what you enter here plus the suffix that you see next to the text box.</span></span>
4. <span data-ttu-id="58dbc-138">V **oblasti** rozevírací seznam, vyberte oblast, která je nejblíže k vám.</span><span class="sxs-lookup"><span data-stu-id="58dbc-138">In the **Region** drop-down list, choose the region that is closest to you.</span></span>

    <span data-ttu-id="58dbc-139">Toto nastavení určuje datové centrum, kterého webová aplikace se spustí v.</span><span class="sxs-lookup"><span data-stu-id="58dbc-139">This setting specifies which data center your web app will run in.</span></span>
5. <span data-ttu-id="58dbc-140">V **databáze** rozevíracím seznamu klikněte na položku **vytvořit novou databázi SQL**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-140">In the **Database** drop-down list, choose **Create a new SQL database**.</span></span>
6. <span data-ttu-id="58dbc-141">V **název připojovacího řetězce DB** okně ponechte výchozí hodnotu *objekt DefaultConnection*.</span><span class="sxs-lookup"><span data-stu-id="58dbc-141">In the **DB Connection String Name** box, leave the default value, *DefaultConnection*.</span></span>
7. <span data-ttu-id="58dbc-142">Klikněte na šipku, která ukazuje vpravo v dolní části seznamu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-142">Click the arrow that points to the right at the bottom of the box.</span></span>

    <span data-ttu-id="58dbc-143">Je vidět na následujícím obrázku **vytvořit web** dialogové okno s ukázkové hodnoty v ní.</span><span class="sxs-lookup"><span data-stu-id="58dbc-143">The following illustration shows the **Create Website** dialog with sample values in it.</span></span> <span data-ttu-id="58dbc-144">Adresa URL a oblasti, kterou jste zadali, se liší.</span><span class="sxs-lookup"><span data-stu-id="58dbc-144">The URL and Region that you have entered will be different.</span></span>

    ![Vytvoření webu krok](deploying-to-production/_static/image1.png)

    <span data-ttu-id="58dbc-146">Průvodce přejde **nastavení databáze** kroku.</span><span class="sxs-lookup"><span data-stu-id="58dbc-146">The wizard advances to the **Specify database settings** step.</span></span>
8. <span data-ttu-id="58dbc-147">V **název** zadejte *ContosoUniversity* plus náhodné číslo pro zajištění jeho jedinečnosti, například *ContosoUniversity123*.</span><span class="sxs-lookup"><span data-stu-id="58dbc-147">In the **Name** box, enter *ContosoUniversity* plus a random number to make it unique, for example *ContosoUniversity123*.</span></span>
9. <span data-ttu-id="58dbc-148">V **Server** vyberte **nový Server služby SQL Database**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-148">In the **Server** box, select **New SQL Database Server**.</span></span>
10. <span data-ttu-id="58dbc-149">Zadejte jméno správce a heslo.</span><span class="sxs-lookup"><span data-stu-id="58dbc-149">Enter an administrator name and password.</span></span>

    <span data-ttu-id="58dbc-150">Tak nezadáváte existující jméno a heslo.</span><span class="sxs-lookup"><span data-stu-id="58dbc-150">You aren't entering an existing name and password here.</span></span> <span data-ttu-id="58dbc-151">Zadáváte nový název a heslo, které teď definujete pro pozdější použití při přístupu k databázi.</span><span class="sxs-lookup"><span data-stu-id="58dbc-151">You're entering a new name and password that you're defining now to use later when you access the database.</span></span>
11. <span data-ttu-id="58dbc-152">V **oblasti** vyberte stejnou oblast, kterou jste zvolili pro webovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="58dbc-152">In the **Region** box, choose the same region that you chose for the web app.</span></span>

    <span data-ttu-id="58dbc-153">Aby webový server a databázový server ve stejné oblasti poskytuje nejlepší výkon a minimalizuje náklady.</span><span class="sxs-lookup"><span data-stu-id="58dbc-153">Keeping the web server and the database server in the same region gives you the best performance and minimizes expenses.</span></span>
12. <span data-ttu-id="58dbc-154">Kliknutím na značku zaškrtnutí v dolní části políčka potvrďte, že budete hotovi.</span><span class="sxs-lookup"><span data-stu-id="58dbc-154">Click the check mark at the bottom of the box to indicate that you're finished.</span></span>

    <span data-ttu-id="58dbc-155">Je vidět na následujícím obrázku **nastavení databáze** dialogové okno s ukázkové hodnoty v ní.</span><span class="sxs-lookup"><span data-stu-id="58dbc-155">The following illustration shows the **Specify database settings** dialog with sample values in it.</span></span> <span data-ttu-id="58dbc-156">Hodnoty, které jste zadali, se může lišit.</span><span class="sxs-lookup"><span data-stu-id="58dbc-156">The values you have entered may be different.</span></span>

    ![Krok nastavení databáze webu nový - vytvořit pomocí Průvodce databáze](deploying-to-production/_static/image2.png)

    <span data-ttu-id="58dbc-158">Na portálu pro správu vrátí na stránku pro Websites a **stav** sloupci se zobrazuje, že probíhá vytváření webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="58dbc-158">The Management Portal returns to the Websites page, and the **Status** column shows that the web app is being created.</span></span> <span data-ttu-id="58dbc-159">Po chvíli (obvykle během méně než minutu) **stav** sloupci se zobrazuje, že webová aplikace byla úspěšně vytvořena.</span><span class="sxs-lookup"><span data-stu-id="58dbc-159">After a while (typically less than a minute), the **Status** column shows that the web app was successfully created.</span></span> <span data-ttu-id="58dbc-160">Na navigačním panelu na levé straně, počet webových aplikací, které máte ve vašem účtu se zobrazí vedle **Websites** ikonu a počet databází, které se zobrazí vedle **databází SQL** ikonu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-160">In the navigation bar at the left, the number of web apps you have in your account appears next to the **Websites** icon, and the number of databases appears next to the **SQL Databases** icon.</span></span>

    ![Weby stránce portálu pro správu, vytvořit webovou stránku](deploying-to-production/_static/image3.png)

    <span data-ttu-id="58dbc-162">Název vaší webové aplikace se bude lišit od aplikace příklad na obrázku.</span><span class="sxs-lookup"><span data-stu-id="58dbc-162">Your web app name will be different from the example app in the illustration.</span></span>

## <a name="deploy-the-application-to-staging"></a><span data-ttu-id="58dbc-163">Nasaďte aplikaci do přípravného prostředí</span><span class="sxs-lookup"><span data-stu-id="58dbc-163">Deploy the application to staging</span></span>

<span data-ttu-id="58dbc-164">Teď, když jste vytvořili webovou aplikaci a databázi pro testovací prostředí, můžete nasadit projekt na ni.</span><span class="sxs-lookup"><span data-stu-id="58dbc-164">Now that you have created a web app and database for the staging environment, you can deploy the project to it.</span></span>

> [!NOTE]
> <span data-ttu-id="58dbc-165">Tyto pokyny ukazují, jak vytvořit profil publikování stažením *.publishsettings* soubor, který funguje nejen pro Azure, ale také pro externí poskytovatele hostingu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-165">These instructions show how to create a publish profile by downloading a *.publishsettings* file, which works not only for Azure but also for third-party hosting providers.</span></span> <span data-ttu-id="58dbc-166">Nejnovější sadu Azure SDK můžete také připojit přímo k Azure ze sady Visual Studio a zvolte ze seznamu webových aplikací, které máte ve svém účtu Azure.</span><span class="sxs-lookup"><span data-stu-id="58dbc-166">The latest Azure SDK also enables you to connect directly to Azure from Visual Studio, and choose from a list of web apps that you have in your Azure account.</span></span> <span data-ttu-id="58dbc-167">V sadě Visual Studio 2013, můžete přihlásit k Azure z **publikování webu** dialogové okno nebo **Průzkumníka serveru** okna.</span><span class="sxs-lookup"><span data-stu-id="58dbc-167">In Visual Studio 2013, you can sign in to Azure from the **Web Publish** dialog or from the **Server Explorer** window.</span></span> <span data-ttu-id="58dbc-168">Další informace najdete v tématu [vytvoření webové aplikace ASP.NET ve službě Azure App Service](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span><span class="sxs-lookup"><span data-stu-id="58dbc-168">For more information, see [Create an ASP.NET web app in Azure App Service](https://docs.microsoft.com/azure/app-service-web/app-service-web-get-started-dotnet).</span></span>


### <a name="download-the-publishsettings-file"></a><span data-ttu-id="58dbc-169">Stáhněte si soubor .publishsettings</span><span class="sxs-lookup"><span data-stu-id="58dbc-169">Download the .publishsettings file</span></span>

1. <span data-ttu-id="58dbc-170">Klikněte na název webové aplikace, kterou jste právě vytvořili.</span><span class="sxs-lookup"><span data-stu-id="58dbc-170">Click the name of the web app that you just created.</span></span>

    ![Klikněte na lokalitu, přejděte na řídicí panel](deploying-to-production/_static/image4.png)
2. <span data-ttu-id="58dbc-172">V části **rychlý přehled** v **řídicí panel** klikněte na tlačítko **stáhnout profil publikování**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-172">Under **Quick glance** in the **Dashboard** tab, click **Download publish profile**.</span></span>

    ![Profil publikování odkaz ke stažení](deploying-to-production/_static/image5.png)

    <span data-ttu-id="58dbc-174">Tento krok stáhne soubor, který obsahuje všechna nastavení, které potřebujete k nasazení aplikace do webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="58dbc-174">This step downloads a file that contains all of the settings that you need in order to deploy an application to your web app.</span></span> <span data-ttu-id="58dbc-175">Tento soubor budete importovat do sady Visual Studio, takže není nutné tyto informace zadat ručně.</span><span class="sxs-lookup"><span data-stu-id="58dbc-175">You'll import this file into Visual Studio so you don't have to enter this information manually.</span></span>
3. <span data-ttu-id="58dbc-176">Uložit *.publishsettings* souboru ve složce, která se dá dostat z Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="58dbc-176">Save the *.publishsettings* file in a folder that you can access from Visual Studio.</span></span>

    ![ukládání souboru .publishsettings](deploying-to-production/_static/image6.png)

    > [!WARNING]
    > <span data-ttu-id="58dbc-178">Zabezpečení – *.publishsettings* soubor obsahuje vaše přihlašovací údaje (nekódovaný), které se používají ke správě vašich předplatných a služeb Azure.</span><span class="sxs-lookup"><span data-stu-id="58dbc-178">Security - The *.publishsettings* file contains your credentials (unencoded) that are used to administer your Azure subscriptions and services.</span></span> <span data-ttu-id="58dbc-179">Osvědčené postupy zabezpečení pro tento soubor je dočasně ukládat mimo vašeho adresáře zdrojových souborů (například ve složce Libraries\Documents) a odstraňte ji. Po dokončení importu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-179">The security best practice for this file is to store it temporarily outside your source directories (for example in the Libraries\Documents folder), and then delete it once the import has completed.</span></span> <span data-ttu-id="58dbc-180">Uživatel se zlými úmysly, který získá přístup k *.publishsettings* soubor můžete upravit, vytvářet a odstraňovat služeb Azure.</span><span class="sxs-lookup"><span data-stu-id="58dbc-180">A malicious user who gains access to the *.publishsettings* file can edit, create, and delete your Azure services.</span></span>

### <a name="create-a-publish-profile"></a><span data-ttu-id="58dbc-181">Vytvořte profil publikování</span><span class="sxs-lookup"><span data-stu-id="58dbc-181">Create a publish profile</span></span>

1. <span data-ttu-id="58dbc-182">Ve Visual Studiu klikněte pravým tlačítkem na projekt ContosoUniversity v **Průzkumníka řešení** a vyberte **publikovat** v místní nabídce.</span><span class="sxs-lookup"><span data-stu-id="58dbc-182">In Visual Studio, right-click the ContosoUniversity project in **Solution Explorer** and select **Publish** from the context menu.</span></span>

    <span data-ttu-id="58dbc-183">**Publikování webu** otevře se průvodce.</span><span class="sxs-lookup"><span data-stu-id="58dbc-183">The **Publish Web** wizard opens.</span></span>
2. <span data-ttu-id="58dbc-184">Klikněte na tlačítko **profilu** kartu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-184">Click the **Profile** tab.</span></span>
3. <span data-ttu-id="58dbc-185">Klikněte na tlačítko **Import**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-185">Click **Import**.</span></span>
4. <span data-ttu-id="58dbc-186">Přejděte *.publishsettings* soubor jste předtím stáhli a potom klikněte na **otevřít**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-186">Navigate to the *.publishsettings* file you downloaded earlier, and then click **Open**.</span></span>

    ![Dialogové okno importu nastavení publikování](deploying-to-production/_static/image7.png)
5. <span data-ttu-id="58dbc-188">V **připojení** klikněte na tlačítko **ověřit připojení** abyste měli jistotu, že jsou správné nastavení.</span><span class="sxs-lookup"><span data-stu-id="58dbc-188">In the **Connection** tab, click **Validate Connection** to make sure that the settings are correct.</span></span>

    <span data-ttu-id="58dbc-189">Při připojení je potvrzená, se vedle položky zobrazí zelená značka zaškrtnutí **ověřit připojení** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="58dbc-189">When the connection has been validated, a green check mark is shown next to the **Validate Connection** button.</span></span>

    <span data-ttu-id="58dbc-190">Pro některé poskytovatelům hostingu, po kliknutí na **ověřit připojení**, můžete se setkat **Chyba certifikátu** dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="58dbc-190">For some hosting providers, when you click **Validate Connection**, you might see a **Certificate Error** dialog box.</span></span> <span data-ttu-id="58dbc-191">Pokud tak učiníte, ověřte, že je název serveru, co očekáváte.</span><span class="sxs-lookup"><span data-stu-id="58dbc-191">If you do, verify that the server name is what you expect.</span></span> <span data-ttu-id="58dbc-192">Pokud je název serveru správný, vyberte **uložení tohoto certifikátu na budoucí relace sady Visual Studio** a klikněte na tlačítko **přijmout**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-192">If the server name is correct, select **Save this certificate for future sessions of Visual Studio** and click **Accept**.</span></span> <span data-ttu-id="58dbc-193">(Tato chyba znamená, že poskytovatel hostingu rozhodl vyhnout prostředky na nákup certifikátu SSL pro adresu URL, kterou nasazujete.</span><span class="sxs-lookup"><span data-stu-id="58dbc-193">(This error means that the hosting provider has chosen to avoid the expense of purchasing an SSL certificate for the URL that you are deploying to.</span></span> <span data-ttu-id="58dbc-194">Pokud chcete navázat zabezpečené připojení pomocí platného certifikátu, kontaktujte poskytovatele hostingových služeb.)</span><span class="sxs-lookup"><span data-stu-id="58dbc-194">If you prefer to establish a secure connection by using a valid certificate, contact your hosting provider.)</span></span>
6. <span data-ttu-id="58dbc-195">Klikněte na tlačítko **Další**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-195">Click **Next**.</span></span>

    ![Ikona úspěšné připojení a tlačítko Další na kartě připojení Průvodce](deploying-to-production/_static/image8.png)
7. <span data-ttu-id="58dbc-197">V **nastavení** kartu, rozbalte **možností publikování souboru**a pak vyberte **vyloučit soubory z aplikace\_složka dat**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-197">In the **Settings** tab, expand **File Publish Options**, and then select **Exclude files from the App\_Data folder**.</span></span>

    <span data-ttu-id="58dbc-198">Informace o dalších možností v části **možností publikování souboru**, najdete v článku [nasazení do služby IIS](deploying-to-iis.md) kurzu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-198">For information about the other options under **File Publish Options**, see the [deploying to IIS](deploying-to-iis.md) tutorial.</span></span> <span data-ttu-id="58dbc-199">Snímek obrazovky tohoto ukazuje výsledek tohoto kroku a následující kroky konfigurace databáze je na konci kroky konfigurace databáze.</span><span class="sxs-lookup"><span data-stu-id="58dbc-199">The screen shot that shows the result of this step and the following database configuration steps is at the end of the database configuration steps.</span></span>
8. <span data-ttu-id="58dbc-200">V části **objekt DefaultConnection** v **databází** nakonfigurujte nasazení databáze pro databázi členství.</span><span class="sxs-lookup"><span data-stu-id="58dbc-200">Under **DefaultConnection** in the **Databases** section, configure database deployment for the membership database.</span></span>
9. 1. <span data-ttu-id="58dbc-201">Vyberte **aktualizace databáze**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-201">Select **Update database**.</span></span>

        <span data-ttu-id="58dbc-202">**Vzdálený připojovací řetězec** pole pod **objekt DefaultConnection** vyplněné se připojovací řetězec ze souboru .publishsettings. Připojovací řetězec obsahuje přihlašovací údaje SQL serveru, které jsou uložené ve formátu prostého textu v *.pubxml* souboru.</span><span class="sxs-lookup"><span data-stu-id="58dbc-202">The **Remote connection string** box directly below **DefaultConnection** is filled in with the connection string from the .publishsettings file.The connection string includes SQL Server credentials, which are stored in plain text in the *.pubxml* file.</span></span> <span data-ttu-id="58dbc-203">Pokud nechcete uložit je trvale existuje, můžete je odebrat z profilu publikování po nasazení databáze a uložit je do Azure.</span><span class="sxs-lookup"><span data-stu-id="58dbc-203">If you prefer not to store them permanently there, you can remove them from the publish profile after the database is deployed and store them in Azure instead.</span></span> <span data-ttu-id="58dbc-204">Další informace najdete v tématu [tom, jak zabezpečit vaši databázi technologie ASP.NET připojovací řetězce při nasazování do Azure ze zdroje](http://www.hanselman.com/blog/HowToKeepYourASPNETDatabaseConnectionStringsSecureWhenDeployingToAzureFromSource.aspx) na blogu Scott Hanselman.</span><span class="sxs-lookup"><span data-stu-id="58dbc-204">For more information, see [How to keep your ASP.NET database connection strings secure when deploying to Azure from Source](http://www.hanselman.com/blog/HowToKeepYourASPNETDatabaseConnectionStringsSecureWhenDeployingToAzureFromSource.aspx) on Scott Hanselman's blog.</span></span>
      2. <span data-ttu-id="58dbc-205">Klikněte na tlačítko **konfigurovat aktualizace databáze**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-205">Click **Configure database updates**.</span></span>
      3. <span data-ttu-id="58dbc-206">V **konfigurace aktualizací databáze** dialogové okno, klikněte na tlačítko **přidat skript SQL**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-206">In the **Configure Database Updates** dialog box, click **Add SQL Script**.</span></span>
      4. <span data-ttu-id="58dbc-207">V **přidat skript SQL** , přejděte na *aspnet-data-prod.sql* skript, který jste předtím uložili ve složce řešení a potom klikněte na tlačítko **otevřít**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-207">In the **Add SQL Script** box, navigate to the *aspnet-data-prod.sql* script that you saved earlier in the solution folder, and then click **Open**.</span></span>
      5. <span data-ttu-id="58dbc-208">Zavřít **konfigurace aktualizací databáze** dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="58dbc-208">Close the **Configure Database Updates** dialog box.</span></span>
10. <span data-ttu-id="58dbc-209">V části **SchoolContext** v **databází** vyberte **spustit migrace Code First (spuštěno při spuštění aplikace)**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-209">Under **SchoolContext** in the **Databases** section, select **Execute Code First Migrations (runs on application start)**.</span></span>

    <span data-ttu-id="58dbc-210">Visual Studio zobrazí **spustit migrace Code First** místo **aktualizace databáze** pro `DbContext` třídy.</span><span class="sxs-lookup"><span data-stu-id="58dbc-210">Visual Studio displays **Execute Code First Migrations** instead of **Update Database** for `DbContext` classes.</span></span> <span data-ttu-id="58dbc-211">Pokud chcete použít poskytovatele dbDacFx místo migrace nasazení databáze, ke kterým přístup pomocí `DbContext` najdete v tématu [jak nasadit bez migrace Code First databázi?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) v nejčastějších Dotazech nasazení webové aplikace Visual Studio a ASP.NET na webu MSDN.</span><span class="sxs-lookup"><span data-stu-id="58dbc-211">If you want to use the dbDacFx provider instead of Migrations to deploy a database that you access by using a `DbContext` class, see [How do I deploy a Code First database without Migrations?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) in the Web Deployment FAQ for Visual Studio and ASP.NET on MSDN.</span></span>

    <span data-ttu-id="58dbc-212">**Nastavení** kartu teď vypadá jako v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="58dbc-212">The **Settings** tab now looks like the following example:</span></span>

    ![Karta nastavení pro přípravu](deploying-to-production/_static/image9.png)
11. <span data-ttu-id="58dbc-214">Proveďte následující kroky pro uložení profilu a přejmenujte ho na *pracovní*:</span><span class="sxs-lookup"><span data-stu-id="58dbc-214">Perform the following steps to save the profile and rename it to *Staging*:</span></span>

    1. <span data-ttu-id="58dbc-215">Klikněte na tlačítko **profilu** kartu a potom klikněte na tlačítko **spravovat profily**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-215">Click the **Profile** tab, and then click **Manage Profiles**.</span></span>
    2. <span data-ttu-id="58dbc-216">Import vytvořit dvě nové profily, jeden pro FTP a jeden pro nasazení webu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-216">The import created two new profiles, one for FTP and one for Web Deploy.</span></span> <span data-ttu-id="58dbc-217">Nakonfigurovaný profil nasazení webu: přejmenování tohoto profilu *pracovní*.</span><span class="sxs-lookup"><span data-stu-id="58dbc-217">You configured the Web Deploy profile: rename this profile to *Staging*.</span></span>

        ![Přejmenovat profil do přípravného prostředí](deploying-to-production/_static/image10.png)
    3. <span data-ttu-id="58dbc-219">Zavřít **Upravit profily publikování webových** dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="58dbc-219">Close the **Edit Web Publish Profiles** dialog box.</span></span>
    4. <span data-ttu-id="58dbc-220">Zavřít **publikování webu** průvodce.</span><span class="sxs-lookup"><span data-stu-id="58dbc-220">Close the **Publish Web** wizard.</span></span>

### <a name="configure-a-publish-profile-transform-for-the-environment-indicator"></a><span data-ttu-id="58dbc-221">Konfigurace transformace profil publikování pro ukazatel prostředí</span><span class="sxs-lookup"><span data-stu-id="58dbc-221">Configure a publish profile transform for the environment indicator</span></span>

> [!NOTE]
> <span data-ttu-id="58dbc-222">Tato část ukazuje, jak zřídit transformaci Web.config pro ukazatel prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-222">This section shows how to set up a Web.config transform for the environment indicator.</span></span> <span data-ttu-id="58dbc-223">Vzhledem k tomu, se indikátor nachází ve `<appSettings>` element, můžete mít Další alternativou k určení transformace při nasazování do služby Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="58dbc-223">Because the indicator is in the `<appSettings>` element, you have another alternative for specifying the transformation when you're deploying to Azure App Service.</span></span> <span data-ttu-id="58dbc-224">Další informace najdete v tématu [nastavení zadáte Web.config v Azure](web-config-transformations.md#watransforms).</span><span class="sxs-lookup"><span data-stu-id="58dbc-224">For more information, see [Specifying Web.config settings in Azure](web-config-transformations.md#watransforms).</span></span>


1. <span data-ttu-id="58dbc-225">V **Průzkumníka řešení**, rozbalte **vlastnosti**a potom rozbalte **PublishProfiles**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-225">In **Solution Explorer**, expand **Properties**, and then expand **PublishProfiles**.</span></span>
2. <span data-ttu-id="58dbc-226">Klikněte pravým tlačítkem na *Staging.pubxml*a potom klikněte na tlačítko **přidat konfigurační transformace**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-226">Right-click *Staging.pubxml*, and then click **Add Config Transform**.</span></span>

    ![Přidat konfigurační transformaci pro přípravu](deploying-to-production/_static/image11.png)

    <span data-ttu-id="58dbc-228">Visual Studio vytvoří *Web.Staging.config* transformační soubor a otevře jej.</span><span class="sxs-lookup"><span data-stu-id="58dbc-228">Visual Studio creates the *Web.Staging.config* transform file and opens it.</span></span>
3. <span data-ttu-id="58dbc-229">V *Web.Staging.config* transformovat soubor, vložte následující kód bezprostředně po otevření `configuration` značky.</span><span class="sxs-lookup"><span data-stu-id="58dbc-229">In the *Web.Staging.config* transform file, insert the following code immediately after the opening `configuration` tag.</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample1.xml)]

    <span data-ttu-id="58dbc-230">Když použijete pracovní profil publikování, nastaví Tato transformace na indikátor prostředí a "Produkční".</span><span class="sxs-lookup"><span data-stu-id="58dbc-230">When you use the Staging publish profile, this transform sets the environment indicator to "Prod".</span></span> <span data-ttu-id="58dbc-231">V nasazené webové aplikace neuvidíte žádné přípony, jako je například "(vývoj)" nebo "(testovací)" po nadpis H1 "University společnosti Contoso".</span><span class="sxs-lookup"><span data-stu-id="58dbc-231">In the deployed web app, you won't see any suffix such as "(Dev)" or "(Test)" after the "Contoso University" H1 heading.</span></span>
4. <span data-ttu-id="58dbc-232">Klikněte pravým tlačítkem myši *Web.Staging.config* souboru a klikněte na tlačítko **transformace ve verzi Preview** abyste měli jistotu, že transformace kódování vytvoří očekávané změny.</span><span class="sxs-lookup"><span data-stu-id="58dbc-232">Right-click the *Web.Staging.config* file and click **Preview Transform** to make sure that the transform you coded produces the expected changes.</span></span>

    <span data-ttu-id="58dbc-233">**Náhled souboru Web.config** okno zobrazuje výsledek použití i *Web.Release.config* transformuje a *Web.Staging.config* transformace.</span><span class="sxs-lookup"><span data-stu-id="58dbc-233">The **Web.config Preview** window shows the result of applying both the *Web.Release.config* transforms and the *Web.Staging.config* transforms.</span></span>

### <a name="prevent-public-use-of-the-test-app"></a><span data-ttu-id="58dbc-234">Zabránit veřejně přístupný test aplikace</span><span class="sxs-lookup"><span data-stu-id="58dbc-234">Prevent public use of the test app</span></span>

<span data-ttu-id="58dbc-235">Což je důležité pro pracovní aplikace je, že je na Internetu, ale nechcete, aby veřejně ji používat.</span><span class="sxs-lookup"><span data-stu-id="58dbc-235">An important consideration for the staging app is that it will be live on the Internet, but you don't want the public to use it.</span></span> <span data-ttu-id="58dbc-236">Chcete-li minimalizovat pravděpodobnost, že lidé najít, který se použije, můžete použít jeden nebo více z následujících metod:</span><span class="sxs-lookup"><span data-stu-id="58dbc-236">To minimize the likelihood that people will find and use it, you can use one or more of the following methods:</span></span>

- <span data-ttu-id="58dbc-237">Nastavte pravidla brány firewall, která umožňují přístup k pracovní aplikace jenom z IP adresy, které můžete použít k testování přípravy.</span><span class="sxs-lookup"><span data-stu-id="58dbc-237">Set firewall rules that allow access to the staging app only from IP addresses that you use to test staging.</span></span>
- <span data-ttu-id="58dbc-238">Použijte obfuskovaný adresu URL, která by jinak nebylo možné uhodnout.</span><span class="sxs-lookup"><span data-stu-id="58dbc-238">Use an obfuscated URL that would be impossible to guess.</span></span>
- <span data-ttu-id="58dbc-239">Vytvoření *robots.txt* souboru k zajištění, že nesmí být z vyhledávací weby procházení k němu testovací aplikace a sestava odkazy ve výsledcích hledání.</span><span class="sxs-lookup"><span data-stu-id="58dbc-239">Create a *robots.txt* file to ensure that search engines will not crawl the test app and report links to it in search results.</span></span>

<span data-ttu-id="58dbc-240">První z těchto metod je nejúčinnější, ale není součástí v tomto kurzu, protože by vyžadovalo, můžete nasadit do cloudové služby Azure, namísto služby Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="58dbc-240">The first of these methods is the most effective but is not covered in this tutorial because it would require that you deploy to an Azure Cloud Service instead of Azure App Service.</span></span> <span data-ttu-id="58dbc-241">Další informace o službách Cloud Services a omezení IP adres v Azure najdete v tématu [možnosti hostování výpočtů poskytované platformou Azure](https://docs.microsoft.com/azure/cloud-services/cloud-services-choose-me) a [bloku konkrétní IP adresy v přístupu k webové roli](https://msdn.microsoft.com/library/windowsazure/jj154098.aspx).</span><span class="sxs-lookup"><span data-stu-id="58dbc-241">For more information about Cloud Services and IP restrictions in Azure, see [Compute Hosting Options Provided by Azure](https://docs.microsoft.com/azure/cloud-services/cloud-services-choose-me) and [Block Specific IP Addresses from Accessing a Web Role](https://msdn.microsoft.com/library/windowsazure/jj154098.aspx).</span></span> <span data-ttu-id="58dbc-242">Pokud provádíte nasazení do poskytovatele hostitelských služeb třetích stran, obraťte se na poskytovatele a zjistěte, jak implementovat omezení IP adres.</span><span class="sxs-lookup"><span data-stu-id="58dbc-242">If you are deploying to a third-party hosting provider, contact the provider to find out how to implement IP restrictions.</span></span>

<span data-ttu-id="58dbc-243">V tomto kurzu vytvoříte *robots.txt* souboru.</span><span class="sxs-lookup"><span data-stu-id="58dbc-243">For this tutorial, you'll create a *robots.txt* file.</span></span>

1. <span data-ttu-id="58dbc-244">V **Průzkumníka řešení**, klikněte pravým tlačítkem na projekt ContosoUniversity a klikněte na tlačítko **přidat novou položku**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-244">In **Solution Explorer**, right-click the ContosoUniversity project and click **Add New Item**.</span></span>
2. <span data-ttu-id="58dbc-245">Vytvořte nový **textový soubor** s názvem *robots.txt*a vložte následující text:</span><span class="sxs-lookup"><span data-stu-id="58dbc-245">Create a new **Text File** named *robots.txt*, and put the following text in it:</span></span>

    [!code-console[Main](deploying-to-production/samples/sample2.cmd)]

    <span data-ttu-id="58dbc-246">`User-agent` Řádek říká vyhledávací weby, které v souboru pravidla se vztahují na všechny vyhledávací modul web prohledávací moduly (roboty), a `Disallow` řádek určuje, že by bylo žádné stránky na webu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-246">The `User-agent` line tells search engines that the rules in the file apply to all search engine web crawlers (robots), and the `Disallow` line specifies that no pages on the site should be crawled.</span></span>

    <span data-ttu-id="58dbc-247">Chcete vyhledávací weby snadněji katalogu produkční aplikace, takže je třeba vyloučit tento soubor z produkčního nasazení.</span><span class="sxs-lookup"><span data-stu-id="58dbc-247">You do want search engines to catalog your production app, so you need to exclude this file from production deployment.</span></span> <span data-ttu-id="58dbc-248">Provedete to, že nakonfigurujete nastavení v produkční profil publikování po jeho vytvoření.</span><span class="sxs-lookup"><span data-stu-id="58dbc-248">To do that, you'll configure a setting in the Production publish profile when you create it.</span></span>

### <a name="deploy-to-staging"></a><span data-ttu-id="58dbc-249">Nasazení do přípravného prostředí</span><span class="sxs-lookup"><span data-stu-id="58dbc-249">Deploy to staging</span></span>

1. <span data-ttu-id="58dbc-250">Otevřít **Publikovat Web** Průvodce pravým tlačítkem myši projekt Contoso University a kliknutím na **publikovat**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-250">Open the **Publish Web** wizard by right-clicking the Contoso University project and clicking **Publish**.</span></span>
2. <span data-ttu-id="58dbc-251">Ujistěte se, že **pracovní** vybraný profil.</span><span class="sxs-lookup"><span data-stu-id="58dbc-251">Make sure that the **Staging** profile is selected.</span></span>
3. <span data-ttu-id="58dbc-252">Klikněte na tlačítko **publikovat**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-252">Click **Publish**.</span></span>

    <span data-ttu-id="58dbc-253">**Výstup** okno zobrazuje, jaké akce nasazení byly provedeny a oznámí úspěšné dokončení nasazení.</span><span class="sxs-lookup"><span data-stu-id="58dbc-253">The **Output** window shows what deployment actions were taken and reports successful completion of the deployment.</span></span> <span data-ttu-id="58dbc-254">K adrese URL nasazené webové aplikace se automaticky otevře výchozí prohlížeč.</span><span class="sxs-lookup"><span data-stu-id="58dbc-254">The default browser automatically opens to the URL of the deployed web app.</span></span>

## <a name="test-in-the-staging-environment"></a><span data-ttu-id="58dbc-255">Testování v testovacím prostředí</span><span class="sxs-lookup"><span data-stu-id="58dbc-255">Test in the staging environment</span></span>

<span data-ttu-id="58dbc-256">Všimněte si, že chybí ukazatel prostředí (neexistuje žádný "()" nebo "(vývoj)" po nadpis H1, který ukazuje, že *Web.config* transformace pro ukazatel prostředí bylo úspěšné.</span><span class="sxs-lookup"><span data-stu-id="58dbc-256">Notice that the environment indicator is absent (there is no "(Test)" or "(Dev)" after the H1 heading, which shows that the *Web.config* transformation for the environment indicator was successful.</span></span>

![Domovská stránka pracovní](deploying-to-production/_static/image12.png)

<span data-ttu-id="58dbc-258">Spustit **studenty** stránku a ověřte, zda má nasazené databáze se žádní studenti.</span><span class="sxs-lookup"><span data-stu-id="58dbc-258">Run the **Students** page to verify that the deployed database has no students.</span></span>

<span data-ttu-id="58dbc-259">Spustit **Instruktoři** stránku a ověřte, že Code First naplnila databázi s instruktorem dat:</span><span class="sxs-lookup"><span data-stu-id="58dbc-259">Run the **Instructors** page to verify that Code First seeded the database with instructor data:</span></span>

<span data-ttu-id="58dbc-260">Vyberte **přidat studenty** z **studenty** přidat student nabídky a pak zobrazit nového objektu student do **studenty** stránku a ověřte, že můžete úspěšně zapisovat do databáze .</span><span class="sxs-lookup"><span data-stu-id="58dbc-260">Select **Add Students** from the **Students** menu, add a student, and then view the new student in the **Students** page to verify that you can successfully write to the database.</span></span>

<span data-ttu-id="58dbc-261">Z **kurzy** klikněte na **aktualizace kredity**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-261">From the **Courses** page, click **Update Credits**.</span></span> <span data-ttu-id="58dbc-262">**Aktualizace kredity** stránka vyžaduje oprávnění správce, proto **přihlásit** zobrazí se stránka.</span><span class="sxs-lookup"><span data-stu-id="58dbc-262">The **Update Credits** page requires administrator permissions, so the **Log In** page is displayed.</span></span> <span data-ttu-id="58dbc-263">Zadejte přihlašovací údaje účtu správce, které jste vytvořili dříve ("admin" a "prodpwd").</span><span class="sxs-lookup"><span data-stu-id="58dbc-263">Enter the administrator account credentials that you created earlier ("admin" and "prodpwd").</span></span> <span data-ttu-id="58dbc-264">**Aktualizace kredity** se zobrazí stránka, která ověřuje, že účet správce, který jste vytvořili v předchozím kurzu byla správně nasazena do testovacího prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-264">The **Update Credits** page is displayed, which verifies that the administrator account that you created in the previous tutorial was correctly deployed to the test environment.</span></span>

<span data-ttu-id="58dbc-265">Neplatná adresa URL způsobí chybu, že ELMAH sledovat a následně požadovat zprávy o chybách ELMAH žádosti.</span><span class="sxs-lookup"><span data-stu-id="58dbc-265">Request an invalid URL to cause an error that ELMAH will track, and then request the ELMAH error report.</span></span> <span data-ttu-id="58dbc-266">Pokud provádíte nasazení do poskytovatele hostitelských služeb třetích stran, pravděpodobně zjistíte, že sestava je prázdná ze stejného důvodu, který byl prázdný v předchozím kurzu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-266">If you are deploying to a third-party hosting provider, you will probably find that the report is empty for the same reason that it was empty in the previous tutorial.</span></span> <span data-ttu-id="58dbc-267">Budete muset použít nástroje pro správu účtu poskytovatele hostingu nakonfigurovat oprávnění složky umožňující ELMAH zapisovat do složky protokolů.</span><span class="sxs-lookup"><span data-stu-id="58dbc-267">You will have to use the hosting provider's account management tools to configure folder permissions to enable ELMAH to write to the log folder.</span></span>

<span data-ttu-id="58dbc-268">Vytvořená aplikace je nyní spuštěna v cloudu ve webové aplikaci, která je stejně jako bude používat pro produkční prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-268">The application that you created is now running in the cloud in a web app that is just like what you will use for production.</span></span> <span data-ttu-id="58dbc-269">Vzhledem k tomu, že všechno funguje správně, je dalším krokem je nasazení do produkčního prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-269">Since everything is working correctly, the next step is to deploy to production.</span></span>

## <a name="deploy-to-production"></a><span data-ttu-id="58dbc-270">Nasazení do produkčního prostředí</span><span class="sxs-lookup"><span data-stu-id="58dbc-270">Deploy to production</span></span>

<span data-ttu-id="58dbc-271">Proces pro vytvoření webové aplikace v produkčním prostředí a nasazení do produkčního prostředí je stejná jako pracovní, s tím rozdílem, že je třeba vyloučit *robots.txt* z nasazení.</span><span class="sxs-lookup"><span data-stu-id="58dbc-271">The process for creating a production web app and deploying to production is the same as for staging, except that you need to exclude the *robots.txt* from deployment.</span></span> <span data-ttu-id="58dbc-272">K tomu budete upravovat soubor profilu publikování.</span><span class="sxs-lookup"><span data-stu-id="58dbc-272">To do that you'll edit the publish profile file.</span></span>

### <a name="create-the-production-environment-and-the-production-publish-profile"></a><span data-ttu-id="58dbc-273">Vytvoření produkčního prostředí a produkční profil publikování</span><span class="sxs-lookup"><span data-stu-id="58dbc-273">Create the production environment and the production publish profile</span></span>

1. <span data-ttu-id="58dbc-274">Vytvoření produkční webové aplikace a databáze v Azure, stejným způsobem, který jste použili pro přípravu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-274">Create the production web app and database in Azure, following the same procedure that you used for staging.</span></span>

    <span data-ttu-id="58dbc-275">Při vytváření databáze, můžete chtít umístit na stejný server, který jste vytvořili dříve nebo vytvořit nový server.</span><span class="sxs-lookup"><span data-stu-id="58dbc-275">When you create the database, you can choose to put it on the same server you created earlier, or create a new server.</span></span>
2. <span data-ttu-id="58dbc-276">Stáhněte si *.publishsettings* souboru.</span><span class="sxs-lookup"><span data-stu-id="58dbc-276">Download the *.publishsettings* file.</span></span>
3. <span data-ttu-id="58dbc-277">Vytvořte profil publikování pomocí importu produkční *.publishsettings* souboru stejného postupu, který jste použili pro přípravu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-277">Create the publish profile by importing the production *.publishsettings* file, following the same procedure that you used for staging.</span></span>

    <span data-ttu-id="58dbc-278">Nezapomeňte nakonfigurovat skript nasazení dat. pod **objekt DefaultConnection** v **databází** část **nastavení** kartu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-278">Don't forget to configure the data deployment script under **DefaultConnection** in the **Databases** section of the **Settings** tab.</span></span>
4. <span data-ttu-id="58dbc-279">Přejmenovat profil publikování *produkční*.</span><span class="sxs-lookup"><span data-stu-id="58dbc-279">Rename the publish profile to *Production*.</span></span>
5. <span data-ttu-id="58dbc-280">Konfigurace transformace profil publikování pro ukazatel prostředí, stejným způsobem, který jste použili pro pracovní...</span><span class="sxs-lookup"><span data-stu-id="58dbc-280">Configure a publish profile transform for the environment indicator, following the same procedure that you used for staging..</span></span>

### <a name="edit-the-pubxml-file-to-exclude-robotstxt"></a><span data-ttu-id="58dbc-281">Upravte soubor .pubxml vyloučit robots.txt</span><span class="sxs-lookup"><span data-stu-id="58dbc-281">Edit the .pubxml file to exclude robots.txt</span></span>

<span data-ttu-id="58dbc-282">Soubory jsou pojmenovány profil publikování &lt;profilename&gt;*.pubxml* a jsou umístěny v *PublishProfiles* složky.</span><span class="sxs-lookup"><span data-stu-id="58dbc-282">Publish profile files are named &lt;profilename&gt;*.pubxml* and are located in the *PublishProfiles* folder.</span></span> <span data-ttu-id="58dbc-283">*PublishProfiles* složky *vlastnosti* složky ve webové aplikaci C# v části projekt *Můj projekt* složky v projektu VB webové aplikace nebo v rámci *Aplikace\_Data* složky v projektu webové aplikace.</span><span class="sxs-lookup"><span data-stu-id="58dbc-283">The *PublishProfiles* folder is under the *Properties* folder in a C# web application project, under the *My Project* folder in a VB web application project, or under the *App\_Data* folder in a web app project.</span></span> <span data-ttu-id="58dbc-284">Každý *.pubxml* soubor obsahuje nastavení, které se vztahují na jeden profil publikování.</span><span class="sxs-lookup"><span data-stu-id="58dbc-284">Each *.pubxml* file contains settings that apply to one publish profile.</span></span> <span data-ttu-id="58dbc-285">Hodnoty, které zadáte v Průvodci Publikovat Web se ukládají v těchto souborech a můžete je vytvořit nebo změnit nastavení, které nejsou k dispozici v Uživatelském rozhraní aplikace Visual Studio upravit.</span><span class="sxs-lookup"><span data-stu-id="58dbc-285">The values you enter in the Publish Web wizard are stored in these files, and you can edit them to create or change settings that aren't made available in the Visual Studio UI.</span></span>

<span data-ttu-id="58dbc-286">Ve výchozím nastavení *.pubxml* soubory jsou zahrnuty v projektu, když vytvoříte profil publikování, ale můžete je vyloučit z projektu a je stále používají Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="58dbc-286">By default, *.pubxml* files are included in the project when you create a publish profile, but you can exclude them from the project and Visual Studio will still use them.</span></span> <span data-ttu-id="58dbc-287">Visual Studio vyhledá *PublishProfiles* složku pro *.pubxml* soubory, bez ohledu na to, zda jsou zahrnuty v projektu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-287">Visual Studio looks in the *PublishProfiles* folder for *.pubxml* files, regardless of whether they are included in the project.</span></span>

<span data-ttu-id="58dbc-288">Pro každou *.pubxml* soubor existuje *. pubxml.user* souboru.</span><span class="sxs-lookup"><span data-stu-id="58dbc-288">For each *.pubxml* file there is a *.pubxml.user* file.</span></span> <span data-ttu-id="58dbc-289">*. Pubxml.user* soubor obsahuje šifrované heslo, pokud jste vybrali **uložit heslo** možnost a ve výchozím nastavení je vyloučený z projektu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-289">The *.pubxml.user* file contains the encrypted password if you selected the **Save password** option, and by default it is excluded from the project.</span></span>

<span data-ttu-id="58dbc-290">A *.pubxml* soubor obsahuje nastavení, které se týkají konkrétní Publikovat profil.</span><span class="sxs-lookup"><span data-stu-id="58dbc-290">A *.pubxml* file contains the settings that pertain to a specific publish profile.</span></span> <span data-ttu-id="58dbc-291">Pokud chcete nakonfigurovat nastavení, které se vztahují na všechny profily, můžete vytvořit *. wpp.targets* souboru.</span><span class="sxs-lookup"><span data-stu-id="58dbc-291">If you want to configure settings that apply to all profiles, you can create a *.wpp.targets* file.</span></span> <span data-ttu-id="58dbc-292">Importuje tyto soubory do procesu sestavení *.csproj* nebo *.vbproj* souboru projektu, takže většinu nastavení, které můžete nakonfigurovat v souboru projektu se dá nakonfigurovat v těchto souborů.</span><span class="sxs-lookup"><span data-stu-id="58dbc-292">The build process imports these files into the *.csproj* or *.vbproj* project file, so most settings that you can configure in the project file can be configured in these files.</span></span> <span data-ttu-id="58dbc-293">Další informace o *.pubxml* soubory a *. wpp.targets* soubory, naleznete v tématu [postupy: Úprava nastavení nasazení v souborech profil publikování (.pubxml) a. wpp.targets souboru v sadě Visual Studio Webové projekty](https://msdn.microsoft.com/library/ff398069.aspx).</span><span class="sxs-lookup"><span data-stu-id="58dbc-293">For more information about *.pubxml* files and *.wpp.targets* files, see [How to: Edit Deployment Settings in Publish Profile (.pubxml) Files and the .wpp.targets File in Visual Studio Web Projects](https://msdn.microsoft.com/library/ff398069.aspx).</span></span>

1. <span data-ttu-id="58dbc-294">V **Průzkumníka řešení**, rozbalte **vlastnosti** a rozbalte **PublishProfiles**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-294">In **Solution Explorer**, expand **Properties** and expand **PublishProfiles**.</span></span>
2. <span data-ttu-id="58dbc-295">Klikněte pravým tlačítkem na *Production.pubxml* a klikněte na tlačítko **otevřít**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-295">Right-click *Production.pubxml* and click **Open**.</span></span>

    ![Otevřete soubor .pubxml](deploying-to-production/_static/image13.png)
3. <span data-ttu-id="58dbc-297">Klikněte pravým tlačítkem na *Production.pubxml* a klikněte na tlačítko **otevřít**.</span><span class="sxs-lookup"><span data-stu-id="58dbc-297">Right-click *Production.pubxml* and click **Open**.</span></span>
4. <span data-ttu-id="58dbc-298">Přidejte následující řádky bezprostředně před uzavírací `PropertyGroup` element:</span><span class="sxs-lookup"><span data-stu-id="58dbc-298">Add the following lines immediately before the closing `PropertyGroup` element:</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample3.xml)]

    <span data-ttu-id="58dbc-299">Soubor .pubxml teď vypadá jako v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="58dbc-299">The .pubxml file now looks like the following example:</span></span>

    [!code-xml[Main](deploying-to-production/samples/sample4.xml?highlight=18-20)]

    <span data-ttu-id="58dbc-300">Další informace o tom, jak vyloučit soubory a složky, najdete v části [můžu vyloučit určité soubory nebo složky z nasazení?](https://msdn.microsoft.com/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment) v **webové nasazení – nejčastější dotazy pro Visual Studio a ASP.NET** na webové stránce MSDN.</span><span class="sxs-lookup"><span data-stu-id="58dbc-300">For more information about how to exclude files and folders, see [Can I exclude specific files or folders from deployment?](https://msdn.microsoft.com/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment) in the **Web Deployment FAQ for Visual Studio and ASP.NET** on MSDN.</span></span>

### <a name="deploy-to-production"></a><span data-ttu-id="58dbc-301">Nasazení do produkčního prostředí</span><span class="sxs-lookup"><span data-stu-id="58dbc-301">Deploy to production</span></span>

1. <span data-ttu-id="58dbc-302">Otevřít **Publikovat Web** Průvodce Ujistěte se, že **produkční** profil publikování je vybrána a potom klikněte na tlačítko **spustit Náhled** na **Preview**kartu a ověřte, že *robots.txt* soubor nebude zkopírován do produkční aplikace.</span><span class="sxs-lookup"><span data-stu-id="58dbc-302">Open the **Publish Web** wizard make sure that the **Production** publish profile is selected, and then click **Start Preview** on the **Preview** tab to verify that the *robots.txt* file will not be copied to the production app.</span></span>

    ![Náhled souborů, které mají být publikovány do produkčního prostředí](deploying-to-production/_static/image14.png)

    <span data-ttu-id="58dbc-304">Projděte si seznam souborů, které budou zkopírovány.</span><span class="sxs-lookup"><span data-stu-id="58dbc-304">Review the list of files that will be copied.</span></span> <span data-ttu-id="58dbc-305">Uvidíte, že všechny *.cs* souborů, včetně *. aspx.cs*, *. aspx.designer.cs*, *Master.cs*, a  *Master.Designer.cs* soubory jsou vynechány.</span><span class="sxs-lookup"><span data-stu-id="58dbc-305">You'll see that all of the *.cs* files, including *.aspx.cs*, *.aspx.designer.cs*, *Master.cs*, and *Master.designer.cs* files are omitted.</span></span> <span data-ttu-id="58dbc-306">Veškerý tento kód byl zkompilován do *ContosoUniversity.dll* a *ContosUniversity.pdb* soubory, které najdete v *bin* složky.</span><span class="sxs-lookup"><span data-stu-id="58dbc-306">All of this code has been compiled into the *ContosoUniversity.dll* and *ContosUniversity.pdb* files that you'll find in the *bin* folder.</span></span> <span data-ttu-id="58dbc-307">Protože pouze *.dll* , je potřeba spustit aplikaci a nastavili, že by měly být nasazeny pouze soubory potřebné ke spuštění aplikace, ne *.cs* soubory byly zkopírovány do cíle prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-307">Because only the *.dll* is needed to run the application, and you specified earlier that only files needed to run the application should be deployed, no *.cs* files were copied to the destination environment.</span></span> <span data-ttu-id="58dbc-308">*Obj* složky a *ContosoUniversity.csproj* a *. csproj.user* soubory jsou vynechány ze stejného důvodu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-308">The *obj* folder and the *ContosoUniversity.csproj* and *.csproj.user* files are omitted for the same reason.</span></span>

    <span data-ttu-id="58dbc-309">Klikněte na tlačítko **publikovat** k nasazení do produkčního prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-309">Click **Publish** to deploy to the production environment.</span></span>
2. <span data-ttu-id="58dbc-310">Testování v produkčním prostředí, stejným způsobem, který jste použili pro přípravu.</span><span class="sxs-lookup"><span data-stu-id="58dbc-310">Test in production, following the same procedure you used for staging.</span></span>

    <span data-ttu-id="58dbc-311">Všechno, co je stejný jako pracovní, s výjimkou adresy URL a absenci *robots.txt* souboru.</span><span class="sxs-lookup"><span data-stu-id="58dbc-311">Everything is identical to staging except for the URL and the absence of the *robots.txt* file.</span></span>

## <a name="summary"></a><span data-ttu-id="58dbc-312">Souhrn</span><span class="sxs-lookup"><span data-stu-id="58dbc-312">Summary</span></span>

<span data-ttu-id="58dbc-313">Budete mít teď úspěšně nasadila a otestovala vaší webové aplikace a je k dispozici veřejně přes Internet.</span><span class="sxs-lookup"><span data-stu-id="58dbc-313">You have now successfully deployed and tested your web app and it is available publicly over the Internet.</span></span>

![Domovská stránka výroby](deploying-to-production/_static/image15.png)

<span data-ttu-id="58dbc-315">V dalším kurzu budete moct aktualizovat kód aplikace a nasadit změny do prostředí test, přípravném nebo produkčním prostředí.</span><span class="sxs-lookup"><span data-stu-id="58dbc-315">In the next tutorial, you'll update application code and deploy the change to the test, staging, and production environments.</span></span>

> [!NOTE]
> <span data-ttu-id="58dbc-316">Když vaše aplikace je používána v produkčním prostředí by měla implementace plánu obnovení.</span><span class="sxs-lookup"><span data-stu-id="58dbc-316">While your application is in use in the production environment you should be implementing a recovery plan.</span></span> <span data-ttu-id="58dbc-317">To znamená je by měly být pravidelně zálohování databází z produkční aplikace do zabezpečeného úložiště a by měl udržování několika generací tyto zálohy.</span><span class="sxs-lookup"><span data-stu-id="58dbc-317">That is, you should be periodically backing up your databases from the production app to a secure storage location, and you should be keeping several generations of such backups.</span></span> <span data-ttu-id="58dbc-318">Při aktualizaci databáze, měli byste zajistit záložní kopie z bezprostředně před provedením změny.</span><span class="sxs-lookup"><span data-stu-id="58dbc-318">When you update the database, you should make a backup copy from immediately before the change.</span></span> <span data-ttu-id="58dbc-319">Potom Pokud došlo k chybě a není objevit až po jeho nasazení do produkčního prostředí, stále budete moci obnovit databázi do stavu, ve kterém byl předtím, než začal být poškozen.</span><span class="sxs-lookup"><span data-stu-id="58dbc-319">Then, if you make a mistake and don't discover it until after you have deployed it to production, you will still be able to recover the database to the state it was in before it became corrupted.</span></span> <span data-ttu-id="58dbc-320">Další informace najdete v tématu [Azure SQL Database zálohování a obnovení](https://msdn.microsoft.com/library/windowsazure/jj650016.aspx).</span><span class="sxs-lookup"><span data-stu-id="58dbc-320">For more information, see [Azure SQL Database Backup and Restore](https://msdn.microsoft.com/library/windowsazure/jj650016.aspx).</span></span>
> 
> 
> [!NOTE]
> <span data-ttu-id="58dbc-321">V tomto kurzu systému SQL Server je edici, která nasazujete do Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="58dbc-321">In this tutorial the SQL Server edition that you are deploying to is Azure SQL Database.</span></span> <span data-ttu-id="58dbc-322">Během procesu nasazení se podobně jako jiné edice systému SQL Server, skutečné produkční aplikace můžou vyžadovat zvláštní kód pro Azure SQL Database v některých scénářích.</span><span class="sxs-lookup"><span data-stu-id="58dbc-322">While the deployment process is similar to other editions of SQL Server, a real production application might require special code for Azure SQL Database in some scenarios.</span></span> <span data-ttu-id="58dbc-323">Další informace najdete v tématu [pracovat se službou Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdb) a [výběru mezi SQL serverem a Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdbchoosing).</span><span class="sxs-lookup"><span data-stu-id="58dbc-323">For more information, see [Working with Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdb) and [Choosing between SQL Server and Azure SQL Database](../../../../whitepapers/aspnet-data-access-content-map.md#ssdbchoosing).</span></span>
> 
> [!div class="step-by-step"]
> <span data-ttu-id="58dbc-324">[Předchozí](setting-folder-permissions.md)
> [další](deploying-a-code-update.md)</span><span class="sxs-lookup"><span data-stu-id="58dbc-324">[Previous](setting-folder-permissions.md)
[Next](deploying-a-code-update.md)</span></span>
