---
uid: whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
title: 'Postupy: Přidání mobilních stránek do webových formulářů nebo aplikace MVC | Dokumentace Microsoftu'
author: rick-anderson
description: Tento postup popisuje různé způsoby, jak poskytovat stránky optimalizované pro mobilní zařízení z webových formulářů ASP.NET / aplikace MVC a navrhne architektury a...
ms.author: riande
ms.date: 01/20/2011
ms.assetid: 3124f28e-cc32-418a-afe3-519fa56f4c36
msc.legacyurl: /whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
msc.type: content
ms.openlocfilehash: 1693838a74f0564e38e11a2827cceb3d6474677b
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 08/16/2018
ms.locfileid: "41755709"
---
<a name="how-to-add-mobile-pages-to-your-aspnet-web-forms--mvc-application"></a><span data-ttu-id="47134-103">Postupy: Přidání mobilních stránek do webových formulářů nebo aplikace MVC</span><span class="sxs-lookup"><span data-stu-id="47134-103">How To: Add Mobile Pages to Your ASP.NET Web Forms / MVC Application</span></span>
====================
> <span data-ttu-id="47134-104">**Platí pro**</span><span class="sxs-lookup"><span data-stu-id="47134-104">**Applies To**</span></span>
> 
> - <span data-ttu-id="47134-105">Verze webových formulářů technologie ASP.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="47134-105">ASP.NET Web Forms version 4.0</span></span>
> - <span data-ttu-id="47134-106">ASP.NET MVC verze 3.0</span><span class="sxs-lookup"><span data-stu-id="47134-106">ASP.NET MVC version 3.0</span></span>
> 
> <span data-ttu-id="47134-107">**Shrnutí**</span><span class="sxs-lookup"><span data-stu-id="47134-107">**Summary**</span></span>
> 
> <span data-ttu-id="47134-108">Tento postup popisuje různé způsoby, jak poskytovat stránky optimalizované pro mobilní zařízení z webových formulářů ASP.NET / aplikace MVC a navrhne architektury a návrhu problémy, které je třeba zvážit při cílení na široké škále zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-108">This How To describes various ways to serve pages optimized for mobile devices from your ASP.NET Web Forms / MVC application, and suggests architectural and design issues to consider when targeting a broad range of devices.</span></span> <span data-ttu-id="47134-109">Tento dokument popisuje taky, proč jsou nyní zastaralé technologie ASP.NET Mobile ovládací prvky technologie ASP.NET 2.0 3.5 a tento článek popisuje některé moderní alternativy.</span><span class="sxs-lookup"><span data-stu-id="47134-109">This document also explains why the ASP.NET Mobile Controls from ASP.NET 2.0 to 3.5 are now obsolete, and discusses some modern alternatives.</span></span>


## <a name="contents"></a><span data-ttu-id="47134-110">Obsah</span><span class="sxs-lookup"><span data-stu-id="47134-110">Contents</span></span>

- <span data-ttu-id="47134-111">Přehled</span><span class="sxs-lookup"><span data-stu-id="47134-111">Overview</span></span>
- <span data-ttu-id="47134-112">Možnosti architektury</span><span class="sxs-lookup"><span data-stu-id="47134-112">Architectural options</span></span>
- <span data-ttu-id="47134-113">Zjišťování prohlížeče a zařízení</span><span class="sxs-lookup"><span data-stu-id="47134-113">Browser and device detection</span></span>
- <span data-ttu-id="47134-114">Jak aplikace webových formulářů ASP.NET sebou může nést stránek specifických pro mobilní zařízení</span><span class="sxs-lookup"><span data-stu-id="47134-114">How ASP.NET Web Forms applications can present mobile-specific pages</span></span>
- <span data-ttu-id="47134-115">Jak aplikace ASP.NET MVC sebou může nést stránek specifických pro mobilní zařízení</span><span class="sxs-lookup"><span data-stu-id="47134-115">How ASP.NET MVC applications can present mobile-specific pages</span></span>
- <span data-ttu-id="47134-116">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="47134-116">Additional resources</span></span>

<span data-ttu-id="47134-117">Ukázky ke stažení kódu demonstrace techniky dokument white paper pro webové formuláře ASP.NET a MVC najdete v tématu [Mobile Apps & servery s technologií ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="47134-117">For downloadable code samples demonstrating this white paper's techniques for both ASP.NET Web Forms and MVC, see [Mobile Apps & Sites with ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span></span>

## <a name="overview"></a><span data-ttu-id="47134-118">Přehled</span><span class="sxs-lookup"><span data-stu-id="47134-118">Overview</span></span>

<span data-ttu-id="47134-119">Mobilní zařízení – smartphony, funkce telefonů a tabletů – i nadále poroste popularita jako způsob pro přístup k webu.</span><span class="sxs-lookup"><span data-stu-id="47134-119">Mobile devices – smartphones, feature phones, and tablets – continue to grow in popularity as a means to access the Web.</span></span> <span data-ttu-id="47134-120">Pro mnoho webovým vývojářům a objektově orientovaný firmám to znamená, že je stále potřeba zajistit skvělé možnosti procházení pro návštěvníky pomocí těchto zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-120">For many web developers and web-oriented businesses, this means it's increasingly important to provide a great browsing experience for visitors using those devices.</span></span>

### <a name="how-earlier-versions-of-aspnet-supported-mobile-browsers"></a><span data-ttu-id="47134-121">Jak starší verze technologie ASP.NET podporovány mobilních prohlížečů</span><span class="sxs-lookup"><span data-stu-id="47134-121">How earlier versions of ASP.NET supported mobile browsers</span></span>

<span data-ttu-id="47134-122">Technologie ASP.NET verze 2.0 na 3.5 zahrnuté *mobilní ovládací prvky ASP.NET*: sady serverových ovládacích prvků pro mobilní zařízení v *System.Web.Mobile.dll* sestavení a  *System.Web.UI.MobileControls* oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="47134-122">ASP.NET versions 2.0 to 3.5 included *ASP.NET Mobile Controls*: a set of server controls for mobile devices in the *System.Web.Mobile.dll* assembly and the *System.Web.UI.MobileControls* namespace.</span></span> <span data-ttu-id="47134-123">Sestavení je zahrnutá v technologii ASP.NET 4, ale je zastaralé.</span><span class="sxs-lookup"><span data-stu-id="47134-123">The assembly is still included in ASP.NET 4, but it is deprecated.</span></span> <span data-ttu-id="47134-124">Vývojářům doporučujeme migrovat na Modernější přístupy, například těch popsaných v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="47134-124">Developers are advised to migrate to more modern approaches, such as those described in this paper.</span></span>

<span data-ttu-id="47134-125">Důvod, proč mobilní ovládací prvky technologie ASP.NET jsou označené jako zastaralé je, že jejich návrhu je orientovaný kolem mobilních telefonů, které bylo běžné kolem 2005 a starší.</span><span class="sxs-lookup"><span data-stu-id="47134-125">The reason why ASP.NET Mobile Controls have been marked as obsolete is that their design is oriented around the mobile phones that were common around 2005 and earlier.</span></span> <span data-ttu-id="47134-126">Ovládací prvky slouží především k vykreslení WML nebo cHTML kódu (místo regulární HTML) pro prohlížeče WAP tohoto období.</span><span class="sxs-lookup"><span data-stu-id="47134-126">The controls are mainly designed to render WML or cHTML markup (instead of regular HTML) for the WAP browsers of that era.</span></span> <span data-ttu-id="47134-127">Ale WAP, WML a cHTML již nejsou relevantní u většiny projektů, protože HTML se teď stal všudypřítomná značkovací jazyk pro mobilních a desktopových prohlížeče nabídne.</span><span class="sxs-lookup"><span data-stu-id="47134-127">But WAP, WML, and cHTML are no longer relevant for most projects, because HTML has now become the ubiquitous markup language for mobile and desktop browsers alike.</span></span>

### <a name="the-challenges-of-supporting-mobile-devices-today"></a><span data-ttu-id="47134-128">Obtíže spojené s podporu mobilních zařízení ještě dnes</span><span class="sxs-lookup"><span data-stu-id="47134-128">The challenges of supporting mobile devices today</span></span>

<span data-ttu-id="47134-129">Přestože mobilní prohlížeče teď podporují téměř univerzálně HTML, budete stále mít řadu výzev při cílem vytvářet skvělé mobilní prostředí procházení:</span><span class="sxs-lookup"><span data-stu-id="47134-129">Even though mobile browsers now almost universally support HTML, you will still face many challenges when aiming to create great mobile browsing experiences:</span></span>

- <span data-ttu-id="47134-130">***Velikost obrazovky*** – mobilní zařízení se výrazně liší ve formuláři a jejich obrazovky jsou často mnohem menší, než monitorování klientů.</span><span class="sxs-lookup"><span data-stu-id="47134-130">***Screen size*** - Mobile devices vary dramatically in form, and their screens are often much smaller than desktop monitors.</span></span> <span data-ttu-id="47134-131">Ano budete muset navrhnout zcela jinou stránku rozložení pro ně.</span><span class="sxs-lookup"><span data-stu-id="47134-131">So, you may need to design completely different page layouts for them.</span></span>
- <span data-ttu-id="47134-132">***Vstupní metody*** – některá zařízení mít klávesnice, některé mají styluses, ostatní používat dotykové ovládání.</span><span class="sxs-lookup"><span data-stu-id="47134-132">***Input methods*** – Some devices have keypads, some have styluses, others use touch.</span></span> <span data-ttu-id="47134-133">Musíte vzít v úvahu několik navigace mechanismy a data vstupní metody.</span><span class="sxs-lookup"><span data-stu-id="47134-133">You may need to consider multiple navigation mechanisms and data input methods.</span></span>
- <span data-ttu-id="47134-134">***Dodržování standardů*** – mnoho mobilních prohlížečů nepodporují nejnovějších standardů HTML, šablon stylů CSS a JavaScript.</span><span class="sxs-lookup"><span data-stu-id="47134-134">***Standards compliance*** – Many mobile browsers do not support the latest HTML, CSS, or JavaScript standards.</span></span>
- <span data-ttu-id="47134-135">***Šířka pásma*** – mobilní datové síti se mění výkon zvýšením nečekaně a některé koncovým uživatelům se na sazby, které se účtují podle megabajtech.</span><span class="sxs-lookup"><span data-stu-id="47134-135">***Bandwidth*** – Cellular data network performance varies wildly, and some end users are on tariffs that charge by the megabyte.</span></span>

<span data-ttu-id="47134-136">Neexistuje žádné poskytovat řešení univerzální velikosti; vaše aplikace bude mít vypadat a chovat jinak v závislosti na zařízení přístup.</span><span class="sxs-lookup"><span data-stu-id="47134-136">There's no one-size-fits-all solution; your application will have to look and behave differently according to the device accessing it.</span></span> <span data-ttu-id="47134-137">V závislosti na tom, jaké úroveň podpory mobilních chcete může to být větší výzvu pro webové vývojáře než desktop "prohlížeče wars" bylo dříve.</span><span class="sxs-lookup"><span data-stu-id="47134-137">Depending on what level of mobile support you want, this can be a bigger challenge for web developers than the desktop "browser wars" ever was.</span></span>

<span data-ttu-id="47134-138">Vývojáři často zpočátku blíží Podpora mobilních prohlížečů pro první myslíte, že je pouze potřeba podporovat nejnovější a nejvyspělejším smartphony (například Windows Phone 7, iPhone nebo Android), možná, protože vývojáři často sami vlastní zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-138">Developers approaching mobile browser support for the first time often initially think it's only important to support the latest and most sophisticated smartphones (e.g., Windows Phone 7, iPhone, or Android), perhaps because developers often personally own such devices.</span></span> <span data-ttu-id="47134-139">Ale levnější telefony jsou stále velmi oblíbenou a jejich vlastníky použít k procházení webu – zejména v zemích, kde jsou mobilní telefony jednodušší než širokopásmové připojení.</span><span class="sxs-lookup"><span data-stu-id="47134-139">However, cheaper phones are still extremely popular, and their owners do use them to browse the web – especially in countries where mobile phones are easier to get than a broadband connection.</span></span> <span data-ttu-id="47134-140">Vaše podnikání muset rozhodnout, jaké škálu zařízení, které podporují zvýšením jeho pravděpodobně zákazníků.</span><span class="sxs-lookup"><span data-stu-id="47134-140">Your business will need to decide what range of devices to support by considering its likely customers.</span></span> <span data-ttu-id="47134-141">Pokud vytváříte online – Příručka pro spa stavu luxusní, můžete provést obchodní rozhodnutí jenom na cílové pokročilé smartphony, že pokud vytváříte rezervace systém lístků filmové, budete pravděpodobně muset počítat návštěvníky s méně výkonných funkcí telefony.</span><span class="sxs-lookup"><span data-stu-id="47134-141">If you're building an online brochure for a luxury health spa, you might make a business decision only to target advanced smartphones, whereas if you're creating a ticket booking system for a cinema, you probably need to account for visitors with less powerful feature phones.</span></span>

## <a name="architectural-options"></a><span data-ttu-id="47134-142">Možnosti architektury</span><span class="sxs-lookup"><span data-stu-id="47134-142">Architectural options</span></span>

<span data-ttu-id="47134-143">Předtím, než se dostaneme k určité technické podrobnosti technologie ASP.NET webové formuláře nebo MVC, Všimněte si, že vývojáři webů obecně tři hlavní možnosti Podpora mobilních prohlížečů:</span><span class="sxs-lookup"><span data-stu-id="47134-143">Before we get to the specific technical details of ASP.NET Web Forms or MVC, note that web developers in general have three main possible options for supporting mobile browsers:</span></span>

1. <span data-ttu-id="47134-144">***Neprovádět žádnou akci –*** můžete jednoduše vytvořit standardní, orientovaných na ploše webovou aplikaci a Spolehněte se na mobilní prohlížeče k vykreslení přijatelně.</span><span class="sxs-lookup"><span data-stu-id="47134-144">***Do nothing –*** You can simply create a standard, desktop-oriented web application, and rely on mobile browsers to render it acceptably.</span></span> 

    - <span data-ttu-id="47134-145">**Výhody**: je nejlevnější možnost implementovat a udržovat – bez dalších fungovat.</span><span class="sxs-lookup"><span data-stu-id="47134-145">**Advantage**: It's the cheapest option to implement and maintain – no extra work</span></span>
    - <span data-ttu-id="47134-146">**Nevýhodou**: poskytuje nejhorší činnost koncového uživatele:</span><span class="sxs-lookup"><span data-stu-id="47134-146">**Disadvantage**: Gives the worst end-user experience:</span></span> 

        - <span data-ttu-id="47134-147">Nejnovější smartphony může mít za následek kódu HTML stejně, jako prohlížeč pro stolní počítač, ale uživatelé se vynutí stále přiblížení a posuňte se vodorovně a svisle využívání obsahu na malé obrazovce.</span><span class="sxs-lookup"><span data-stu-id="47134-147">The latest smartphones may render your HTML just as well as a desktop browser, but users will still be forced to zoom and scroll horizontally and vertically to consume your content on a small screen.</span></span> <span data-ttu-id="47134-148">Toto je daleko od optimální.</span><span class="sxs-lookup"><span data-stu-id="47134-148">This is far from optimal.</span></span>
        - <span data-ttu-id="47134-149">Vykreslit váš kód k spokojenosti starší zařízení a funkce telefony nemusí podařit.</span><span class="sxs-lookup"><span data-stu-id="47134-149">Older devices and feature phones may fail to render your markup in a satisfactory way.</span></span>
        - <span data-ttu-id="47134-150">Dokonce i na nejnovějších tablet zařízení (jehož obrazovky může být velikosti obrazovky přenosných počítačů) platí pravidla různé interakce.</span><span class="sxs-lookup"><span data-stu-id="47134-150">Even on the latest tablet devices (whose screens can be as big as laptop screens), different interaction rules apply.</span></span> <span data-ttu-id="47134-151">Vstup s dotykovým ovládáním funguje nejlépe s větší tlačítka a propojí šíření další od sebe a neexistuje žádný způsob, jak kurzorem myši nad rozevírací nabídku.</span><span class="sxs-lookup"><span data-stu-id="47134-151">Touch-based input works best with larger buttons and links spread further apart, and there's no way to hover a mouse cursor over a fly-out menu.</span></span>
2. <span data-ttu-id="47134-152">***Vyřešit problém na straně klienta* –** opatrní použití šablon stylů CSS a [postupném rozšiřování](http://en.wikipedia.org/wiki/Progressive_enhancement) můžete vytvářet značky, stylů a skripty, které přizpůsobit jakýkoli prohlížeč běží.</span><span class="sxs-lookup"><span data-stu-id="47134-152">***Solve the problem on the client* –** With careful use of CSS and [progressive enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement) you can create markup, styles, and scripts that adapt to whatever browser is running them.</span></span> <span data-ttu-id="47134-153">Třeba index Mei [dotazy na média šablon stylů CSS 3](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), můžete vytvořit více sloupci rozložení, které se změní rozložení jeden sloupec na zařízení, jehož obrazovky jsou užší než zvolená prahová hodnota.</span><span class="sxs-lookup"><span data-stu-id="47134-153">For example, with [CSS 3 media queries](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), you could create a multi-column layout that turns into a single column layout on devices whose screens are narrower than a chosen threshold.</span></span> 

    - <span data-ttu-id="47134-154">**Výhody**: optimalizuje pro určité zařízení používá, a to i pro neznámý budoucí zařízení podle libovolné obrazovce a vstupní vlastnosti mají vykreslování</span><span class="sxs-lookup"><span data-stu-id="47134-154">**Advantage**: Optimizes rendering for the specific device in use, even for unknown future devices according to whatever screen and input characteristics they have</span></span>
    - <span data-ttu-id="47134-155">**Výhody**: umožňuje snadno sdílet logiku na straně serveru ve všech typech zařízení – minimální duplicity kódu nebo úsilí</span><span class="sxs-lookup"><span data-stu-id="47134-155">**Advantage**: Easily lets you share server-side logic across all device types – minimal duplication of code or effort</span></span>
    - <span data-ttu-id="47134-156">**Nevýhodou**: mobilní zařízení se tak liší od desktopové zařízení, může Opravdu chcete vašich mobilních stránek být zcela liší od plochy stránky, zobrazuje různé informace.</span><span class="sxs-lookup"><span data-stu-id="47134-156">**Disadvantage**: Mobile devices are so different from desktop devices that you may really want your mobile pages to be completely different from your desktop pages, showing different information.</span></span> <span data-ttu-id="47134-157">Takové změny může být neefektivní nebo nemožné robustně dosáhnout prostřednictvím šablon stylů CSS samostatně, zejména vzhledem k tomu, jak nekonzistentně starší zařízení interpretace pravidel šablon stylů CSS.</span><span class="sxs-lookup"><span data-stu-id="47134-157">Such variations can be inefficient or impossible to achieve robustly through CSS alone, especially considering how inconsistently older devices interpret CSS rules.</span></span> <span data-ttu-id="47134-158">To platí zejména atributů šablony stylů CSS 3.</span><span class="sxs-lookup"><span data-stu-id="47134-158">This is particularly true of CSS 3 attributes.</span></span>
    - <span data-ttu-id="47134-159">**Nevýhodou**: poskytuje bez podpory pro různé logiku na straně serveru a pracovní postupy pro různá zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-159">**Disadvantage**: Provides no support for varying server-side logic and workflows for different devices.</span></span> <span data-ttu-id="47134-160">Zjednodušené nákupního košíku checkout pracovního postupu pro mobilní uživatele nelze, například implementovat pomocí šablon stylů CSS samostatně.</span><span class="sxs-lookup"><span data-stu-id="47134-160">You can't, for example, implement a simplified shopping cart checkout workflow for mobile users by means of CSS alone.</span></span>
    - <span data-ttu-id="47134-161">**Nevýhodou**: využití šířky pásma neefektivní.</span><span class="sxs-lookup"><span data-stu-id="47134-161">**Disadvantage**: Inefficient bandwidth use.</span></span> <span data-ttu-id="47134-162">Server je pravděpodobně nutné přenášet značky a stylů, které platí pro všechna možná zařízení, i v případě, že cílové zařízení se použije pouze podmnožinu těchto informací.</span><span class="sxs-lookup"><span data-stu-id="47134-162">You server may have to transmit the markup and styles that apply to all possible devices, even though the target device will only use a subset of that information.</span></span>
3. <span data-ttu-id="47134-163">***Vyřešit problém na serveru* –** Pokud váš server ví, co zařízení přistupuje – nebo nejméně charakteristiky těchto zařízení, například jeho velikosti obrazovky a vstupní metodu, a zda je na mobilním zařízení – lze spustit různé logiky a výstup různý kód HTML.</span><span class="sxs-lookup"><span data-stu-id="47134-163">***Solve the problem on the server* –** If your server knows what device is accessing it – or at least the characteristics of that device, such as its screen size and input method, and whether it's a mobile device – it can run different logic and output different HTML markup.</span></span> 

    - <span data-ttu-id="47134-164">**Výhodou:** maximální flexibilitu.</span><span class="sxs-lookup"><span data-stu-id="47134-164">**Advantage:** Maximum flexibility.</span></span> <span data-ttu-id="47134-165">Neexistuje žádné omezení, kolik můžete měnit svoji logiku na straně serveru pro mobilní telefony nebo optimalizovat vaše značky pro konkrétní zařízení, požadované rozložení.</span><span class="sxs-lookup"><span data-stu-id="47134-165">There's no limit to how much you can vary your server-side logic for mobiles or optimize your markup for the desired, device-specific layout.</span></span>
    - <span data-ttu-id="47134-166">**Výhodou:** využití šířky pásma efektivní.</span><span class="sxs-lookup"><span data-stu-id="47134-166">**Advantage:** Efficient bandwidth use.</span></span> <span data-ttu-id="47134-167">Stačí přenášet značky a informací o stylu, na který budete používat cílové zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-167">You only need to transmit the markup and styling information that the target device is going to use.</span></span>
    - <span data-ttu-id="47134-168">**Nevýhodou:** někdy Vynutí opakování úsilí nebo kód (například provedení je podobný, ale mírně odlišné kopie stránky webových formulářů nebo zobrazení MVC).</span><span class="sxs-lookup"><span data-stu-id="47134-168">**Disadvantage:** Sometimes forces repetition of effort or code (e.g., making you create similar but slightly different copies of your Web Forms pages or MVC views).</span></span> <span data-ttu-id="47134-169">Pokud to možné, budou faktor si běžné logiky do nadřízené vrstvy nebo služby, ale stále, některé části uživatelského rozhraní kód nebo značky pravděpodobně nutné být duplicitní a pak udržuje paralelně.</span><span class="sxs-lookup"><span data-stu-id="47134-169">Where possible you will factor out common logic into an underlying layer or service, but still, some parts of your UI code or markup may have to be duplicated and then maintained in parallel.</span></span>
    - <span data-ttu-id="47134-170">**Nevýhodou:** zjišťování zařízení není nic snadného.</span><span class="sxs-lookup"><span data-stu-id="47134-170">**Disadvantage:** Device detection is not trivial.</span></span> <span data-ttu-id="47134-171">Vyžaduje seznamu nebo v databázi známé zařízení typů a jejich vlastnosti (které nemusí být vždy zcela aktuální) a není zaručeno, že tak, aby přesně odpovídaly všechny příchozí požadavky.</span><span class="sxs-lookup"><span data-stu-id="47134-171">It requires a list or database of known device types and their characteristics (which may not always be perfectly up-to-date) and isn't guaranteed to accurately match every incoming request.</span></span> <span data-ttu-id="47134-172">Tento dokument popisuje některé možnosti a jejich nástrahy později.</span><span class="sxs-lookup"><span data-stu-id="47134-172">This document describes some options and their pitfalls later.</span></span>

<span data-ttu-id="47134-173">Pokud chcete získat nejlepší výsledky, Většina vývojářů najít že potřebují kombinovat možnosti (2) a (3).</span><span class="sxs-lookup"><span data-stu-id="47134-173">To get the best results, most developers find they need to combine options (2) and (3).</span></span> <span data-ttu-id="47134-174">Drobné rozdíly stylistické nejlépe sloučeny na straně klienta pomocí šablon stylů CSS nebo dokonce JavaScript, že hlavní rozdíly v datech, pracovní postup nebo značky jsou nejvíce efektivně implementovat v kódu na straně serveru.</span><span class="sxs-lookup"><span data-stu-id="47134-174">Minor stylistic differences are best accommodated on the client using CSS or even JavaScript, whereas major differences in data, workflow, or markup are most effectively implemented in server-side code.</span></span>

### <a name="this-paper-focuses-on-server-side-techniques"></a><span data-ttu-id="47134-175">Tento dokument se zaměřuje na metody na straně serveru</span><span class="sxs-lookup"><span data-stu-id="47134-175">This paper focuses on server-side techniques</span></span>

<span data-ttu-id="47134-176">Protože webových formulářů ASP.NET a MVC jsou obě technologie primárně na serveru, tento dokument white paper se soustředí na straně serveru techniky, které umožňují vytvářet různých značek a logiku pro mobilní prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="47134-176">Since ASP.NET Web Forms and MVC are both primarily server-side technologies, this white paper will focus on server-side techniques that let you produce different markup and logic for mobile browsers.</span></span> <span data-ttu-id="47134-177">Samozřejmě to můžete také kombinovat s libovolnou techniku na straně klienta (například šablon stylů CSS 3 dotazy na média, postupné vylepšení JavaScript), ale, což je více webových stránek než vývoj v technologii ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="47134-177">Of course, you can also combine this with any client-side technique (e.g., CSS 3 media queries, progressive-enhancement JavaScript), but that's more a matter of web design than ASP.NET development.</span></span>

## <a name="browser-and-device-detection"></a><span data-ttu-id="47134-178">Zjišťování prohlížeče a zařízení</span><span class="sxs-lookup"><span data-stu-id="47134-178">Browser and device detection</span></span>

<span data-ttu-id="47134-179">Klíče předpokladem pro všechny metody na straně serveru pro podporu mobilních zařízení je vědět, jaké zařízení používá návštěvník.</span><span class="sxs-lookup"><span data-stu-id="47134-179">The key prerequisite for all server-side techniques for supporting mobile devices is to know what device your visitor is using.</span></span> <span data-ttu-id="47134-180">Ve skutečnosti ještě lepší než znalost toho, výrobce a model číslo tohoto zařízení je vědět, *charakteristiky* zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-180">In fact, even better than knowing the manufacturer and model number of that device is knowing the *characteristics* of the device.</span></span> <span data-ttu-id="47134-181">Vlastnosti mohou zahrnovat:</span><span class="sxs-lookup"><span data-stu-id="47134-181">Characteristics may include:</span></span>

- <span data-ttu-id="47134-182">Je mobilní zařízení?</span><span class="sxs-lookup"><span data-stu-id="47134-182">Is it a mobile device?</span></span>
- <span data-ttu-id="47134-183">Vstupní metody (myši a klávesnice, dotykové ovládání, klávesnici, joystick,...)</span><span class="sxs-lookup"><span data-stu-id="47134-183">Input method (mouse/keyboard, touch, keypad, joystick, …)</span></span>
- <span data-ttu-id="47134-184">Velikost obrazovky (fyzicky a v pixelech)</span><span class="sxs-lookup"><span data-stu-id="47134-184">Screen size (physically and in pixels)</span></span>
- <span data-ttu-id="47134-185">Podporované formáty média a data</span><span class="sxs-lookup"><span data-stu-id="47134-185">Supported media and data formats</span></span>
- <span data-ttu-id="47134-186">Atd.</span><span class="sxs-lookup"><span data-stu-id="47134-186">Etc.</span></span>

<span data-ttu-id="47134-187">Je lepší rozhodování na základě charakteristik než číslo modelu, protože pak bude lépe vybavena pro budoucí zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-187">It's better to make decisions based on characteristics than model number, because then you'll be better equipped to handle future devices.</span></span>

### <a name="using-aspnets-built-in-browser-detection-support"></a><span data-ttu-id="47134-188">Použití prostředí ASP. NET pro prohlížeče integrované detekce podpory</span><span class="sxs-lookup"><span data-stu-id="47134-188">Using ASP.NET's built-in browser detection support</span></span>

<span data-ttu-id="47134-189">Webové formuláře ASP.NET a MVC vývojáře můžete ihned zjišťovat důležité charakteristiky hostujícími prohlížeče zkontrolováním vlastnosti *Request.Browser* objektu.</span><span class="sxs-lookup"><span data-stu-id="47134-189">ASP.NET Web Forms and MVC developers can immediately discover important characteristics of a visiting browser by inspecting properties of the *Request.Browser* object.</span></span> <span data-ttu-id="47134-190">Příklad naleznete v tématu</span><span class="sxs-lookup"><span data-stu-id="47134-190">For example, see</span></span>

- <span data-ttu-id="47134-191">Request.Browser.IsMobileDevice</span><span class="sxs-lookup"><span data-stu-id="47134-191">Request.Browser.IsMobileDevice</span></span>
- <span data-ttu-id="47134-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span><span class="sxs-lookup"><span data-stu-id="47134-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span></span>
- <span data-ttu-id="47134-193">Request.Browser.ScreenPixelsWidth</span><span class="sxs-lookup"><span data-stu-id="47134-193">Request.Browser.ScreenPixelsWidth</span></span>
- <span data-ttu-id="47134-194">Request.Browser.SupportsXmlHttp</span><span class="sxs-lookup"><span data-stu-id="47134-194">Request.Browser.SupportsXmlHttp</span></span>
- <span data-ttu-id="47134-195">...a mnoho dalších</span><span class="sxs-lookup"><span data-stu-id="47134-195">…and many others</span></span>

<span data-ttu-id="47134-196">Na pozadí, platformu ASP.NET odpovídá příchozí *User-Agent* hlavičky protokolu HTTP (UA) proti regulárních výrazů v sadě souborů definice XML prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="47134-196">Behind the scenes, the ASP.NET platform matches the incoming *User-Agent* (UA) HTTP header against regular expressions in a set of Browser Definition XML files.</span></span> <span data-ttu-id="47134-197">Ve výchozím nastavení platforma obsahuje definice pro mnoho běžných mobilních zařízení a pro ostatní uživatele, který chcete rozpoznat můžete přidat vlastní soubory definice prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="47134-197">By default the platform includes definitions for many common mobile devices, and you can add custom Browser Definition files for others you wish to recognize.</span></span> <span data-ttu-id="47134-198">Další podrobnosti najdete na stránce MSDN [serverových ovládacích prvků technologie ASP.NET a schopností prohlížeče](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span><span class="sxs-lookup"><span data-stu-id="47134-198">For more details, see the MSDN page [ASP.NET Web Server Controls and Browser Capabilities](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span></span>

### <a name="using-the-wurfl-device-database-via-51degreesmobi-foundation"></a><span data-ttu-id="47134-199">Pomocí databáze WURFL zařízení prostřednictvím 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="47134-199">Using the WURFL device database via 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="47134-200">Zatímco ASP. NET pro prohlížeče integrované detekce podpora bude dostačující pro mnoho aplikací, existují dva hlavní případy ale nemusí být dostatečně:</span><span class="sxs-lookup"><span data-stu-id="47134-200">While ASP.NET's built-in browser detection support will be sufficient for many applications, there are two main cases when it might not be enough:</span></span>

- <span data-ttu-id="47134-201">***Rozpoznáte nejnovější zařízení***(bez ruční vytvoření prohlížeče definiční soubory pro ně).</span><span class="sxs-lookup"><span data-stu-id="47134-201">***You want to recognize the latest devices***(without manually creating Browser Definition files for them).</span></span> <span data-ttu-id="47134-202">Všimněte si, že rozhraní .NET 4 prohlížeče definiční soubory nejsou dostatečně nová, aby rozpoznat Windows Phone 7, telefony s Androidem, prohlížeči Opera Mobile nebo zařízení Apple iPad.</span><span class="sxs-lookup"><span data-stu-id="47134-202">Note that .NET 4's Browser Definition files are not recent enough to recognize Windows Phone 7, Android phones, Opera Mobile browsers, or Apple iPads.</span></span>
- <span data-ttu-id="47134-203">***Potřebujete podrobnější informace o možnostech zařízení***.</span><span class="sxs-lookup"><span data-stu-id="47134-203">***You need more detailed information about device capabilities***.</span></span> <span data-ttu-id="47134-204">Budete muset vědět o zařízení s IME (například touch vs klávesnici), nebo jaké zvukové formáty prohlížeč podporuje.</span><span class="sxs-lookup"><span data-stu-id="47134-204">You may need to know about a device's input method (e.g., touch vs keypad), or what audio formats the browser supports.</span></span> <span data-ttu-id="47134-205">Tyto informace není k dispozici ve standardní soubory definice prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="47134-205">This information isn't available in the standard Browser Definition files.</span></span>

<span data-ttu-id="47134-206">[ *Univerzální soubor prostředků bezdrátové* (WURFL) projektu](http://wurfl.sourceforge.net/) uchovává mnohem více aktuální a podrobné informace o mobilních zařízení používaných ještě dnes.</span><span class="sxs-lookup"><span data-stu-id="47134-206">The [*Wireless Universal Resource File* (WURFL) project](http://wurfl.sourceforge.net/) maintains much more up-to-date and detailed information about mobile devices in use today.</span></span>

<span data-ttu-id="47134-207">Dobré zprávy pro vývojáře na platformě .NET je prostředí ASP. NET pro funkce rozpoznávání prohlížeče je rozšiřitelný, takže je možné zvýšit na tyto problémy překonat.</span><span class="sxs-lookup"><span data-stu-id="47134-207">The great news for .NET developers is that ASP.NET's browser detection feature is extensible, so it's possible to enhance it to overcome these problems.</span></span> <span data-ttu-id="47134-208">Například můžete přidat open source [ *51Degrees.mobi Foundation* ](https://github.com/51Degrees/dotNET-Device-Detection) knihovny do projektu.</span><span class="sxs-lookup"><span data-stu-id="47134-208">For example, you can add the open source [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) library to your project.</span></span> <span data-ttu-id="47134-209">To je IHttpModule technologie ASP.NET nebo poskytovateli schopností prohlížeče (použít u aplikací, webových formulářů a MVC), přímo čte WURFL data a připojí ji do ASP. Mechanismus detekce NET pro prohlížeče integrované.</span><span class="sxs-lookup"><span data-stu-id="47134-209">It's an ASP.NET IHttpModule or Browser Capabilities Provider (usable on both Web Forms and MVC applications), that directly reads WURFL data and hooks it into ASP.NET's built-in browser detection mechanism.</span></span> <span data-ttu-id="47134-210">Po instalaci modulu *Request.Browser* náhle bude obsahovat mnohem více přesné a podrobné informace: ho správně rozpozná množství zařízení už jsme zmínili a jejich možnosti (včetně seznamu Další funkce jako metoda vstupu).</span><span class="sxs-lookup"><span data-stu-id="47134-210">Once you've installed the module, *Request.Browser* will suddenly contain a lot more accurate and detailed information: it will correctly recognize many of the devices previously mentioned and list their capabilities (including additional capabilities such as input method).</span></span> <span data-ttu-id="47134-211">Další podrobnosti naleznete v dokumentaci v projektu.</span><span class="sxs-lookup"><span data-stu-id="47134-211">See the project's documentation for more details.</span></span>

## <a name="how-web-forms-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="47134-212">Jak aplikace webových formulářů sebou může nést stránek specifických pro mobilní zařízení</span><span class="sxs-lookup"><span data-stu-id="47134-212">How Web Forms applications can present mobile-specific pages</span></span>

<span data-ttu-id="47134-213">Ve výchozím nastavení zde je, jak zcela nové aplikace webových formulářů zobrazí v běžné mobilních zařízení:</span><span class="sxs-lookup"><span data-stu-id="47134-213">By default, here's how a brand new Web Forms application displays on common mobile devices:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image1.png)

<span data-ttu-id="47134-214">Je zřejmé ani rozložení vypadá velmi mobilní zařízení – tato stránka je navržená pro velké a objektově orientovaný na šířku monitorování není pro malé obrazovce orientovaný na výšku.</span><span class="sxs-lookup"><span data-stu-id="47134-214">Clearly, neither layout looks very mobile-friendly – this page was designed for a large, landscape-oriented monitor, not for a small portrait-oriented screen.</span></span> <span data-ttu-id="47134-215">Tak co můžete udělat?</span><span class="sxs-lookup"><span data-stu-id="47134-215">So what can you do about it?</span></span>

<span data-ttu-id="47134-216">Jak je popsáno dříve v tomto dokumentu, existuje mnoho způsobů, jak přizpůsobit stránky pro mobilní zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-216">As discussed earlier in this paper, there are many ways to tailor your pages for mobile devices.</span></span> <span data-ttu-id="47134-217">Některé postupy jsou založené na server, další spuštění na straně klienta.</span><span class="sxs-lookup"><span data-stu-id="47134-217">Some techniques are server-based, others run on the client.</span></span>

### <a name="creating-a-mobile-specific-master-page"></a><span data-ttu-id="47134-218">Vytvoření stránky předlohy specifické pro mobilní zařízení</span><span class="sxs-lookup"><span data-stu-id="47134-218">Creating a mobile-specific master page</span></span>

<span data-ttu-id="47134-219">V závislosti na požadavcích, je možné používat stejné webové formuláře pro všechny návštěvníky, ale mají dvě samostatné stránky předlohy: jeden pro klasické pracovní plochy návštěvníci, druhý pro mobilní návštěvníků.</span><span class="sxs-lookup"><span data-stu-id="47134-219">Depending on your requirements, you may be able to use the same Web Forms for all visitors, but have two separate master pages: one for desktop visitors, another for mobile visitors.</span></span> <span data-ttu-id="47134-220">Získáte flexibilitu změna šablony stylů CSS nebo tak, aby odpovídala mobilní zařízení, bez toho, že duplicitní jakékoli logiky stránku nejvyšší úrovně kódu HTML.</span><span class="sxs-lookup"><span data-stu-id="47134-220">This gives you the flexibility of changing the CSS stylesheet or your top-level HTML markup to suit mobile devices, without forcing you to duplicate any page logic.</span></span>

<span data-ttu-id="47134-221">To je jednoduché.</span><span class="sxs-lookup"><span data-stu-id="47134-221">This is easy to do.</span></span> <span data-ttu-id="47134-222">Například můžete přidat obslužnou rutinu PreInit například následující webové formuláře:</span><span class="sxs-lookup"><span data-stu-id="47134-222">For example, you can add a PreInit handler such as the following to a Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample1.cs)]

<span data-ttu-id="47134-223">Teď vytvořte hlavní stránku s názvem Mobile.Master ve složce nejvyšší úrovně vaší aplikace a použije se při zjištění mobilních zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-223">Now, create a master page called Mobile.Master in the top-level folder of your application, and it will be used when a mobile device is detected.</span></span> <span data-ttu-id="47134-224">Mobilní stránky předlohy odkazovat šablony stylů CSS specifické pro mobilní zařízení v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="47134-224">Your mobile master page can reference a mobile-specific CSS stylesheet if necessary.</span></span> <span data-ttu-id="47134-225">Klasické pracovní plochy návštěvníků i nadále uvidí výchozí stránku předlohy, není mobilní ten.</span><span class="sxs-lookup"><span data-stu-id="47134-225">Desktop visitors will still see your default master page, not the mobile one.</span></span>

### <a name="creating-independent-mobile-specific-web-forms"></a><span data-ttu-id="47134-226">Vytváření nezávislé webové formuláře specifické pro mobilní zařízení</span><span class="sxs-lookup"><span data-stu-id="47134-226">Creating independent mobile-specific Web Forms</span></span>

<span data-ttu-id="47134-227">Pro maximální flexibilitu můžete přejít mnohem víc než jen samostatné stránky předlohy pro různé typy zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-227">For maximum flexibility, you can go much further than just having separate master pages for different device types.</span></span> <span data-ttu-id="47134-228">Můžete implementovat dvě *zcela oddělit sad stránek webových formulářů* – jeden nastavení u počítačových prohlížečů, jiné sady pro mobilní telefony.</span><span class="sxs-lookup"><span data-stu-id="47134-228">You can implement two *totally separate sets of Web Forms pages* – one set for desktop browsers, another set for mobiles.</span></span> <span data-ttu-id="47134-229">Tato metoda funguje nejlépe, pokud chcete předložit mobilní návštěvníků velmi rozdílné informace nebo pracovních postupů.</span><span class="sxs-lookup"><span data-stu-id="47134-229">This works best if you want to present very different information or workflows to mobile visitors.</span></span> <span data-ttu-id="47134-230">Zbytek tohoto oddílu popisuje tento postup podrobněji.</span><span class="sxs-lookup"><span data-stu-id="47134-230">The rest of this section describes this approach in detail.</span></span>

<span data-ttu-id="47134-231">Za předpokladu, že již máte aplikaci webových formulářů navržené pro stolních počítačů, vytvořte podsložku nazvanou "Mobilní" v rámci vašeho projektu a sestavení vašich mobilních stránek je nejjednodušší způsob, jak pokračovat.</span><span class="sxs-lookup"><span data-stu-id="47134-231">Assuming you already have a Web Forms application designed for desktop browsers, the easiest way to proceed is to create a subfolder called "Mobile" within your project, and build your mobile pages there.</span></span> <span data-ttu-id="47134-232">Dílčí celý web, s vlastní stránky předlohy, šablony stylů a stránky, můžete vytvořit pomocí stejné techniky, které byste použili pro jakékoli jiné aplikace webových formulářů.</span><span class="sxs-lookup"><span data-stu-id="47134-232">You can construct an entire sub-site, with its own master pages, style sheets, and pages, using all the same techniques that you'd use for any other Web Forms application.</span></span> <span data-ttu-id="47134-233">K vytvoření mobilních ekvivalent pro nepotřebujete nutně *každý* stránce na webu klasické pracovní plochy, můžete zvolit, jaké podmnožinu funkcí dává smysl pro mobilní návštěvníků.</span><span class="sxs-lookup"><span data-stu-id="47134-233">You don't necessarily need to produce a mobile equivalent for *every* page in your desktop site; you can choose what subset of functionality makes sense for mobile visitors.</span></span>

<span data-ttu-id="47134-234">Mobilních stránek můžete sdílet společné statické prostředky (jako jsou obrázky, JavaScript nebo šablon stylů CSS soubory) s vaší regulární stránky, pokud chcete.</span><span class="sxs-lookup"><span data-stu-id="47134-234">Your mobile pages can share common static resources (such as images, JavaScript, or CSS files) with your regular pages if you wish.</span></span> <span data-ttu-id="47134-235">Protože se do složky "Mobilní" *není* označit jako samostatnou aplikační když jsou hostované v IIS (je stejně jednoduché podsložky stránky webových formulářů), se budou také sdílet stejné konfiguraci, data relace a další infrastrukturu jako vaše klasické pracovní plochy stránky.</span><span class="sxs-lookup"><span data-stu-id="47134-235">Since your "Mobile" folder will *not* be marked as a separate application when hosted in IIS (it's just a simple subfolder of Web Forms pages), it will also share all the same configuration, Session data, and other infrastructure as your desktop pages.</span></span>

> [!NOTE]
> <span data-ttu-id="47134-236">Protože tento přístup obvykle zahrnuje některé duplicity kódu (mobilních stránek můžou sdílet určité podobnosti s klasické pracovní plochy stránky), je důležité, abyste Multi-Factor si všechny běžné obchodní logiku a data přístupový kód do sdílené nadřízené vrstvy nebo služby.</span><span class="sxs-lookup"><span data-stu-id="47134-236">Since this approach usually involves some duplication of code (mobile pages are likely to share some similarities with desktop pages), it's important to factor out any common business logic or data access code into a shared underlying layer or service.</span></span> <span data-ttu-id="47134-237">V opačném případě budete double snaha o vytvoření a údržba vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="47134-237">Otherwise, you'll double the effort of creating and maintaining your application.</span></span>


#### <a name="redirecting-mobile-visitors-to-your-mobile-pages"></a><span data-ttu-id="47134-238">Přesměrování mobilní návštěvníkům mobilních stránek</span><span class="sxs-lookup"><span data-stu-id="47134-238">Redirecting mobile visitors to your mobile pages</span></span>

<span data-ttu-id="47134-239">Často je vhodné přesměrování pouze na mobilní návštěvníkům mobilních stránek *první* žádosti v jejich relace procházení (a ne u každého požadavku v jejich relace), protože:</span><span class="sxs-lookup"><span data-stu-id="47134-239">It's often convenient to redirect mobile visitors to the mobile pages only on the *first* request in their browsing session (and not on every request in their session), because:</span></span>

- <span data-ttu-id="47134-240">Pak můžete snadno povolit mobilní uživatelé pro přístup k ploše stránky, pokud si přejí – stačí vložit odkaz na hlavní stránce, která přejde na "Desktopová verze".</span><span class="sxs-lookup"><span data-stu-id="47134-240">You can then easily allow mobile visitors to access your desktop pages if they wish – just put a link on your master page that goes to "Desktop version".</span></span> <span data-ttu-id="47134-241">Návštěvník nebude přesměrovat zpět na stránku mobilní, protože už nejsou první požadavek v jejich relace.</span><span class="sxs-lookup"><span data-stu-id="47134-241">The visitor won't be redirected back to a mobile page, because it's no longer the first request in their session.</span></span>
- <span data-ttu-id="47134-242">Tím eliminujete riziko zasahovala do žádosti o žádné dynamické prostředky sdílené mezi částmi desktopových a mobilních vašeho webu (např. Pokud jste si běžné webový formulář desktopová i mobilní částí webu zobrazení v prvku IFRAME nebo určité obslužné rutiny jazyka Ajax)</span><span class="sxs-lookup"><span data-stu-id="47134-242">It avoids the risk of interfering with requests for any dynamic resources shared between desktop and mobile parts of your site (e.g., if you have a common Web Form that both desktop and mobile parts of your site display in an IFRAME, or certain Ajax handlers)</span></span>

<span data-ttu-id="47134-243">K tomuto účelu můžete umístit logiky přesměrování v **relace\_Start** metody.</span><span class="sxs-lookup"><span data-stu-id="47134-243">To do this, you can place your redirection logic in a **Session\_Start** method.</span></span> <span data-ttu-id="47134-244">Například přidejte následující metodu do souboru Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="47134-244">For example, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample2.cs)]

#### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="47134-245">Konfigurace ověřování pomocí formulářů se respektoval mobilních stránek</span><span class="sxs-lookup"><span data-stu-id="47134-245">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="47134-246">Všimněte si, že ověřování pomocí formulářů určitých předpokladů o kde ho můžete během a po dokončení procesu ověřování přesměrovat návštěvníků:</span><span class="sxs-lookup"><span data-stu-id="47134-246">Note that Forms Authentication makes certain assumptions about where it can redirect visitors during and after the authentication process:</span></span>

- <span data-ttu-id="47134-247">Když uživatel potřebuje k ověření, ověřování pomocí formulářů je bude přesměrovávat na stránku desktopovém přihlášení, bez ohledu na to, zda jsou desktopové nebo mobilní uživatele (protože má jenom koncept *jeden* přihlašovací adresa URL).</span><span class="sxs-lookup"><span data-stu-id="47134-247">When a user needs to be authenticated, Forms Authentication will redirect them to your desktop login page, regardless of whether they're a desktop or mobile user (because it only has a concept of *one* login URL).</span></span> <span data-ttu-id="47134-248">Za předpokladu, že chcete jinak stylu mobilní přihlašovací stránku, musíte k vylepšení plochy přihlašovací stránku tak, aby ji mobilní uživatele přesměruje na samostatné mobilní přihlašovací stránku.</span><span class="sxs-lookup"><span data-stu-id="47134-248">Assuming you want to style your mobile login page differently, you need to enhance your desktop login page so that it redirects mobile users to a separate mobile login page.</span></span> <span data-ttu-id="47134-249">Například přidejte následující kód, který vaše **desktop** přihlašovací stránky kódu:</span><span class="sxs-lookup"><span data-stu-id="47134-249">For example, add the following code to your **desktop** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample3.cs)]
- <span data-ttu-id="47134-250">Jakmile uživatel úspěšně přihlásí, ověřování pomocí formulářů se ve výchozím nastavení přesměruje je to klasické pracovní plochy domovské stránky (protože má jenom koncept *jeden* výchozí stránky).</span><span class="sxs-lookup"><span data-stu-id="47134-250">After a user successfully logs in, Forms Authentication will by default redirect them to your desktop home page (because it only has a concept of *one* default page).</span></span> <span data-ttu-id="47134-251">Je potřeba zvýšit mobilní přihlašovací stránku tak, aby ho přesměruje do mobile domovskou stránku po úspěšném přihlášení.</span><span class="sxs-lookup"><span data-stu-id="47134-251">You need to enhance your mobile login page so that it redirects to the mobile home page after a successful log-in.</span></span> <span data-ttu-id="47134-252">Například přidejte následující kód, který vaše **mobilní** přihlašovací stránky kódu:</span><span class="sxs-lookup"><span data-stu-id="47134-252">For example, add the following code to your **mobile** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample4.cs)]
  
  <span data-ttu-id="47134-253">Tento kód předpokládá, že vaše stránka má ovládací prvek Login server volá LoginUser, jako výchozí šablony projektu.</span><span class="sxs-lookup"><span data-stu-id="47134-253">This code assumes your page has a Login server control called LoginUser, as in the default project template.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="47134-254">Práce s ukládání výstupu do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="47134-254">Working with Output Caching</span></span>

<span data-ttu-id="47134-255">Pokud při použití ukládání výstupu do mezipaměti, mějte na paměti, že ve výchozím nastavení je možné pro klasické pracovní plochy uživatele k navštívení určité adresy URL (což způsobí jeho výstupu do mezipaměti), následované mobilní uživatele, který pak obdrží výstup z mezipaměti klasické pracovní plochy.</span><span class="sxs-lookup"><span data-stu-id="47134-255">If you're using output caching, beware that by default it's possible for a desktop user to visit a certain URL (causing its output to be cached), followed by a mobile user who then receives the cached desktop output.</span></span> <span data-ttu-id="47134-256">Toto upozornění platí, ať už právě různé stránky předlohy podle typu zařízení, nebo implementace zcela samostatné webové formuláře podle typu zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-256">This warning applies whether you're just varying your master page by device type, or implementing totally separate Web Forms per device type.</span></span>

<span data-ttu-id="47134-257">Abyste zabránili problémům, můžete dát pokyn, ASP.NET, aby položka mezipaměti podle Určuje, zda je návštěvníka použitím mobilního zařízení se liší.</span><span class="sxs-lookup"><span data-stu-id="47134-257">To avoid the problem, you can instruct ASP.NET to vary the cache entry according to whether the visitor is using a mobile device.</span></span> <span data-ttu-id="47134-258">Přidáte parametr VaryByCustom na vaší stránce OutputCache deklaraci takto:</span><span class="sxs-lookup"><span data-stu-id="47134-258">Add a VaryByCustom parameter to your page's OutputCache declaration as follows:</span></span>

[!code-aspx[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample5.aspx)]

<span data-ttu-id="47134-259">Dále definujte *isMobileDevice* jako vlastní mezipaměti přepsat parametru tak, že přidáte následující metodu do souboru Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="47134-259">Next, define *isMobileDevice* as a custom cache parameter by adding the following method override to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample6.cs)]

<span data-ttu-id="47134-260">Tím se zajistí, že mobilní návštěvníků na stránce nepřijímají výstup dříve vložit do mezipaměti klientů návštěvníka.</span><span class="sxs-lookup"><span data-stu-id="47134-260">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="47134-261">Funkční příklad</span><span class="sxs-lookup"><span data-stu-id="47134-261">A working example</span></span>

<span data-ttu-id="47134-262">Pokud chcete zobrazit tyto techniky v akci, stáhněte si [dokument white paper, ukázky kódu](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="47134-262">To see these techniques in action, download [this white paper's code samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="47134-263">Ukázková aplikace webových formulářů mobilní uživatele automaticky přesměruje na sadu stránek specifických pro mobilní zařízení v podsložce s názvem mobilní zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-263">The Web Forms sample application automatically redirects mobile users to a set of mobile-specific pages in a subfolder called Mobile.</span></span> <span data-ttu-id="47134-264">Značky a stylu tyto stránky je lépe optimalizovaná pro mobilní prohlížeče, jak je vidět na následujících snímcích obrazovky:</span><span class="sxs-lookup"><span data-stu-id="47134-264">The markup and styling of those pages is better optimized for mobile browsers, as you can see from the following screenshots:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image2.png)

<span data-ttu-id="47134-265">Další informace o optimalizaci značky a šablony stylů CSS pro mobilní prohlížeče najdete v části "Určení stylu mobilních stránek pro mobilní prohlížeče" dále v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="47134-265">For more tips about optimizing your markup and CSS for mobile browsers, see the section "Styling mobile pages for mobile browsers" later in this document.</span></span>

## <a name="how-aspnet-mvc-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="47134-266">Jak aplikace ASP.NET MVC sebou může nést stránek specifických pro mobilní zařízení</span><span class="sxs-lookup"><span data-stu-id="47134-266">How ASP.NET MVC applications can present mobile-specific pages</span></span>

<span data-ttu-id="47134-267">Protože vzor Model-View-Controller odděluje logiku aplikace (kontrolery) od logiky prezentace (v zobrazení), můžete z kteréhokoli z následujících dvou přístupů zpracování mobilní podporu v kódu na straně serveru:</span><span class="sxs-lookup"><span data-stu-id="47134-267">Since the Model-View-Controller pattern decouples application logic (in controllers) from presentation logic (in views), you can choose from any of the following approaches to handling mobile support in server-side code:</span></span>

1. <span data-ttu-id="47134-268">***Použití stejného kontrolerů a zobrazení pro stolní počítače a mobilní prohlížeče, ale vykreslit zobrazení s různá rozložení Razor v závislosti na typu zařízení *.**</span><span class="sxs-lookup"><span data-stu-id="47134-268">***Use the same controllers and views for both desktop and mobile browsers, but render the views with different Razor layouts depending on the device type*.**</span></span> <span data-ttu-id="47134-269">Tato volba funguje nejlépe, je-li zobrazit stejná data na všech zařízeních, ale jednoduše chcete zadat jiné šablony stylů CSS nebo změnit několik elementů HTML nejvyšší úrovně pro mobilní telefony.</span><span class="sxs-lookup"><span data-stu-id="47134-269">This option works best if you're displaying identical data on all devices, but simply want to supply different CSS stylesheets or change a few top-level HTML elements for mobiles.</span></span>
2. <span data-ttu-id="47134-270">***Použít stejnou řadiče pro stolní počítače a mobilní prohlížeče, ale vykreslení různá zobrazení v závislosti na typu zařízení***.</span><span class="sxs-lookup"><span data-stu-id="47134-270">***Use the same controllers for both desktop and mobile browsers, but render different views depending on the device type***.</span></span> <span data-ttu-id="47134-271">Tato volba funguje nejlépe, pokud jste zobrazení přibližně stejná data a poskytují stejné pracovních postupů pro koncové uživatele, ale chcete vykreslit velice různý kód HTML tak, aby odpovídala zařízení používá.</span><span class="sxs-lookup"><span data-stu-id="47134-271">This option works best if you're displaying roughly the same data and providing the same workflows for end users, but want to render very different HTML markup to suit the device being used.</span></span>
3. <span data-ttu-id="47134-272">***Vytvoření samostatné oblasti pro stolní počítače a mobilní prohlížeče, implementace nezávislé kontrolerů a zobrazení pro každou *.**</span><span class="sxs-lookup"><span data-stu-id="47134-272">***Create separate areas for desktop and mobile browsers, implementing independent controllers and views for each*.**</span></span> <span data-ttu-id="47134-273">Tato volba funguje nejlépe, pokud jste zobrazení velmi různých obrazovek, obsahující různé informace a úvodní uživatele provede různé pracovní postupy, které jsou optimalizované pro jejich typ zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-273">This option works best if you're displaying very different screens, containing different information and leading the user through different workflows optimized for their device type.</span></span> <span data-ttu-id="47134-274">Může to znamenat některé opakování kódu, ale můžete minimalizovat, ve které budou zohledňovat si běžné logiky do podkladové vrstvy nebo služby.</span><span class="sxs-lookup"><span data-stu-id="47134-274">It may mean some repetition of code, but you can minimize that by factoring out common logic into an underlying layer or service.</span></span>

<span data-ttu-id="47134-275">Pokud budete chtít využít **první** možnost a pouze rozložení Razor se liší podle typu zařízení, je velmi snadné.</span><span class="sxs-lookup"><span data-stu-id="47134-275">If you want to take the **first** option and vary only the Razor layout per device type, it's very easy.</span></span> <span data-ttu-id="47134-276">Upravit vaše \_ViewStart.cshtml souboru následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="47134-276">Just modify your \_ViewStart.cshtml file as follows:</span></span>

[!code-cshtml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample7.cshtml)]

<span data-ttu-id="47134-277">Nyní můžete vytvořit konkrétní mobilní rozložení volá \_LayoutMobile.cshtml se strukturou stránky a šablony stylů CSS pravidla optimalizovány pro mobilní zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-277">Now you can create a mobile-specific layout called \_LayoutMobile.cshtml with a page structure and CSS rules optimized for mobile devices.</span></span>

<span data-ttu-id="47134-278">Pokud chcete převést **druhý** možnosti vykreslování něco úplně jiného zobrazení v závislosti na typu zařízení návštěvníka, přečtěte si téma [blogový příspěvek Scotta Hanselmana](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span><span class="sxs-lookup"><span data-stu-id="47134-278">If you want to take the **second** option render totally different views according to the visitor's device type, see [Scott Hanselman's blog post](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span></span>

<span data-ttu-id="47134-279">Zbytek tohoto dokumentu se zaměřuje na **třetí** možnost – vytvoření samostatných řadičů *a* zobrazení pro mobilní zařízení – proto můžete řídit přesně se nabízí jaké podmnožinu funkcí pro mobilní návštěvníků.</span><span class="sxs-lookup"><span data-stu-id="47134-279">The rest of this paper focuses on the **third** option – creating separate controllers *and* views for mobile devices – so you can control exactly what subset of functionality is offered for mobile visitors.</span></span>

### <a name="setting-up-a-mobile-area-within-your-aspnet-mvc-application"></a><span data-ttu-id="47134-280">Nastavení na mobilní oblast v rámci vaší aplikace ASP.NET MVC</span><span class="sxs-lookup"><span data-stu-id="47134-280">Setting up a Mobile area within your ASP.NET MVC application</span></span>

<span data-ttu-id="47134-281">Můžete přidat oblast s názvem "Mobilní" do stávající aplikace ASP.NET MVC obvyklým způsobem: klikněte pravým tlačítkem na název vašeho projektu v Průzkumníku řešení a zvolte Přidat a oblasti.</span><span class="sxs-lookup"><span data-stu-id="47134-281">You can add an area called "Mobile" to an existing ASP.NET MVC application in the normal way: right-click on your project name in Solution Explorer, then choose Add à Area.</span></span> <span data-ttu-id="47134-282">Poté můžete přidat kontrolerů a zobrazení stejně jako ostatní oblasti v rámci aplikace ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="47134-282">You can then add controllers and views as you would for any other area within an ASP.NET MVC application.</span></span> <span data-ttu-id="47134-283">Například přidáte mobilní oblast nový kontroler volá HomeController tak, aby fungoval jako domovskou stránku pro mobilní návštěvníků.</span><span class="sxs-lookup"><span data-stu-id="47134-283">For example, add to your Mobile area a new controller called HomeController to act as a homepage for mobile visitors.</span></span>

### <a name="ensuring-the-url-mobile-reaches-the-mobile-homepage"></a><span data-ttu-id="47134-284">Zajištění URL /Mobile dosáhne mobilní domovské stránky</span><span class="sxs-lookup"><span data-stu-id="47134-284">Ensuring the URL /Mobile reaches the mobile homepage</span></span>

<span data-ttu-id="47134-285">Pokud chcete adresy URL /Mobile kontaktovat, akce indexu na HomeController uvnitř mobilních areálu, je potřeba dělat dva malé změny konfigurace směrování.</span><span class="sxs-lookup"><span data-stu-id="47134-285">If you want the URL /Mobile to reach the Index action on HomeController inside your Mobile area, you will need to make two small changes to your routing configuration.</span></span> <span data-ttu-id="47134-286">Nejprve aktualizujte vaše třída MobileAreaRegistration tak, aby byla HomeController výchozí řadiče ve vaší oblasti mobilních jak je znázorněno v následujícím kódu:</span><span class="sxs-lookup"><span data-stu-id="47134-286">First, update your MobileAreaRegistration class so that HomeController is the default controller in your Mobile area, as shown in the following code:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample8.cs)]

<span data-ttu-id="47134-287">To znamená, že mobilní Domovská stránka nyní bude umístěn na /Mobile, nikoli/Mobile Domů, protože "Home" je teď výchozí název kontroleru implicitně mobilních stránek.</span><span class="sxs-lookup"><span data-stu-id="47134-287">This means the mobile homepage will now be located at /Mobile, rather than /Mobile/Home, because "Home" is now the implicitly default controller name for mobile pages.</span></span>

<span data-ttu-id="47134-288">Dále si všimněte, že tak, že přidáte druhý HomeController do vaší aplikace (například mobilní tu, nejen u desktopového existující jeden), jste budete zrušili domovské stránce regulární klasické pracovní plochy.</span><span class="sxs-lookup"><span data-stu-id="47134-288">Next, note that by adding a second HomeController to your application (i.e., the mobile one, in addition to the existing desktop one), you'll have broken your regular desktop homepage.</span></span> <span data-ttu-id="47134-289">Dojde k selhání s chybou "*bylo nalezeno několik typů, které se shodují s řadičem s názvem"Home"*".</span><span class="sxs-lookup"><span data-stu-id="47134-289">It will fail with the error "*Multiple types were found that match the controller named 'Home'*".</span></span> <span data-ttu-id="47134-290">Chcete-li tento problém vyřešit, aktualizujte nejvyšší úrovně konfigurace směrování (v Global.asax.cs) k určení, že by klasické pracovní plochy HomeController po nejednoznačnosti mají přednost:</span><span class="sxs-lookup"><span data-stu-id="47134-290">To resolve this, update your top-level routing configuration (in Global.asax.cs) to specify that your desktop HomeController should take priority when there's ambiguity:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample9.cs)]

<span data-ttu-id="47134-291">Nyní chyba půjdou vypustila při optimalizaci a URL http://<em>yoursite</em>/ dosáhne klasické pracovní plochy domovskou stránku a http://<em>yoursite</em>/mobile/ dosáhne mobilní domovské stránky.</span><span class="sxs-lookup"><span data-stu-id="47134-291">Now the error will go away, and the URL http://<em>yoursite</em>/ will reach the desktop homepage, and http://<em>yoursite</em>/mobile/ will reach the mobile homepage.</span></span>

### <a name="redirecting-mobile-visitors-to-your-mobile-area"></a><span data-ttu-id="47134-292">Přesměrování mobilní návštěvníkům mobilní oblast</span><span class="sxs-lookup"><span data-stu-id="47134-292">Redirecting mobile visitors to your mobile area</span></span>

<span data-ttu-id="47134-293">Existuje mnoho různých rozšíření bodů v architektuře ASP.NET MVC, tak, že existuje mnoho způsobů je to možné vkládat logiky přesměrování.</span><span class="sxs-lookup"><span data-stu-id="47134-293">There are many different extensibility points in ASP.NET MVC, so there are many possible ways to inject redirection logic.</span></span> <span data-ttu-id="47134-294">Jednou z úhledné možností je vytvořit atribut filtru, [RedirectMobileDevicesToMobileArea], který provádí přesměrování, pokud jsou splněny následující podmínky:</span><span class="sxs-lookup"><span data-stu-id="47134-294">One neat option is to create a filter attribute, [RedirectMobileDevicesToMobileArea], that performs a redirection if the following conditions are met:</span></span>

1. <span data-ttu-id="47134-295">Je první požadavek v relaci uživatele (například Session.IsNewSession rovná se true)</span><span class="sxs-lookup"><span data-stu-id="47134-295">It's the first request in the user's session (i.e., Session.IsNewSession equals true)</span></span>
2. <span data-ttu-id="47134-296">Požadavek pochází z mobilního prohlížeče (například Request.Browser.IsMobileDevice rovná se true)</span><span class="sxs-lookup"><span data-stu-id="47134-296">The request comes from a mobile browser (i.e., Request.Browser.IsMobileDevice equals true)</span></span>
3. <span data-ttu-id="47134-297">Uživatel není již požadování prostředku v oblasti mobilních (například *cesta* část adresy URL nezačíná /Mobile)</span><span class="sxs-lookup"><span data-stu-id="47134-297">The user is not already requesting a resource in the mobile area (i.e., the *path* part of the URL does not begin with /Mobile)</span></span>

<span data-ttu-id="47134-298">Ukázky ke stažení, které jsou zahrnuté v tomto dokumentu white paper obsahuje implementaci tuto logiku.</span><span class="sxs-lookup"><span data-stu-id="47134-298">The downloadable sample included with this white paper includes an implementation of this logic.</span></span> <span data-ttu-id="47134-299">Je implementován jako filtr autorizace, odvozené od třídy AuthorizeAttribute, což znamená, že je správně fungovaly i v případě použití ukládání výstupu do mezipaměti (jinak, pokud první přístupy klasické pracovní plochy návštěvníka určité adresy URL, klasické pracovní plochy výstupu mohou být uložené v mezipaměti a pak dodávat do následné mobilní návštěvníci).</span><span class="sxs-lookup"><span data-stu-id="47134-299">It's implemented as an authorization filter, derived from AuthorizeAttribute, which means it can work correctly even if you are using output caching (otherwise, if a desktop visitor first accesses a certain URL, the desktop output might be cached and then served to subsequent mobile visitors).</span></span>

<span data-ttu-id="47134-300">Protože je filtr, můžete zvolit uplatňovat na konkrétní řadiče a akce, například</span><span class="sxs-lookup"><span data-stu-id="47134-300">As it's a filter, you can choose either to apply it to specific controllers and actions, e.g.,</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample10.cs)]

<span data-ttu-id="47134-301">…</span><span class="sxs-lookup"><span data-stu-id="47134-301">…</span></span> <span data-ttu-id="47134-302">nebo můžete ho použít pro všechny kontrolery a akce jako MVC 3 *globálních filtrů* v souboru Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="47134-302">or you can apply it to all controllers and actions as an MVC 3 *global filter* in your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample11.cs)]

<span data-ttu-id="47134-303">Ukázky ke stažení také ukazuje, jak můžete vytvořit podtříd tento atribut přesměrovat na konkrétní umístění v rámci mobilní oblast.</span><span class="sxs-lookup"><span data-stu-id="47134-303">The downloadable sample also demonstrates how you can create subclasses of this attribute that redirect to specific locations within your mobile area.</span></span> <span data-ttu-id="47134-304">To znamená, že například že můžete:</span><span class="sxs-lookup"><span data-stu-id="47134-304">This means, for example, you can:</span></span>

- <span data-ttu-id="47134-305">Registraci globálního filtru jak je znázorněno výše, která odesílá mobilní návštěvníků mobilní domovskou stránku ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="47134-305">Register a global filter as shown above that sends mobile visitors to the mobile homepage by default.</span></span>
- <span data-ttu-id="47134-306">Speciální filtr [RedirectMobileDevicesToMobileProductPage] platí také pro "zobrazení product" akci, která přebírá mobilní návštěvníků na mobilní verzi měl požadovaná stránka produktu.</span><span class="sxs-lookup"><span data-stu-id="47134-306">Also apply a special [RedirectMobileDevicesToMobileProductPage] filter to a "view product" action that takes mobile visitors to the mobile version of whatever product page they had requested.</span></span>
- <span data-ttu-id="47134-307">Další zvláštní podtřídy filtr platí také pro konkrétní akce, přesměrování mobilní návštěvníků na stejnou stránku mobilní</span><span class="sxs-lookup"><span data-stu-id="47134-307">Also apply other special subclasses of the filter to specific actions, redirecting mobile visitors to the equivalent mobile page</span></span>

### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="47134-308">Konfigurace ověřování pomocí formulářů se respektoval mobilních stránek</span><span class="sxs-lookup"><span data-stu-id="47134-308">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="47134-309">Pokud používáte ověřování pomocí formulářů, nezapomeňte přitom, že když uživatel potřebuje přihlásit, se automaticky přesměruje uživatele na jednu konkrétní "přihlásit" adresu URL, která ve výchozím nastavení je **/účet/přihlášení**.</span><span class="sxs-lookup"><span data-stu-id="47134-309">If you're using Forms Authentication, you should note that when a user needs to log in, it automatically redirects the user to a single specific "log on" URL, which by default is **/Account/LogOn**.</span></span> <span data-ttu-id="47134-310">To znamená, že mobilní uživatelé mohou přesměrováni na akci klasické pracovní plochy "přihlášení".</span><span class="sxs-lookup"><span data-stu-id="47134-310">This means that mobile users may be redirected to your desktop "log on" action.</span></span>

<span data-ttu-id="47134-311">K tomuto problému vyhnout, přidáte logiku klasické pracovní plochy akci "přihlásit" tak, aby znovu přesměrování mobilními uživateli na mobilní "přihlásit" akce.</span><span class="sxs-lookup"><span data-stu-id="47134-311">To avoid this problem, add logic to your desktop "log on" action so that it redirects mobile users again to a mobile "log on" action.</span></span> <span data-ttu-id="47134-312">Pokud používáte výchozí šablonu aplikace ASP.NET MVC, aktualizujte akce AccountController společnosti přihlášení následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="47134-312">If you're using the default ASP.NET MVC application template, update AccountController's LogOn action as follows:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample12.cs)]

<span data-ttu-id="47134-313">…</span><span class="sxs-lookup"><span data-stu-id="47134-313">…</span></span> <span data-ttu-id="47134-314">a na řadiči volá AccountController nejbližší mobilní implementací vhodný "přihlásit" akce specifické pro mobilní zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-314">and then implement a suitable mobile-specific "log on" action on a controller called AccountController in your Mobile area.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="47134-315">Práce s ukládání výstupu do mezipaměti</span><span class="sxs-lookup"><span data-stu-id="47134-315">Working with Output Caching</span></span>

<span data-ttu-id="47134-316">Pokud používáte filtr [OutputCache], je nutné vynutit položky mezipaměti se liší podle typu zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-316">If you're using the [OutputCache] filter, you must force the cache entry to vary by device type.</span></span> <span data-ttu-id="47134-317">Například napište:</span><span class="sxs-lookup"><span data-stu-id="47134-317">For example, write:</span></span>

[!code-javascript[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample13.js)]

<span data-ttu-id="47134-318">Potom přidejte následující metodu do souboru Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="47134-318">Then, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample14.cs)]

<span data-ttu-id="47134-319">Tím se zajistí, že mobilní návštěvníků na stránce nepřijímají výstup dříve vložit do mezipaměti klientů návštěvníka.</span><span class="sxs-lookup"><span data-stu-id="47134-319">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="47134-320">Funkční příklad</span><span class="sxs-lookup"><span data-stu-id="47134-320">A working example</span></span>

<span data-ttu-id="47134-321">Pokud chcete zobrazit tyto techniky v akci, stáhněte si [dokument white paper kód související ukázky](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="47134-321">To see these techniques in action, download [this white paper's code associated samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="47134-322">Ukázka zahrnuje aplikaci ASP.NET MVC 3 (verze Release Candidate) Vylepšený pro podporu mobilních zařízení pomocí metod popsaných výše.</span><span class="sxs-lookup"><span data-stu-id="47134-322">The sample includes an ASP.NET MVC 3 (Release Candidate) application enhanced to support mobile devices using the methods described above.</span></span>

## <a name="further-guidance-and-suggestions"></a><span data-ttu-id="47134-323">Další doprovodné materiály a návrhy</span><span class="sxs-lookup"><span data-stu-id="47134-323">Further guidance and suggestions</span></span>

<span data-ttu-id="47134-324">Následující informace platí i pro webové formuláře a MVC vývojáři, kteří jsou pomocí techniky popsané v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="47134-324">The following discussion applies both to Web Forms and MVC developers who are using the techniques covered in this document.</span></span>

### <a name="enhancing-your-redirection-logic-using-51degreesmobi-foundation"></a><span data-ttu-id="47134-325">Rozšíření přesměrování logiku pomocí 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="47134-325">Enhancing your redirection logic using 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="47134-326">Může být dokonale dostatečná pro vaši aplikaci logiky přesměrování je znázorněno v tomto dokumentu, ale nebude fungovat, pokud je nutné zakázat relace, nebo mobilní prohlížeče, které zamítnout soubory cookie (tyto nemůže mít relace), protože nebude vědět, jestli daný požadavek je první z nich z tohoto návštěvníka.</span><span class="sxs-lookup"><span data-stu-id="47134-326">The redirection logic shown in this document may be perfectly sufficient for your application, but it won't work if you need to disable sessions, or with mobile browsers that reject cookies (these can't have sessions), because it won't know whether a given request is the first one from that visitor.</span></span>

<span data-ttu-id="47134-327">Už jste zjistili, jak opensourcový 51Degrees.mobi Foundation zlepšit přesnost ASP. Zjišťování sítě pro prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="47134-327">You already learned how the open source 51Degrees.mobi Foundation can improve the accuracy of ASP.NET's browser detection.</span></span> <span data-ttu-id="47134-328">Také obsahuje integrovanou schopnost přesměrování mobilní návštěvníkům konkrétní umístění nakonfigurovaná v souboru Web.config. Je možné pracovat bez v závislosti na relace ASP.NET (a tím i soubory cookie) uložením dočasné log hash návštěvníků hlavičky protokolu HTTP a IP adres, tedy ví, zda každý požadavek je první z nich z daného vistor.</span><span class="sxs-lookup"><span data-stu-id="47134-328">It also has a built-in ability to redirect mobile visitors to specific locations configured in Web.config. It's able to work without depending on ASP.NET Sessions (and hence cookies) by storing a temporary log of hashes of visitors' HTTP headers and IP addresses, so it knows whether or not each request is the first one from a given vistor.</span></span>

<span data-ttu-id="47134-329">Přidat do části fiftyOne souboru web.config následující element bude přesměrovávat první požadavek z mobilního zařízení zjištěná na stránku ~ / Mobile/Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="47134-329">The following element added to the fiftyOne section of the web.config file will redirect the first request from a detected mobile device to the page ~/Mobile/Default.aspx.</span></span> <span data-ttu-id="47134-330">Budou všechny žádosti na stránky ve složce mobilní *není* přesměrovat, bez ohledu na typ zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-330">Any requests to pages under the Mobile folder will *not* be redirected, regardless of device type.</span></span> <span data-ttu-id="47134-331">Pokud mobilní zařízení bylo nečinné po dobu 20 minut nebo více zařízení se budou vymazány a následné žádosti, bude zacházeno jako nové značky pro účely přesměrování.</span><span class="sxs-lookup"><span data-stu-id="47134-331">If the mobile device has been inactive for a period of 20 minutes or more the device will be forgotten and subsequent requests will be treated as new ones for the purposes of redirection.</span></span>

[!code-xml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample15.xml)]

<span data-ttu-id="47134-332">Další podrobnosti najdete v tématu [51degrees.mobi Foundation dokumentaci](https://github.com/51Degrees/dotNET-Device-Detection).</span><span class="sxs-lookup"><span data-stu-id="47134-332">For more details, see [51degrees.mobi Foundation documentation](https://github.com/51Degrees/dotNET-Device-Detection).</span></span>

> [!NOTE]
> <span data-ttu-id="47134-333">Můžete *můžete* Foundation 51Degrees.mobi použití funkce přesměrování na aplikace ASP.NET MVC, ale bude nutné definovat konfiguraci přesměrování z hlediska jednoduché adresy URL není z hlediska směrování parametry nebo vložením MVC filtry na akce.</span><span class="sxs-lookup"><span data-stu-id="47134-333">You *can* use 51Degrees.mobi Foundation's redirection feature on ASP.NET MVC applications, but you will need to define your redirection configuration in terms of plain URLs, not in terms of routing parameters or by putting MVC filters on actions.</span></span> <span data-ttu-id="47134-334">Důvodem je, že (v době psaní) nemůže rozpoznat 51Degrees.mobi Foundation filtry nebo směrování.</span><span class="sxs-lookup"><span data-stu-id="47134-334">This is because (at the time of writing) 51Degrees.mobi Foundation does not recognize filters or routing.</span></span>


### <a name="disabling-transcoders-and-proxy-servers"></a><span data-ttu-id="47134-335">Zakázání Tricaster a Proxy servery</span><span class="sxs-lookup"><span data-stu-id="47134-335">Disabling Transcoders and Proxy Servers</span></span>

<span data-ttu-id="47134-336">Mobilní síť operátory mají dva různé cíle v jejich přístupu k mobilní síti internet.</span><span class="sxs-lookup"><span data-stu-id="47134-336">Mobile network operators have two broad objectives in their approach to the mobile internet:</span></span>

1. <span data-ttu-id="47134-337">Zadejte jako mnohem souvisejícího obsahu nejvíce</span><span class="sxs-lookup"><span data-stu-id="47134-337">Provide as much relevant content as possible</span></span>
2. <span data-ttu-id="47134-338">Zajištění maximálního počtu zákazníků, kteří můžou sdílet šířku pásma sítě omezené přepínač</span><span class="sxs-lookup"><span data-stu-id="47134-338">Maximize the number of customers who can share the limited radio network bandwidth</span></span>

<span data-ttu-id="47134-339">Protože většina webových stránek byly navrženy pro velké obrazovky velikost plochy a Rychlá oprava řádku širokopásmové připojení, použít mnoho operátorů *tricaster* nebo *proxy servery* , která dynamicky měnit webového obsahu.</span><span class="sxs-lookup"><span data-stu-id="47134-339">Since most web pages were designed for large desktop-sized screens and fast fixed-line broadband connections, many operators use *transcoders* or *proxy servers* that dynamically alter web content.</span></span> <span data-ttu-id="47134-340">Se může změnit kód HTML a CSS tak, aby odpovídala menších obrazovkách (hlavně u "funkce telefony", které nemají výpočetní výkon pro zpracování složitých rozložení), a jejich znovu komprimovat imagí (výrazně snižuje jejich kvalitu) ke zlepšení rychlosti doručení stránky.</span><span class="sxs-lookup"><span data-stu-id="47134-340">They may modify your HTML markup or CSS to suit smaller screens (especially for "feature phones" that lack the processing power to handle complex layouts), and they may recompress your images (significantly reducing their quality) to improve page delivery speeds.</span></span>

<span data-ttu-id="47134-341">Ale pokud jste pořídili úsilí k vytvoření optimalizované pro mobilní verzi vaší lokality, pravděpodobně nebudete chtít, operátora mobilní sítě narušoval se žádné další.</span><span class="sxs-lookup"><span data-stu-id="47134-341">But if you've taken the effort to produce a mobile-optimized version of your site, you probably don't want the network operator to interfere with it any further.</span></span> <span data-ttu-id="47134-342">Přidáte následující řádek na stránce\_zatížení událost v jakékoli webový formulář ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="47134-342">You can add the following line to the Page\_Load event in any ASP.NET Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample16.cs)]

<span data-ttu-id="47134-343">Nebo pro kontroler ASP.NET MVC, můžete přidat následující přepsání metody tak, aby se vztahuje na všechny akce v kontroleru:</span><span class="sxs-lookup"><span data-stu-id="47134-343">Or, for an ASP.NET MVC controller, you could add the following method override so that it applies to all actions on that controller:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample17.cs)]

<span data-ttu-id="47134-344">Výslednou zprávu HTTP informuje tricaster standardu W3C a proxy servery obsahu nemění.</span><span class="sxs-lookup"><span data-stu-id="47134-344">The resulting HTTP message informs W3C compliant transcoders and proxies not to alter content.</span></span> <span data-ttu-id="47134-345">Samozřejmě není zaručeno, že operátory mobilní sítě bude respektovat tato zpráva.</span><span class="sxs-lookup"><span data-stu-id="47134-345">Of course, there is no guarantee that mobile network operators will respect this message.</span></span>

### <a name="styling-mobile-pages-for-mobile-browsers"></a><span data-ttu-id="47134-346">Používání stylů pro mobilních stránek pro mobilní prohlížeče</span><span class="sxs-lookup"><span data-stu-id="47134-346">Styling mobile pages for mobile browsers</span></span>

<span data-ttu-id="47134-347">Je nad rámec tohoto dokumentu k podrobnému popisu, skvělé jaké druhy práce značky HTML správně nebo které techniky návrh webové zajištění maximálního použitelnosti na konkrétní zařízení.</span><span class="sxs-lookup"><span data-stu-id="47134-347">It's beyond the scope of this document to describe in great detail what kinds of HTML markup work correctly or which web design techniques maximize usability on particular devices.</span></span> <span data-ttu-id="47134-348">To má nahoru vám najít dostatečně jednoduché rozložení, optimalizované pro mobile velikost obrazovky, bez použití nespolehlivé HTML nebo umístění triky šablony stylů CSS.</span><span class="sxs-lookup"><span data-stu-id="47134-348">It's up to you to find a sufficiently simple layout, optimized for a mobile-sized screen, without using unreliable HTML or CSS positioning tricks.</span></span> <span data-ttu-id="47134-349">Jedna z technik důležité zmínit, ale *zobrazení metaznačku*.</span><span class="sxs-lookup"><span data-stu-id="47134-349">One important technique worth mentioning, however, is the *viewport meta tag*.</span></span>

<span data-ttu-id="47134-350">Některé moderní mobilní prohlížeče, na úsilí zobrazení webové stránky určené pro monitorování klientů, vykreslení stránky na virtuální plátno, také nazývané "zobrazení" (například virtuální zobrazení je 980 pixelů na šířku na Iphonu a 850 pixelů na šířku v prohlížeči Opera Mobile ve výchozím nastavení) a pak výsledek škálujte tak, aby na fyzických pixelech na obrazovce.</span><span class="sxs-lookup"><span data-stu-id="47134-350">Certain modern mobile browsers, in an effort display web pages meant for desktop monitors, render the page on a virtual canvas, also called "viewport" (e.g., the virtual viewport is 980 pixels wide on iPhone, and 850 pixels wide on Opera Mobile by default) and then scale the result down to fit onto the screen's physical pixels.</span></span> <span data-ttu-id="47134-351">Uživatel pak můžete přiblížit a posouvání zobrazení tohoto zobrazení.</span><span class="sxs-lookup"><span data-stu-id="47134-351">The user can then zoom in and pan around that viewport.</span></span> <span data-ttu-id="47134-352">To má výhodu v tom, že umožňuje, aby prohlížeč zobrazení stránky v jeho zamýšlenou rozložení, ale je také obsahuje nevýhodou je, že vynutí přibližování a posouvání, která je vhodná pro uživatele.</span><span class="sxs-lookup"><span data-stu-id="47134-352">This has the advantage that it lets the browser display the page in its intended layout, but it's also has the disadvantage that it forces zooming and panning, which is inconvenient for the user.</span></span> <span data-ttu-id="47134-353">Pokud vytváříte pro mobilní zařízení, je lepší návrh pro úzké obrazovku tak, aby žádné zvětšování nebo posouvání ve vodorovném směru, je nezbytné.</span><span class="sxs-lookup"><span data-stu-id="47134-353">If you're designing for mobile, it's better to design for a narrow screen so that no zooming or horizontal scrolling is necessary.</span></span>

<span data-ttu-id="47134-354">Způsob, jak zjistit mobilní prohlížeče, jak široké by měl být zobrazení je nestandardní *zobrazení* značka meta.</span><span class="sxs-lookup"><span data-stu-id="47134-354">A way to tell the mobile browser how wide the viewport should be is through the nonstandard *viewport* meta tag.</span></span> <span data-ttu-id="47134-355">Například, pokud přidáte následující hlavní části na stránce</span><span class="sxs-lookup"><span data-stu-id="47134-355">For example, if you add the following to your page's HEAD section,</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample18.html)]

<span data-ttu-id="47134-356">…</span><span class="sxs-lookup"><span data-stu-id="47134-356">…</span></span> <span data-ttu-id="47134-357">potom podpora prohlížeče chytrém telefonu se rozložení stránky na plátně celý virtuální 480 pixelů.</span><span class="sxs-lookup"><span data-stu-id="47134-357">then supporting smartphone browsers will lay out the page on a 480-pixel wide virtual canvas.</span></span> <span data-ttu-id="47134-358">To znamená, že pokud vaše elementů HTML definovat jejich šířku v procentech, procenta interpretován s ohledem na tento šířka v pixelech 480, ne výchozí šířka zobrazení.</span><span class="sxs-lookup"><span data-stu-id="47134-358">This means that if your HTML elements define their widths in percentage terms, the percentages will be interpreted with respect to this 480-pixel width, not the default viewport width.</span></span> <span data-ttu-id="47134-359">Díky tomu je méně pravděpodobné, že máte přiblížení a posouvání vodorovně – výrazně zlepšuje mobilní rozhraní prohlížeče uživatele.</span><span class="sxs-lookup"><span data-stu-id="47134-359">As a result, the user is less likely to have to zoom and pan horizontally – considerably improving the mobile browsing experience.</span></span>

<span data-ttu-id="47134-360">Pokud chcete, aby šířka zobrazení tak, aby odpovídaly fyzických pixelech zařízení, můžete zadat následující:</span><span class="sxs-lookup"><span data-stu-id="47134-360">If you want the viewport width to match the device's physical pixels, you can specify the following:</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample19.html)]

<span data-ttu-id="47134-361">Pro tento postup správně fungoval, nesmí vynutíte explicitně prvků, které mají být delší než tento šířku (například pomocí *šířka* atribut nebo vlastnost CSS), jinak v prohlížeči bude muset použít větší zobrazení bez ohledu na to.</span><span class="sxs-lookup"><span data-stu-id="47134-361">For this to work correctly, you must not explicitly force elements to exceed that width (e.g., using a *width* attribute or CSS property), otherwise the browser will be forced to use a larger viewport regardless.</span></span> <span data-ttu-id="47134-362">Viz také: [další podrobnosti o značce nestandardní zobrazení](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span><span class="sxs-lookup"><span data-stu-id="47134-362">See also: [more details about the nonstandard viewport tag](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span></span>

<span data-ttu-id="47134-363">Většina moderních smartphony podporují *duální orientace*: můžou uchovávat v režimu na výšku nebo na šířku.</span><span class="sxs-lookup"><span data-stu-id="47134-363">Most modern smartphones support *dual orientation*: they can be held in either portrait or landscape mode.</span></span> <span data-ttu-id="47134-364">Proto je důležité, abyste vytvářet předpoklady o obrazovky šířka v pixelech.</span><span class="sxs-lookup"><span data-stu-id="47134-364">So, it's important not to make assumptions about the screen width in pixels.</span></span> <span data-ttu-id="47134-365">Dokonce i Nepředpokládejte, že je pevná šířka obrazovky, protože uživatel může znovu zorientovat svoje zařízení, pokud nejsou na stránce.</span><span class="sxs-lookup"><span data-stu-id="47134-365">Don't even assume that the screen width is fixed, because the user can re-orient their device while they are on your page.</span></span>

<span data-ttu-id="47134-366">Starší zařízení Windows Mobile a Blackberry může také přijímat těchto značek meta v záhlaví stránky informovat obsahu byla optimalizována pro mobilní zařízení a proto by neměl být převedeny.</span><span class="sxs-lookup"><span data-stu-id="47134-366">Older Windows Mobile and Blackberry devices may also accept the following meta tags in the page header to inform them content has been optimized for mobile and therefore should not be transformed.</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample20.html)]

## <a name="additional-resources"></a><span data-ttu-id="47134-367">Další prostředky</span><span class="sxs-lookup"><span data-stu-id="47134-367">Additional Resources</span></span>

<span data-ttu-id="47134-368">Seznam mobilních zařízení emulátorů a simulátorů, můžete použít k testování mobilní webové aplikace v ASP.NET, naleznete na stránce [simulace oblíbených mobilních zařízení pro testování](../mobile/device-simulators.md).</span><span class="sxs-lookup"><span data-stu-id="47134-368">For a list of mobile device emulators and simulators you can use to test your mobile ASP.NET web application, see the page [Simulate popular mobile devices for testing](../mobile/device-simulators.md).</span></span>

## <a name="credits"></a><span data-ttu-id="47134-369">Kredity</span><span class="sxs-lookup"><span data-stu-id="47134-369">Credits</span></span>

- <span data-ttu-id="47134-370">Primárního autora: Steven Sanderson</span><span class="sxs-lookup"><span data-stu-id="47134-370">Primary author: Steven Sanderson</span></span>
- <span data-ttu-id="47134-371">Revidující / další obsah zapisovačů: James Rosewell, Mikael Söderström, Scott Hanselman a Scott Hunter</span><span class="sxs-lookup"><span data-stu-id="47134-371">Reviewers / additional content writers: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span></span>
